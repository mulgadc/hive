import{g as Jt,A as jt,k as Re,l as Je,m as Fe,n as Ue,o as Ut,r as l,p as Zt,q as He,t as Bt,v as vn,w as xe,x as ht,y as Tn,E as en,z as tn,C as De,D as Mn,F as Cn,G as Y,H as En,I as de,J as An,K as _t,L as Pn,M as Ge,N as xt,P as zt,Q as On,R as nn,S as Nn,T as Vn,U as At,V as ut,j as y,W as q,X as Lt,Y as kn,Z as Pt,_ as jn,$ as j,a0 as Ln,a1 as ft,a2 as Dn,a3 as Hn,a4 as Fn,a5 as rn,a6 as sn,a7 as Un,a8 as Bn,a9 as Dt,aa as on,ab as Ve,ac as Ot,ad as _n,ae as zn,af as Kn,ag as Wn,ah as $n,ai as qn,aj as Yn,ak as Gn,al as Xn,am as ln,an as Kt,ao as Qn,ap as Jn,aq as Zn,ar as er,as as cn,at as tr,au as nr,av as yt,c as We,a as $e,u as rr,aw as sr,ax as or,ay as ir,az as lr,B as Wt}from"./index.js";import{b as cr,c as an,d as un,e as $t,f as ar,g as ur,h as fr,u as dr,a as pr,C as bt,I as mr}from"./zod.js";import{u as Rt}from"./useSuspenseQuery.js";import{B as gr}from"./back-link.js";import{E as qt,L as st}from"./error-banner.js";import{P as hr}from"./page-heading.js";import{C as xr}from"./check.js";import{b as yr}from"./ec2.js";import"./useMutation.js";const br=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],fn=Jt("chevron-down",br);const Rr=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],wr=Jt("chevron-up",Rr);function ot(t,e,n){return Math.floor(t/e)!==n}function Xe(t,e){return e<0||e>=t.current.length}function wt(t,e){return he(t,{disabledIndices:e})}function Yt(t,e){return he(t,{decrement:!0,startingIndex:t.current.length,disabledIndices:e})}function he(t,{startingIndex:e=-1,decrement:n=!1,disabledIndices:s,amount:i=1}={}){let r=e;do r+=n?-i:i;while(r>=0&&r<=t.current.length-1&&Qe(t,r,s));return r}function Sr(t,{event:e,orientation:n,loopFocus:s,rtl:i,cols:r,disabledIndices:c,minIndex:u,maxIndex:f,prevIndex:d,stopEvent:m=!1}){let p=d;const b=[],P={};let w=!1;{let o=null,R=-1;t.current.forEach((a,h)=>{if(a==null)return;const E=a.closest('[role="row"]');E&&(w=!0),(E!==o||R===-1)&&(o=E,R+=1,b[R]=[]),b[R].push(h),P[h]=R})}const x=w&&b.length>0&&b.some(o=>o.length!==r);function T(o){if(!x||d===-1)return;const R=P[d];if(R==null)return;const a=b[R].indexOf(d);let h=o==="up"?R-1:R+1;s&&(h<0?h=b.length-1:h>=b.length&&(h=0));const E=new Set;for(;h>=0&&h<b.length&&!E.has(h);){E.add(h);const I=b[h];if(I.length===0){h=o==="up"?h-1:h+1;continue}const O=Math.min(a,I.length-1);for(let N=O;N>=0;N-=1){const re=I[N];if(!Qe(t,re,c))return re}h=o==="up"?h-1:h+1,s&&(h<0?h=b.length-1:h>=b.length&&(h=0))}}if(e.key===jt){const o=T("up");if(o!==void 0)m&&Re(e),p=o;else{if(m&&Re(e),d===-1)p=f;else if(p=he(t,{startingIndex:p,amount:r,decrement:!0,disabledIndices:c}),s&&(d-r<u||p<0)){const R=d%r,a=f%r,h=f-(a-R);a===R?p=f:p=a>R?h:h-r}Xe(t,p)&&(p=d)}}if(e.key===Je){const o=T("down");o!==void 0?(m&&Re(e),p=o):(m&&Re(e),d===-1?p=u:(p=he(t,{startingIndex:d,amount:r,disabledIndices:c}),s&&d+r>f&&(p=he(t,{startingIndex:d%r-r,amount:r,disabledIndices:c}))),Xe(t,p)&&(p=d))}if(n==="both"){const o=Ut(d/r);e.key===(i?Fe:Ue)&&(m&&Re(e),d%r!==r-1?(p=he(t,{startingIndex:d,disabledIndices:c}),s&&ot(p,r,o)&&(p=he(t,{startingIndex:d-d%r-1,disabledIndices:c}))):s&&(p=he(t,{startingIndex:d-d%r-1,disabledIndices:c})),ot(p,r,o)&&(p=d)),e.key===(i?Ue:Fe)&&(m&&Re(e),d%r!==0?(p=he(t,{startingIndex:d,decrement:!0,disabledIndices:c}),s&&ot(p,r,o)&&(p=he(t,{startingIndex:d+(r-d%r),decrement:!0,disabledIndices:c}))):s&&(p=he(t,{startingIndex:d+(r-d%r),decrement:!0,disabledIndices:c})),ot(p,r,o)&&(p=d));const R=Ut(f/r)===o;Xe(t,p)&&(s&&R?p=e.key===(i?Ue:Fe)?f:he(t,{startingIndex:d-d%r-1,disabledIndices:c}):p=d)}return p}function Ir(t,e,n){const s=[];let i=0;return t.forEach(({width:r,height:c},u)=>{let f=!1;for(n&&(i=0);!f;){const d=[];for(let m=0;m<r;m+=1)for(let p=0;p<c;p+=1)d.push(i+m+p*e);i%e+r<=e&&d.every(m=>s[m]==null)?(d.forEach(m=>{s[m]=u}),f=!0):i+=1}}),[...s]}function vr(t,e,n,s,i){if(t===-1)return-1;const r=n.indexOf(t),c=e[t];switch(i){case"tl":return r;case"tr":return c?r+c.width-1:r;case"bl":return c?r+(c.height-1)*s:r;case"br":return n.lastIndexOf(t);default:return-1}}function Tr(t,e){return e.flatMap((n,s)=>t.includes(n)?[s]:[])}function Qe(t,e,n){if(typeof n=="function")return n(e);if(n)return n.includes(e);const s=t.current[e];return s?s.hasAttribute("disabled")||s.getAttribute("aria-disabled")==="true":!1}function Mr(t,e={}){const n="rootStore"in t?t.rootStore:t,s=n.context.dataRef,{enabled:i=!0,event:r="click",toggle:c=!0,ignoreMouse:u=!1,stickIfOpen:f=!0,touchOpenDelay:d=0}=e,m=l.useRef(void 0),p=Zt(),b=He(),P=l.useMemo(()=>({onPointerDown(w){m.current=w.pointerType},onMouseDown(w){const x=m.current,T=w.nativeEvent,o=n.select("open");if(w.button!==0||r==="click"||Bt(x,!0)&&u)return;const R=s.current.openEvent,a=R?.type,h=n.select("domReferenceElement")!==w.currentTarget,E=o&&h||!(o&&c&&(!(R&&f)||a==="click"||a==="mousedown"));if(Tn(T.target)){const O=xe(ht,T,T.target);E&&x==="touch"&&d>0?b.start(d,()=>{n.setOpen(!0,O)}):n.setOpen(E,O);return}const I=w.currentTarget;p.request(()=>{const O=xe(ht,T,I);E&&x==="touch"&&d>0?b.start(d,()=>{n.setOpen(!0,O)}):n.setOpen(E,O)})},onClick(w){if(r==="mousedown-only")return;const x=m.current;if(r==="mousedown"&&x){m.current=void 0;return}if(Bt(x,!0)&&u)return;const T=n.select("open"),o=s.current.openEvent,R=n.select("domReferenceElement")!==w.currentTarget,a=T&&R||!(T&&c&&(!(o&&f)||vn(o))),h=xe(ht,w.nativeEvent,w.currentTarget);a&&x==="touch"&&d>0?b.start(d,()=>{n.setOpen(!0,h)}):n.setOpen(a,h)},onKeyDown(){m.current=void 0}}),[s,r,u,n,f,c,p,b,d]);return l.useMemo(()=>i?{reference:P}:en,[i,P])}const Cr="Escape";function dt(t,e,n){switch(t){case"vertical":return e;case"horizontal":return n;default:return e||n}}function it(t,e){return dt(e,t===jt||t===Je,t===Fe||t===Ue)}function St(t,e,n){return dt(e,t===Je,n?t===Fe:t===Ue)||t==="Enter"||t===" "||t===""}function Er(t,e,n){return dt(e,n?t===Fe:t===Ue,t===Je)}function Ar(t,e,n,s){const i=n?t===Ue:t===Fe,r=t===jt;return e==="both"||e==="horizontal"&&s&&s>1?t===Cr:dt(e,i,r)}function Pr(t,e){const n="rootStore"in t?t.rootStore:t,s=n.useState("open"),i=n.useState("floatingElement"),r=n.useState("domReferenceElement"),c=n.context.dataRef,{listRef:u,activeIndex:f,onNavigate:d=()=>{},enabled:m=!0,selectedIndex:p=null,allowEscape:b=!1,loopFocus:P=!1,nested:w=!1,rtl:x=!1,virtual:T=!1,focusItemOnOpen:o="auto",focusItemOnHover:R=!0,openOnArrowKeyDown:a=!0,disabledIndices:h=void 0,orientation:E="vertical",parentOrientation:I,cols:O=1,scrollItemIntoView:N=!0,itemSizes:re,dense:ae=!1,id:K,resetOnPointerLeave:W=!0,externalTree:z}=e,D=tn(i),ee=De(D),U=Mn(),te=Cn(z);Y(()=>{c.current.orientation=E},[c,E]);const v=En(r),B=l.useRef(o),S=l.useRef(p??-1),A=l.useRef(null),ie=l.useRef(!0),M=de(g=>{d(S.current===-1?null:S.current,g)}),oe=l.useRef(M),G=l.useRef(!!i),k=l.useRef(s),_=l.useRef(!1),ue=l.useRef(!1),Ie=De(h),F=De(s),fe=De(N),X=De(p),me=De(W),we=de(()=>{function g(Z){T?te?.events.emit("virtualfocus",Z):An(Z,{sync:_.current,preventScroll:!0})}const L=u.current[S.current],C=ue.current;L&&g(L),(_.current?Z=>Z():requestAnimationFrame)(()=>{const Z=u.current[S.current]||L;if(!Z)return;L||g(Z);const le=fe.current;le&&Q&&(C||!ie.current)&&Z.scrollIntoView?.(typeof le=="boolean"?{block:"nearest",inline:"nearest"}:le)})});Y(()=>{m&&(s&&i?(S.current=p??-1,B.current&&p!=null&&(ue.current=!0,M())):G.current&&(S.current=-1,oe.current()))},[m,s,i,p,M]),Y(()=>{if(m){if(!s){_.current=!1;return}if(i)if(f==null){if(_.current=!1,X.current!=null)return;if(G.current&&(S.current=-1,we()),(!k.current||!G.current)&&B.current&&(A.current!=null||B.current===!0&&A.current==null)){let g=0;const L=()=>{u.current[0]==null?(g<2&&(g?requestAnimationFrame:queueMicrotask)(L),g+=1):(S.current=A.current==null||St(A.current,E,x)||w?wt(u):Yt(u),A.current=null,M())};L()}}else Xe(u,f)||(S.current=f,we(),ue.current=!1)}},[m,s,i,f,X,w,u,E,x,M,we,Ie]),Y(()=>{if(!m||i||!te||T||!G.current)return;const g=te.nodesRef.current,L=g.find(Z=>Z.id===U)?.context?.elements.floating,C=_t(Pn(i)),$=g.some(Z=>Z.context&&Ge(Z.context.elements.floating,C));L&&!$&&ie.current&&L.focus({preventScroll:!0})},[m,i,te,U,T]),Y(()=>{oe.current=M,k.current=s,G.current=!!i}),Y(()=>{s||(A.current=null,B.current=o)},[s,o]);const pe=f!=null,Q=l.useMemo(()=>{function g(C){if(!F.current)return;const $=u.current.indexOf(C.currentTarget);$!==-1&&S.current!==$&&(S.current=$,M(C))}return{onFocus(C){_.current=!0,g(C)},onClick:({currentTarget:C})=>C.focus({preventScroll:!0}),onMouseMove(C){_.current=!0,ue.current=!1,R&&g(C)},onPointerLeave(C){if(!F.current||!ie.current||C.pointerType==="touch")return;_.current=!0;const $=C.relatedTarget;!R||u.current.includes($)||me.current&&(S.current=-1,M(C),T||ee.current?.focus({preventScroll:!0}))}}},[F,ee,R,u,M,me,T]),J=l.useCallback(()=>I??te?.nodesRef.current.find(g=>g.id===U)?.context?.dataRef?.current.orientation,[U,te,I]),ye=de(g=>{if(ie.current=!1,_.current=!0,g.which===229||!F.current&&g.currentTarget===ee.current)return;if(w&&Ar(g.key,E,x,O)){it(g.key,J())||Re(g),n.setOpen(!1,xe(xt,g.nativeEvent)),zt(r)&&(T?te?.events.emit("virtualfocus",r):r.focus());return}const L=S.current,C=wt(u,h),$=Yt(u,h);if(v||(g.key==="Home"&&(Re(g),S.current=C,M(g)),g.key==="End"&&(Re(g),S.current=$,M(g))),O>1){const Z=re||Array.from({length:u.current.length},()=>({width:1,height:1})),le=Ir(Z,O,ae),ge=le.findIndex(Se=>Se!=null&&!Qe(u,Se,h)),be=le.reduce((Se,Me,Le)=>Me!=null&&!Qe(u,Me,h)?Le:Se,-1),je=le[Sr({current:le.map(Se=>Se!=null?u.current[Se]:null)},{event:g,orientation:E,loopFocus:P,rtl:x,cols:O,disabledIndices:Tr([...(typeof h!="function"?h:null)||u.current.map((Se,Me)=>Qe(u,Me,h)?Me:void 0),void 0],le),minIndex:ge,maxIndex:be,prevIndex:vr(S.current>$?C:S.current,Z,le,O,g.key===Je?"bl":g.key===(x?Fe:Ue)?"tr":"tl"),stopEvent:!0})];if(je!=null&&(S.current=je,M(g)),E==="both")return}if(it(g.key,E)){if(Re(g),s&&!T&&_t(g.currentTarget.ownerDocument)===g.currentTarget){S.current=St(g.key,E,x)?C:$,M(g);return}St(g.key,E,x)?P?L>=$?b&&L!==u.current.length?S.current=-1:(_.current=!1,S.current=C):S.current=he(u,{startingIndex:L,disabledIndices:h}):S.current=Math.min($,he(u,{startingIndex:L,disabledIndices:h})):P?L<=C?b&&L!==-1?S.current=u.current.length:(_.current=!1,S.current=$):S.current=he(u,{startingIndex:L,decrement:!0,disabledIndices:h}):S.current=Math.max(C,he(u,{startingIndex:L,decrement:!0,disabledIndices:h})),Xe(u,S.current)&&(S.current=-1),M(g)}}),se=l.useMemo(()=>T&&s&&pe&&{"aria-activedescendant":`${K}-${f}`},[T,s,pe,K,f]),ne=l.useMemo(()=>({"aria-orientation":E==="both"?void 0:E,...v?{}:se,onKeyDown(g){if(g.key==="Tab"&&g.shiftKey&&s&&!T){const L=On(g.nativeEvent);if(L&&!Ge(ee.current,L))return;Re(g),n.setOpen(!1,xe(nn,g.nativeEvent)),zt(r)&&r.focus();return}ye(g)},onPointerMove(){ie.current=!0}}),[se,ye,ee,E,v,n,s,T,r]),Te=l.useMemo(()=>{function g(C){o==="auto"&&Nn(C.nativeEvent)&&(B.current=!T)}function L(C){B.current=o,o==="auto"&&Vn(C.nativeEvent)&&(B.current=!0)}return{onKeyDown(C){const $=n.select("open");ie.current=!1;const Z=C.key.startsWith("Arrow"),le=Er(C.key,J(),x),ge=it(C.key,E),be=(w?le:ge)||C.key==="Enter"||C.key.trim()==="";if(T&&$)return ye(C);if(!(!$&&!a&&Z)){if(be){const je=it(C.key,J());A.current=w&&je?null:C.key}if(w){le&&(Re(C),$?(S.current=wt(u,Ie.current),M(C)):n.setOpen(!0,xe(xt,C.nativeEvent,C.currentTarget)));return}ge&&(X.current!=null&&(S.current=X.current),Re(C),!$&&a?n.setOpen(!0,xe(xt,C.nativeEvent,C.currentTarget)):ye(C),$&&M(C))}},onFocus(C){n.select("open")&&!T&&(S.current=-1,M(C))},onPointerDown:L,onPointerEnter:L,onMouseDown:g,onClick:g}},[ye,Ie,o,u,w,M,n,a,E,J,x,X,T]),Ae=l.useMemo(()=>({...se,...Te}),[se,Te]);return l.useMemo(()=>m?{reference:Ae,floating:ne,item:Q,trigger:Te}:{},[m,Ae,ne,Te,Q])}function Or(t,e){const n="rootStore"in t?t.rootStore:t,s=n.useState("open"),i=n.context.dataRef,{listRef:r,activeIndex:c,onMatch:u,onTypingChange:f,enabled:d=!0,findMatch:m=null,resetMs:p=750,ignoreKeys:b=At,selectedIndex:P=null}=e,w=He(),x=l.useRef(""),T=l.useRef(P??c??-1),o=l.useRef(null);Y(()=>{s&&(w.clear(),o.current=null,x.current="")},[s,w]),Y(()=>{s&&x.current===""&&(T.current=P??c??-1)},[s,P,c]);const R=de(I=>{I?i.current.typing||(i.current.typing=I,f?.(I)):i.current.typing&&(i.current.typing=I,f?.(I))}),a=de(I=>{function O(W,z,D){const ee=m?m(z,D):z.find(U=>U?.toLocaleLowerCase().indexOf(D.toLocaleLowerCase())===0);return ee?W.indexOf(ee):-1}const N=r.current;if(x.current.length>0&&x.current[0]!==" "&&(O(N,N,x.current)===-1?R(!1):I.key===" "&&Re(I)),N==null||b.includes(I.key)||I.key.length!==1||I.ctrlKey||I.metaKey||I.altKey)return;s&&I.key!==" "&&(Re(I),R(!0)),N.every(W=>W?W[0]?.toLocaleLowerCase()!==W[1]?.toLocaleLowerCase():!0)&&x.current===I.key&&(x.current="",T.current=o.current),x.current+=I.key,w.start(p,()=>{x.current="",T.current=o.current,R(!1)});const ae=T.current,K=O(N,[...N.slice((ae||0)+1),...N.slice(0,(ae||0)+1)],x.current);K!==-1?(u?.(K),o.current=K):I.key!==" "&&(x.current="",R(!1))}),h=l.useMemo(()=>({onKeyDown:a}),[a]),E=l.useMemo(()=>({onKeyDown:a,onKeyUp(I){I.key===" "&&R(!1)}}),[a,R]);return l.useMemo(()=>d?{reference:h,floating:E}:{},[d,h,E])}function Nr(t){const e=l.useRef(!0);e.current&&(e.current=!1,t())}const dn=l.createContext(null),pn=l.createContext(null);function ke(){const t=l.useContext(dn);if(t===null)throw new Error(ut(60));return t}function mn(){const t=l.useContext(pn);if(t===null)throw new Error(ut(61));return t}const Vr=(t,e)=>Object.is(t,e);function Ke(t,e,n){return t==null||e==null?Object.is(t,e):n(t,e)}function It(t,e,n){return!t||t.length===0?!1:t.some(s=>s===void 0?!1:Ke(s,e,n))}function Nt(t,e,n){return!t||t.length===0?-1:t.findIndex(s=>s===void 0?!1:Ke(s,e,n))}function kr(t,e,n){return t.filter(s=>!Ke(s,e,n))}function Vt(t){if(t==null)return"";if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return String(t)}}function gn(t){return t!=null&&t.length>0&&typeof t[0]=="object"&&t[0]!=null&&"items"in t[0]}function jr(t){if(!Array.isArray(t))return t!=null&&!("null"in t);if(gn(t)){for(const e of t)for(const n of e.items)if(n&&n.value==null&&n.label!=null)return!0;return!1}for(const e of t)if(e&&e.value==null&&e.label!=null)return!0;return!1}function Lr(t,e){if(e&&t!=null)return e(t)??"";if(t&&typeof t=="object"){if("label"in t&&t.label!=null)return String(t.label);if("value"in t)return String(t.value)}return Vt(t)}function ze(t,e){return e&&t!=null?e(t)??"":t&&typeof t=="object"&&"value"in t&&"label"in t?Vt(t.value):Vt(t)}function hn(t,e,n){function s(){return Lr(t,n)}if(n&&t!=null)return n(t);if(t&&typeof t=="object"&&"label"in t&&t.label!=null)return t.label;if(e&&!Array.isArray(e))return e[t]??s();if(Array.isArray(e)){const i=gn(e)?e.flatMap(r=>r.items):e;if(t==null||typeof t!="object"){const r=i.find(c=>c.value===t);return r&&r.label!=null?r.label:s()}if("value"in t){const r=i.find(c=>c&&c.value===t.value);if(r&&r.label!=null)return r.label}}return s()}function Dr(t,e,n){return t.reduce((s,i,r)=>(r>0&&s.push(", "),s.push(y.jsx(l.Fragment,{children:hn(i,e,n)},r)),s),[])}const V={id:q(t=>t.id),modal:q(t=>t.modal),multiple:q(t=>t.multiple),items:q(t=>t.items),itemToStringLabel:q(t=>t.itemToStringLabel),itemToStringValue:q(t=>t.itemToStringValue),isItemEqualToValue:q(t=>t.isItemEqualToValue),value:q(t=>t.value),hasSelectedValue:q(t=>{const{value:e,multiple:n,itemToStringValue:s}=t;return e==null?!1:n&&Array.isArray(e)?e.length>0:ze(e,s)!==""}),hasNullItemLabel:q((t,e)=>e?jr(t.items):!1),open:q(t=>t.open),mounted:q(t=>t.mounted),forceMount:q(t=>t.forceMount),transitionStatus:q(t=>t.transitionStatus),openMethod:q(t=>t.openMethod),activeIndex:q(t=>t.activeIndex),selectedIndex:q(t=>t.selectedIndex),isActive:q((t,e)=>t.activeIndex===e),isSelected:q((t,e,n)=>{const s=t.isItemEqualToValue,i=t.value;return t.multiple?Array.isArray(i)&&i.some(r=>Ke(r,n,s)):t.selectedIndex===e&&t.selectedIndex!==null?!0:Ke(i,n,s)}),isSelectedByFocus:q((t,e)=>t.selectedIndex===e),popupProps:q(t=>t.popupProps),triggerProps:q(t=>t.triggerProps),triggerElement:q(t=>t.triggerElement),positionerElement:q(t=>t.positionerElement),listElement:q(t=>t.listElement),scrollUpArrowVisible:q(t=>t.scrollUpArrowVisible),scrollDownArrowVisible:q(t=>t.scrollDownArrowVisible),hasScrollArrows:q(t=>t.hasScrollArrows)};function Hr(t,e){const n=l.useRef(t),s=de(e);Y(()=>{n.current!==t&&s(n.current)},[t,s]),Y(()=>{n.current=t},[t])}function Fr(t){const{id:e,value:n,defaultValue:s=null,onValueChange:i,open:r,defaultOpen:c=!1,onOpenChange:u,name:f,disabled:d=!1,readOnly:m=!1,required:p=!1,modal:b=!0,actionsRef:P,inputRef:w,onOpenChangeComplete:x,items:T,multiple:o=!1,itemToStringLabel:R,itemToStringValue:a,isItemEqualToValue:h=Vr,highlightItemOnHover:E=!0,children:I}=t,{clearErrors:O}=cr(),{setDirty:N,setTouched:re,setFocused:ae,shouldValidateOnChange:K,validityData:W,setFilled:z,name:D,disabled:ee,validation:U,validationMode:te}=an(),v=un({id:e}),B=ee||d,S=D??f,[A,ie]=$t({controlled:n,default:o?s??At:s,name:"Select",state:"value"}),[M,oe]=$t({controlled:r,default:c,name:"Select",state:"open"}),G=l.useRef([]),k=l.useRef([]),_=l.useRef(null),ue=l.useRef(null),Ie=l.useRef(0),F=l.useRef(null),fe=l.useRef([]),X=l.useRef(!1),me=l.useRef(!1),we=l.useRef(null),pe=l.useRef({allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}),Q=l.useRef(!1),{mounted:J,setMounted:ye,transitionStatus:se}=Lt(M),{openMethod:ne,triggerProps:Te,reset:Ae}=kn(M),g=Pt(()=>new jn({id:v,modal:b,multiple:o,itemToStringLabel:R,itemToStringValue:a,isItemEqualToValue:h,value:A,open:M,mounted:J,transitionStatus:se,items:T,forceMount:!1,openMethod:null,activeIndex:null,selectedIndex:null,popupProps:{},triggerProps:{},triggerElement:null,positionerElement:null,listElement:null,scrollUpArrowVisible:!1,scrollDownArrowVisible:!1,hasScrollArrows:!1})).current,L=j(g,V.activeIndex),C=j(g,V.selectedIndex),$=j(g,V.triggerElement),Z=j(g,V.positionerElement),le=l.useMemo(()=>o&&Array.isArray(A)&&A.length===0?"":ze(A,a),[o,A,a]),ge=l.useMemo(()=>o&&Array.isArray(A)?A.map(H=>ze(H,a)):ze(A,a),[o,A,a]),be=De(g.state.triggerElement);ar({id:v,commit:U.commit,value:A,controlRef:be,name:S,getValue:()=>ge});const je=l.useRef(A);Y(()=>{A!==je.current&&g.set("forceMount",!0)},[g,A]),Y(()=>{z(o?Array.isArray(A)&&A.length>0:A!=null)},[o,A,z]),Y(function(){if(M)return;const ce=fe.current;if(o){const Ee=Array.isArray(A)?A:[];if(Ee.length===0){g.set("selectedIndex",null);return}const ve=Ee[Ee.length-1],rt=Nt(ce,ve,h);g.set("selectedIndex",rt===-1?null:rt);return}const Ce=Nt(ce,A,h);g.set("selectedIndex",Ce===-1?null:Ce)},[o,M,A,fe,h,g]),Hr(A,()=>{O(S),N(A!==W.initialValue),K()?U.commit(A):U.commit(A,!0)});const Se=de((H,ce)=>{if(u?.(H,ce),!ce.isCanceled&&(oe(H),!H&&(ce.reason===nn||ce.reason===Ln)&&(re(!0),ae(!1),te==="onBlur"&&U.commit(A)),!H&&g.state.activeIndex!==null)){const Ce=G.current[g.state.activeIndex];queueMicrotask(()=>{Ce?.setAttribute("tabindex","-1")})}}),Me=de(()=>{ye(!1),g.set("activeIndex",null),Ae(),x?.(!1)});ft({enabled:!P,open:M,ref:_,onComplete(){M||Me()}}),l.useImperativeHandle(P,()=>({unmount:Me}),[Me]);const Le=de((H,ce)=>{i?.(H,ce),!ce.isCanceled&&ie(H)}),Pe=de(()=>{const H=g.state.listElement||_.current;if(!H)return;const ce=H.scrollTop,Ce=H.scrollTop+H.clientHeight,Ee=ce>1,ve=Ce<H.scrollHeight-1;g.state.scrollUpArrowVisible!==Ee&&g.set("scrollUpArrowVisible",Ee),g.state.scrollDownArrowVisible!==ve&&g.set("scrollDownArrowVisible",ve)}),Oe=Dn({open:M,onOpenChange:Se,elements:{reference:$,floating:Z}}),Ze=Mr(Oe,{enabled:!m&&!B,event:"mousedown"}),qe=Hn(Oe,{bubbles:!1}),Ne=Pr(Oe,{enabled:!m&&!B,listRef:G,activeIndex:L,selectedIndex:C,disabledIndices:At,onNavigate(H){H===null&&!M||g.set("activeIndex",H)},focusItemOnHover:!1}),pt=Or(Oe,{enabled:!m&&!B&&(M||!o),listRef:k,activeIndex:L,selectedIndex:C,onMatch(H){M?g.set("activeIndex",H):Le(fe.current[H],xe("none"))},onTypingChange(H){X.current=H}}),{getReferenceProps:Be,getFloatingProps:_e,getItemProps:et}=Fn([Ze,qe,Ne,pt]),Ye=l.useMemo(()=>rn(Be(),Te,v?{id:v}:en),[Be,Te,v]);Nr(()=>{g.update({popupProps:_e(),triggerProps:Ye})}),Y(()=>{g.update({id:v,modal:b,multiple:o,value:A,open:M,mounted:J,transitionStatus:se,popupProps:_e(),triggerProps:Ye,items:T,itemToStringLabel:R,itemToStringValue:a,isItemEqualToValue:h,openMethod:ne})},[g,v,b,o,A,M,J,se,_e,Ye,T,R,a,h,ne]);const tt=l.useMemo(()=>({store:g,name:S,required:p,disabled:B,readOnly:m,multiple:o,itemToStringLabel:R,itemToStringValue:a,highlightItemOnHover:E,setValue:Le,setOpen:Se,listRef:G,popupRef:_,scrollHandlerRef:ue,handleScrollArrowVisibility:Pe,scrollArrowsMountedCountRef:Ie,getItemProps:et,events:Oe.context.events,valueRef:F,valuesRef:fe,labelsRef:k,typingRef:X,selectionRef:pe,selectedItemTextRef:we,validation:U,onOpenChangeComplete:x,keyboardActiveRef:me,alignItemWithTriggerActiveRef:Q,initialValueRef:je}),[g,S,p,B,m,o,R,a,E,Le,Se,et,Oe.context.events,U,x,Pe]),nt=sn(w,U.inputRef),mt=o&&Array.isArray(A)&&A.length>0,gt=l.useMemo(()=>!o||!Array.isArray(A)||!S?null:A.map(H=>{const ce=ze(H,a);return y.jsx("input",{type:"hidden",name:S,value:ce},ce)}),[o,A,S,a]);return y.jsx(dn.Provider,{value:tt,children:y.jsxs(pn.Provider,{value:Oe,children:[I,y.jsx("input",{...U.getInputValidationProps({onFocus(){g.state.triggerElement?.focus({focusVisible:!0})},onChange(H){if(H.nativeEvent.defaultPrevented)return;const ce=H.target.value,Ce=xe(Dt,H.nativeEvent);function Ee(){if(o)return;const ve=fe.current.find(rt=>ze(rt,a).toLowerCase()===ce.toLowerCase());ve!=null&&(N(ve!==W.initialValue),Le(ve,Ce),K()&&U.commit(ve))}g.set("forceMount",!0),queueMicrotask(Ee)}}),name:o?void 0:S,value:le,disabled:B,required:p&&!mt,readOnly:m,ref:nt,style:S?Un:Bn,tabIndex:-1,"aria-hidden":!0}),gt]})})}function Ur(t){const e=t.getBoundingClientRect(),n=window.getComputedStyle(t,"::before"),s=window.getComputedStyle(t,"::after");if(!(n.content!=="none"||s.content!=="none"))return e;const r=parseFloat(n.width)||0,c=parseFloat(n.height)||0,u=parseFloat(s.width)||0,f=parseFloat(s.height)||0,d=Math.max(e.width,r,u),m=Math.max(e.height,c,f),p=d-e.width,b=m-e.height;return{left:e.left-p/2,right:e.right+p/2,top:e.top-b/2,bottom:e.bottom+b/2}}const lt=2,Br=400,Gt=200,_r={...zn,...fr,value:()=>null},zr=l.forwardRef(function(e,n){const{render:s,className:i,id:r,disabled:c=!1,nativeButton:u=!0,...f}=e,{setTouched:d,setFocused:m,validationMode:p,state:b,disabled:P}=an(),{labelId:w}=ur(),{store:x,setOpen:T,selectionRef:o,validation:R,readOnly:a,required:h,alignItemWithTriggerActiveRef:E,disabled:I,keyboardActiveRef:O}=ke(),N=P||I||c,re=j(x,V.open),ae=j(x,V.value),K=j(x,V.triggerProps),W=j(x,V.positionerElement),z=j(x,V.listElement),D=j(x,V.id),ee=j(x,V.hasSelectedValue),U=!ee&&re,te=j(x,V.hasNullItemLabel,U),v=r??D;un({id:v});const B=De(W),S=l.useRef(null),{getButtonProps:A,buttonRef:ie}=on({disabled:N,native:u}),M=de(X=>{x.set("triggerElement",X)}),oe=sn(n,S,ie,M),G=He(),k=He(),_=He(),ue=He();l.useEffect(()=>{if(re)return!(ee||te)?_.start(Br,()=>{o.current.allowUnselectedMouseUp=!0,o.current.allowSelectedMouseUp=!0}):ue.start(Gt,()=>{o.current.allowUnselectedMouseUp=!0,_.start(Gt,()=>{o.current.allowSelectedMouseUp=!0})}),()=>{_.clear(),ue.clear()};o.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1},k.clear()},[re,ee,te,o,k,_,ue]);const Ie=l.useMemo(()=>z?.id??tn(W)?.id,[z,W]),F=rn(K,{id:v,role:"combobox","aria-expanded":re?"true":"false","aria-haspopup":"listbox","aria-controls":re?Ie:void 0,"aria-labelledby":w,"aria-readonly":a||void 0,"aria-required":h||void 0,tabIndex:N?-1:0,ref:oe,onFocus(X){m(!0),re&&E.current&&T(!1,xe(Dt,X.nativeEvent)),G.start(0,()=>{x.set("forceMount",!0)})},onBlur(X){Ge(W,X.relatedTarget)||(d(!0),m(!1),p==="onBlur"&&R.commit(ae))},onPointerMove(){O.current=!1},onKeyDown(){O.current=!0},onMouseDown(X){if(re)return;const me=Ot(X.currentTarget);function we(pe){if(!S.current)return;const Q=pe.target;if(Ge(S.current,Q)||Ge(B.current,Q)||Q===S.current)return;const J=Ur(S.current);pe.clientX>=J.left-lt&&pe.clientX<=J.right+lt&&pe.clientY>=J.top-lt&&pe.clientY<=J.bottom+lt||T(!1,xe(_n,pe))}k.start(0,()=>{me.addEventListener("mouseup",we,{once:!0})})}},R.getValidationProps,f,A);F.role="combobox";const fe=l.useMemo(()=>({...b,open:re,disabled:N,value:ae,readOnly:a,placeholder:!ee}),[b,re,N,ae,a,ee]);return Ve("button",e,{ref:[n,S],state:fe,stateAttributesMapping:_r,props:F})}),Kr={value:()=>null},Wr=l.forwardRef(function(e,n){const{className:s,render:i,children:r,placeholder:c,...u}=e,{store:f,valueRef:d}=ke(),m=j(f,V.value),p=j(f,V.items),b=j(f,V.itemToStringLabel),P=j(f,V.hasSelectedValue),w=!P&&c!=null&&r==null,x=j(f,V.hasNullItemLabel,w),T=l.useMemo(()=>({value:m,placeholder:!P}),[m,P]);let o=null;return typeof r=="function"?o=r(m):r!=null?o=r:!P&&c!=null&&!x?o=c:Array.isArray(m)?o=Dr(m,p,b):o=hn(m,p,b),Ve("span",e,{state:T,ref:[n,d],props:[{children:o},u],stateAttributesMapping:Kr})}),$r=l.forwardRef(function(e,n){const{className:s,render:i,...r}=e,{store:c}=ke(),u=j(c,V.open),f=l.useMemo(()=>({open:u}),[u]);return Ve("span",e,{state:f,ref:n,props:[{"aria-hidden":!0,children:"▼"},r],stateAttributesMapping:Kn})}),qr=l.createContext(void 0),Yr=l.forwardRef(function(e,n){const{store:s}=ke(),i=j(s,V.mounted),r=j(s,V.forceMount);return i||r?y.jsx(qr.Provider,{value:!0,children:y.jsx(Wn,{ref:n,...e})}):null}),xn=l.createContext({register:()=>{},unregister:()=>{},subscribeMapChange:()=>()=>{},elementsRef:{current:[]},nextIndexRef:{current:0}});function Gr(){return l.useContext(xn)}function Xr(t){const{children:e,elementsRef:n,labelsRef:s,onMapChange:i}=t,r=de(i),c=l.useRef(0),u=Pt(Jr).current,f=Pt(Qr).current,[d,m]=l.useState(0),p=l.useRef(d),b=de((o,R)=>{f.set(o,R??null),p.current+=1,m(p.current)}),P=de(o=>{f.delete(o),p.current+=1,m(p.current)}),w=l.useMemo(()=>{const o=new Map;return Array.from(f.keys()).filter(a=>a.isConnected).sort(Zr).forEach((a,h)=>{const E=f.get(a)??{};o.set(a,{...E,index:h})}),o},[f,d]);Y(()=>{if(typeof MutationObserver!="function"||w.size===0)return;const o=new MutationObserver(R=>{const a=new Set,h=E=>a.has(E)?a.delete(E):a.add(E);R.forEach(E=>{E.removedNodes.forEach(h),E.addedNodes.forEach(h)}),a.size===0&&(p.current+=1,m(p.current))});return w.forEach((R,a)=>{a.parentElement&&o.observe(a.parentElement,{childList:!0})}),()=>{o.disconnect()}},[w]),Y(()=>{p.current===d&&(n.current.length!==w.size&&(n.current.length=w.size),s&&s.current.length!==w.size&&(s.current.length=w.size),c.current=w.size),r(w)},[r,w,n,s,d]),Y(()=>()=>{n.current=[]},[n]),Y(()=>()=>{s&&(s.current=[])},[s]);const x=de(o=>(u.add(o),()=>{u.delete(o)}));Y(()=>{u.forEach(o=>o(w))},[u,w]);const T=l.useMemo(()=>({register:b,unregister:P,subscribeMapChange:x,elementsRef:n,labelsRef:s,nextIndexRef:c}),[b,P,x,n,s,c]);return y.jsx(xn.Provider,{value:T,children:e})}function Qr(){return new Map}function Jr(){return new Set}function Zr(t,e){const n=t.compareDocumentPosition(e);return n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS?1:0}const yn=l.createContext(void 0);function Ht(){const t=l.useContext(yn);if(!t)throw new Error(ut(59));return t}function at(t,e){t&&Object.assign(t.style,e)}const bn={position:"relative",maxHeight:"100%",overflowX:"hidden",overflowY:"auto"},es={position:"fixed"},ts=l.forwardRef(function(e,n){const{anchor:s,positionMethod:i="absolute",className:r,render:c,side:u="bottom",align:f="center",sideOffset:d=0,alignOffset:m=0,collisionBoundary:p="clipping-ancestors",collisionPadding:b,arrowPadding:P=5,sticky:w=!1,disableAnchorTracking:x,alignItemWithTrigger:T=!0,collisionAvoidance:o=$n,...R}=e,{store:a,listRef:h,labelsRef:E,alignItemWithTriggerActiveRef:I,selectedItemTextRef:O,valuesRef:N,initialValueRef:re,popupRef:ae,setValue:K}=ke(),W=mn(),z=j(a,V.open),D=j(a,V.mounted),ee=j(a,V.modal),U=j(a,V.value),te=j(a,V.openMethod),v=j(a,V.positionerElement),B=j(a,V.triggerElement),S=j(a,V.isItemEqualToValue),A=l.useRef(null),ie=l.useRef(null),[M,oe]=l.useState(T),G=D&&M&&te!=="touch";!D&&M!==T&&oe(T),Y(()=>{D||(V.scrollUpArrowVisible(a.state)&&a.set("scrollUpArrowVisible",!1),V.scrollDownArrowVisible(a.state)&&a.set("scrollDownArrowVisible",!1))},[a,D]),l.useImperativeHandle(I,()=>G),qn((G||ee)&&z&&te!=="touch",B);const k=Yn({anchor:s,floatingRootContext:W,positionMethod:i,mounted:D,side:u,sideOffset:d,align:f,alignOffset:m,arrowPadding:P,collisionBoundary:p,collisionPadding:b,sticky:w,disableAnchorTracking:x??G,collisionAvoidance:o,keepMounted:!0}),_=G?"none":k.side,ue=G?es:k.positionerStyles,Ie=l.useMemo(()=>{const Q={};return z||(Q.pointerEvents="none"),{role:"presentation",hidden:!D,style:{...ue,...Q}}},[z,D,ue]),F=l.useMemo(()=>({open:z,side:_,align:k.align,anchorHidden:k.anchorHidden}),[z,_,k.align,k.anchorHidden]),fe=de(Q=>{a.set("positionerElement",Q)}),X=Ve("div",e,{ref:[n,fe],state:F,stateAttributesMapping:ln,props:[Ie,R]}),me=l.useRef(0),we=de(Q=>{if(Q.size===0&&me.current===0||N.current.length===0)return;const J=me.current;if(me.current=Q.size,Q.size===J)return;const ye=xe(Dt);if(J!==0&&!a.state.multiple&&U!==null&&Nt(N.current,U,S)===-1){const ne=re.current,Ae=ne!=null&&It(N.current,ne,S)?ne:null;K(Ae,ye),Ae===null&&(a.set("selectedIndex",null),O.current=null)}if(J!==0&&a.state.multiple&&Array.isArray(U)){const se=U.filter(ne=>It(N.current,ne,S));(se.length!==U.length||se.some(ne=>!It(U,ne,S)))&&(K(se,ye),se.length===0&&(a.set("selectedIndex",null),O.current=null))}if(z&&G){a.update({scrollUpArrowVisible:!1,scrollDownArrowVisible:!1});const se={height:""};at(v,se),at(ae.current,se)}}),pe=l.useMemo(()=>({...k,side:_,alignItemWithTriggerActive:G,setControlledAlignItemWithTrigger:oe,scrollUpArrowRef:A,scrollDownArrowRef:ie}),[k,_,G,oe]);return y.jsx(Xr,{elementsRef:h,labelsRef:E,onMapChange:we,children:y.jsxs(yn.Provider,{value:pe,children:[D&&ee&&y.jsx(Gn,{inert:Xn(!z),cutout:B}),X]})})});function Rn(t){const e=t.currentTarget.getBoundingClientRect();return e.top+1<=t.clientY&&t.clientY<=e.bottom-1&&e.left+1<=t.clientX&&t.clientX<=e.right-1}const ct="base-ui-disable-scrollbar",kt={className:ct,getElement(t){return y.jsx("style",{nonce:t,href:ct,precedence:"base-ui:low",children:`.${ct}{scrollbar-width:none}.${ct}::-webkit-scrollbar{display:none}`})}},ns=l.createContext(void 0);function rs(t){return l.useContext(ns)}function ss(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const os=l.createContext(void 0),is={disableStyleElements:!1};function ls(){return l.useContext(os)??is}const cs={...ln,...cn},as=l.forwardRef(function(e,n){const{render:s,className:i,...r}=e,{store:c,popupRef:u,onOpenChangeComplete:f,setOpen:d,valueRef:m,selectedItemTextRef:p,keyboardActiveRef:b,multiple:P,handleScrollArrowVisibility:w,scrollHandlerRef:x,highlightItemOnHover:T}=ke(),{side:o,align:R,alignItemWithTriggerActive:a,setControlledAlignItemWithTrigger:h,scrollDownArrowRef:E,scrollUpArrowRef:I}=Ht(),O=rs()!=null,N=mn(),{nonce:re,disableStyleElements:ae}=ls(),K=He(),W=j(c,V.id),z=j(c,V.open),D=j(c,V.mounted),ee=j(c,V.popupProps),U=j(c,V.transitionStatus),te=j(c,V.triggerElement),v=j(c,V.positionerElement),B=j(c,V.listElement),S=l.useRef(0),A=l.useRef(!1),ie=l.useRef(0),M=l.useRef(!1),oe=l.useRef({}),G=Zt(),k=de(F=>{if(!v||!u.current||!M.current)return;if(A.current||!a){w();return}const fe=v.style.top==="0px",X=v.style.bottom==="0px",me=v.getBoundingClientRect().height,we=Ot(v),pe=getComputedStyle(v),Q=parseFloat(pe.marginTop),J=parseFloat(pe.marginBottom),ye=Xt(getComputedStyle(u.current)),se=we.documentElement.clientHeight-Q-J,ne=F.scrollTop,Te=F.scrollHeight,Ae=F.clientHeight,g=Te-Ae;let L=0,C=null,$=!1;if(fe){const Z=g-ne,le=me+Z,ge=Math.min(le,se);L=ge,ge!==se?C=g:$=!0}else if(X){const Z=ne-0,le=me+Z,ge=Math.min(le,se),be=le-se;L=ge,ge!==se?C=0:($=!0,ne<g&&(C=ne-(Z-be)))}L!==0&&(v.style.height=`${L}px`),C!=null&&(F.scrollTop=C),($||L>=ye)&&(A.current=!0),w()});l.useImperativeHandle(x,()=>k,[k]),ft({open:z,ref:u,onComplete(){z&&f?.(!0)}});const _=l.useMemo(()=>({open:z,transitionStatus:U,side:o,align:R}),[z,U,o,R]);Y(()=>{!v||!u.current||Object.keys(oe.current).length||(oe.current={top:v.style.top||"0",left:v.style.left||"0",right:v.style.right,height:v.style.height,bottom:v.style.bottom,minHeight:v.style.minHeight,maxHeight:v.style.maxHeight,marginTop:v.style.marginTop,marginBottom:v.style.marginBottom})},[u,v]),Y(()=>{z||a||(M.current=!1,A.current=!1,S.current=0,ie.current=0,at(v,oe.current))},[z,a,v,u]),Y(()=>{const F=u.current;if(!(!z||!te||!v||!F||c.state.transitionStatus==="ending")){if(!a){M.current=!0,G.request(w),F.style.removeProperty("--transform-origin");return}queueMicrotask(()=>{const fe=fs(F);F.style.removeProperty("--transform-origin");try{const X=getComputedStyle(v),me=getComputedStyle(F),we=Ot(te),pe=Kt(v),Q=te.getBoundingClientRect(),J=v.getBoundingClientRect(),ye=Q.left,se=Q.height,ne=B||F,Te=ne.scrollHeight,Ae=parseFloat(me.borderBottomWidth),g=parseFloat(X.marginTop)||10,L=parseFloat(X.marginBottom)||10,C=parseFloat(X.minHeight)||100,$=Xt(me),Z=5,le=5,ge=20,be=we.documentElement.clientHeight-g-L,je=we.documentElement.clientWidth,Se=be-Q.bottom+se,Me=p.current,Le=m.current;let Pe,Oe=0,Ze=0;if(Me&&Le){const H=Le.getBoundingClientRect();Pe=Me.getBoundingClientRect();const ce=H.left-ye,Ce=Pe.left-J.left,Ee=H.top-Q.top+H.height/2,ve=Pe.top-J.top+Pe.height/2;Oe=ce-Ce,Ze=ve-Ee}const qe=Se+Ze+L+Ae;let Ne=Math.min(be,qe);const pt=be-g-L,Be=qe-Ne,_e=Math.max(Z,ye+Oe),et=je-le,Ye=Math.max(0,_e+J.width-et);v.style.left=`${_e-Ye}px`,v.style.height=`${Ne}px`,v.style.maxHeight="auto",v.style.marginTop=`${g}px`,v.style.marginBottom=`${L}px`,F.style.height="100%";const tt=ne.scrollHeight-ne.clientHeight,nt=Be>=tt;nt&&(Ne=Math.min(be,J.height)-(Be-tt));const mt=Q.top<ge||Q.bottom>be-ge||Ne<Math.min(Te,C),gt=(pe.visualViewport?.scale??1)!==1&&Qn;if(mt||gt){M.current=!0,at(v,oe.current),Jn.flushSync(()=>h(!1));return}if(nt){const H=Math.max(0,be-qe);v.style.top=J.height>=pt?"0":`${H}px`,v.style.height=`${Ne}px`,ne.scrollTop=ne.scrollHeight-ne.clientHeight,S.current=Math.max(C,Ne)}else v.style.bottom="0",S.current=Math.max(C,Ne),ne.scrollTop=Be;if(Pe){const H=J.top,ce=J.height,Ce=Pe.top+Pe.height/2,Ee=ce>0?(Ce-H)/ce*100:50,ve=ss(Ee,0,100);F.style.setProperty("--transform-origin",`50% ${ve}%`)}(S.current===be||Ne>=$)&&(A.current=!0),w(),setTimeout(()=>{M.current=!0})}finally{fe()}})}},[c,z,v,te,m,p,u,w,a,h,G,E,I,B]),l.useEffect(()=>{if(!a||!v||!z)return;const F=Kt(v);function fe(X){d(!1,xe(er,X))}return F.addEventListener("resize",fe),()=>{F.removeEventListener("resize",fe)}},[d,a,v,z]);const ue={...B?{role:"presentation","aria-orientation":void 0}:{role:"listbox","aria-multiselectable":P||void 0,id:`${W}-list`},onKeyDown(F){b.current=!0,O&&nr.has(F.key)&&F.stopPropagation()},onMouseMove(){b.current=!1},onPointerLeave(F){if(!T||Rn(F)||F.pointerType==="touch")return;const fe=F.currentTarget;K.start(0,()=>{c.set("activeIndex",null),fe.focus({preventScroll:!0})})},onScroll(F){B||x.current?.(F.currentTarget)},...a&&{style:B?{height:"100%"}:bn}},Ie=Ve("div",e,{ref:[n,u],state:_,stateAttributesMapping:cs,props:[ee,ue,tr(U),{className:!B&&a?kt.className:void 0},r]});return y.jsxs(l.Fragment,{children:[!ae&&kt.getElement(re),y.jsx(Zn,{context:N,modal:!1,disabled:!D,restoreFocus:!0,children:Ie})]})});function Xt(t){const e=t.maxHeight||"";return e.endsWith("px")&&parseFloat(e)||1/0}const Qt={transform:"none",scale:"1",translate:"0 0"};function us(t,e,n){n?t.setProperty(e,n):t.removeProperty(e)}function fs(t){const{style:e}=t,n={},s=Object.keys(Qt);for(const i of s)n[i]=e.getPropertyValue(i),e.setProperty(i,Qt[i]);return()=>{for(const i of s)us(e,i,n[i])}}const ds=l.forwardRef(function(e,n){const{className:s,render:i,...r}=e,{store:c,scrollHandlerRef:u}=ke(),{alignItemWithTriggerActive:f}=Ht(),d=j(c,V.hasScrollArrows),m=j(c,V.openMethod),p=j(c,V.multiple),P={id:`${j(c,V.id)}-list`,role:"listbox","aria-multiselectable":p||void 0,onScroll(x){u.current?.(x.currentTarget)},...f&&{style:bn},className:d&&m!=="touch"?kt.className:void 0},w=de(x=>{c.set("listElement",x)});return Ve("div",e,{ref:[n,w],props:[P,r]})});let wn=(function(t){return t[t.None=0]="None",t[t.GuessFromOrder=1]="GuessFromOrder",t})({});function ps(t={}){const{label:e,metadata:n,textRef:s,indexGuessBehavior:i,index:r}=t,{register:c,unregister:u,subscribeMapChange:f,elementsRef:d,labelsRef:m,nextIndexRef:p}=Gr(),b=l.useRef(-1),[P,w]=l.useState(r??(i===wn.GuessFromOrder?()=>{if(b.current===-1){const o=p.current;p.current+=1,b.current=o}return b.current}:-1)),x=l.useRef(null),T=l.useCallback(o=>{if(x.current=o,P!==-1&&o!==null&&(d.current[P]=o,m)){const R=e!==void 0;m.current[P]=R?e:s?.current?.textContent??o.textContent}},[P,d,m,e,s]);return Y(()=>{if(r!=null)return;const o=x.current;if(o)return c(o,n),()=>{u(o)}},[r,c,u,n]),Y(()=>{if(r==null)return f(o=>{const R=x.current?o.get(x.current)?.index:null;R!=null&&w(R)})},[r,f,w]),l.useMemo(()=>({ref:T,index:P}),[P,T])}const Sn=l.createContext(void 0);function Ft(){const t=l.useContext(Sn);if(!t)throw new Error(ut(57));return t}const ms=l.memo(l.forwardRef(function(e,n){const{render:s,className:i,value:r=null,label:c,disabled:u=!1,nativeButton:f=!1,...d}=e,m=l.useRef(null),p=ps({label:c,textRef:m,indexGuessBehavior:wn.GuessFromOrder}),{store:b,getItemProps:P,setOpen:w,setValue:x,selectionRef:T,typingRef:o,valuesRef:R,keyboardActiveRef:a,multiple:h,highlightItemOnHover:E}=ke(),I=He(),O=j(b,V.isActive,p.index),N=j(b,V.isSelected,p.index,r),re=j(b,V.isSelectedByFocus,p.index),ae=j(b,V.isItemEqualToValue),K=p.index,W=K!==-1,z=l.useRef(null),D=De(K);Y(()=>{if(!W)return;const k=R.current;return k[K]=r,()=>{delete k[K]}},[W,K,r,R]),Y(()=>{if(!W)return;const k=b.state.value;let _=k;h&&Array.isArray(k)&&k.length>0&&(_=k[k.length-1]),_!==void 0&&Ke(_,r,ae)&&b.set("selectedIndex",K)},[W,K,h,ae,b,r]);const ee=l.useMemo(()=>({disabled:u,selected:N,highlighted:O}),[u,N,O]),U=P({active:O,selected:N});U.onFocus=void 0,U.id=void 0;const te=l.useRef(null),v=l.useRef("mouse"),B=l.useRef(!1),{getButtonProps:S,buttonRef:A}=on({disabled:u,focusableWhenDisabled:!0,native:f});function ie(k){const _=b.state.value;if(h){const ue=Array.isArray(_)?_:[],Ie=N?kr(ue,r,ae):[...ue,r];x(Ie,xe(yt,k))}else x(r,xe(yt,k)),w(!1,xe(yt,k))}const M={role:"option","aria-selected":N,tabIndex:O?0:-1,onFocus(){b.set("activeIndex",K)},onMouseEnter(){!a.current&&b.state.selectedIndex===null&&b.set("activeIndex",K)},onMouseMove(){E&&b.set("activeIndex",K)},onMouseLeave(k){!E||a.current||Rn(k)||I.start(0,()=>{b.state.activeIndex===K&&b.set("activeIndex",null)})},onTouchStart(){T.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}},onKeyDown(k){te.current=k.key,b.set("activeIndex",K)},onClick(k){B.current=!1,!(k.type==="keydown"&&te.current===null)&&(u||te.current===" "&&o.current||v.current!=="touch"&&!O||(te.current=null,ie(k.nativeEvent)))},onPointerEnter(k){v.current=k.pointerType},onPointerDown(k){v.current=k.pointerType,B.current=!0},onMouseUp(k){if(u)return;if(B.current){B.current=!1;return}const _=!T.current.allowSelectedMouseUp&&N,ue=!T.current.allowUnselectedMouseUp&&!N;_||ue||v.current!=="touch"&&!O||ie(k.nativeEvent)}},oe=Ve("div",e,{ref:[A,n,p.ref,z],state:ee,props:[U,M,d,S]}),G=l.useMemo(()=>({selected:N,indexRef:D,textRef:m,selectedByFocus:re,hasRegistered:W}),[N,D,m,re,W]);return y.jsx(Sn.Provider,{value:G,children:oe})})),gs=l.forwardRef(function(e,n){const s=e.keepMounted??!1,{selected:i}=Ft();return s||i?y.jsx(hs,{...e,ref:n}):null}),hs=l.memo(l.forwardRef((t,e)=>{const{render:n,className:s,keepMounted:i,...r}=t,{selected:c}=Ft(),u=l.useRef(null),{transitionStatus:f,setMounted:d}=Lt(c),m=l.useMemo(()=>({selected:c,transitionStatus:f}),[c,f]),p=Ve("span",t,{ref:[e,u],state:m,props:[{"aria-hidden":!0,children:"✔️"},r],stateAttributesMapping:cn});return ft({open:c,ref:u,onComplete(){c||d(!1)}}),p})),xs=l.memo(l.forwardRef(function(e,n){const{indexRef:s,textRef:i,selectedByFocus:r,hasRegistered:c}=Ft(),{selectedItemTextRef:u}=ke(),{className:f,render:d,...m}=e,p=l.useCallback(P=>{if(!P||!c)return;const w=u.current===null||!u.current.isConnected;(r||w&&s.current===0)&&(u.current=P)},[u,s,r,c]);return Ve("div",e,{ref:[p,n,i],props:m})})),In=l.forwardRef(function(e,n){const{render:s,className:i,direction:r,keepMounted:c=!1,...u}=e,{store:f,popupRef:d,listRef:m,handleScrollArrowVisibility:p,scrollArrowsMountedCountRef:b}=ke(),{side:P,scrollDownArrowRef:w,scrollUpArrowRef:x}=Ht(),T=r==="up"?V.scrollUpArrowVisible:V.scrollDownArrowVisible,o=j(f,T),R=j(f,V.openMethod),a=o&&R!=="touch",h=He(),E=r==="up"?x:w,{transitionStatus:I,setMounted:O}=Lt(a);Y(()=>(b.current+=1,f.state.hasScrollArrows||f.set("hasScrollArrows",!0),()=>{b.current=Math.max(0,b.current-1),b.current===0&&f.state.hasScrollArrows&&f.set("hasScrollArrows",!1)}),[f,b]),ft({open:a,ref:E,onComplete(){a||O(!1)}});const N=l.useMemo(()=>({direction:r,visible:a,side:P,transitionStatus:I}),[r,a,P,I]),ae=Ve("div",e,{ref:[n,E],state:N,props:[{"aria-hidden":!0,children:r==="up"?"▲":"▼",style:{position:"absolute"},onMouseMove(W){if(W.movementX===0&&W.movementY===0||h.isStarted())return;f.set("activeIndex",null);function z(){const D=f.state.listElement??d.current;if(!D)return;f.set("activeIndex",null),p();const ee=D.scrollTop===0,U=Math.round(D.scrollTop+D.clientHeight)>=D.scrollHeight;if(m.current.length===0&&(r==="up"?f.set("scrollUpArrowVisible",!ee):f.set("scrollDownArrowVisible",!U)),r==="up"&&ee||r==="down"&&U){h.clear();return}if((f.state.listElement||d.current)&&m.current&&m.current.length>0){const v=m.current,B=E.current?.offsetHeight||0;if(r==="up"){let S=0;const A=D.scrollTop+B;for(let M=0;M<v.length;M+=1){const oe=v[M];if(oe&&oe.offsetTop>=A){S=M;break}}const ie=Math.max(0,S-1);if(ie<S){const M=v[ie];M&&(D.scrollTop=Math.max(0,M.offsetTop-B))}else D.scrollTop=0}else{let S=v.length-1;const A=D.scrollTop+D.clientHeight-B;for(let M=0;M<v.length;M+=1){const oe=v[M];if(oe&&oe.offsetTop+oe.offsetHeight>A){S=Math.max(0,M-1);break}}const ie=Math.min(v.length-1,S+1);if(ie>S){const M=v[ie];M&&(D.scrollTop=M.offsetTop+M.offsetHeight-D.clientHeight+B)}else D.scrollTop=D.scrollHeight-D.clientHeight}}h.start(40,z)}h.start(40,z)},onMouseLeave(){h.clear()}},u]});return a||c?ae:null}),ys=l.forwardRef(function(e,n){return y.jsx(In,{...e,ref:n,direction:"down"})}),bs=l.forwardRef(function(e,n){return y.jsx(In,{...e,ref:n,direction:"up"})}),vt=Fr;function Tt(t){const e=We.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let i;e[3]!==n?(i=$e("flex flex-1 text-left",n),e[3]=n,e[4]=i):i=e[4];let r;return e[5]!==s||e[6]!==i?(r=y.jsx(Wr,{className:i,"data-slot":"select-value",...s}),e[5]=s,e[6]=i,e[7]=r):r=e[7],r}function Mt(t){const e=We.c(15);let n,s,i,r,c;e[0]!==t?({className:s,size:c,id:i,children:n,...r}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=i,e[4]=r,e[5]=c):(n=e[1],s=e[2],i=e[3],r=e[4],c=e[5]);const u=c===void 0?"default":c;let f;e[6]!==s?(f=$e("flex w-fit items-center justify-between gap-1.5 whitespace-nowrap rounded-md border border-input bg-input/20 px-2 py-1.5 text-xs/relaxed outline-none transition-colors focus-visible:border-ring focus-visible:ring-2 focus-visible:ring-ring/30 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-2 aria-invalid:ring-destructive/20 data-[size=default]:h-7 data-[size=sm]:h-6 data-placeholder:text-muted-foreground *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-1.5 dark:bg-input/30 dark:aria-invalid:border-destructive/50 dark:aria-invalid:ring-destructive/40 dark:hover:bg-input/50 [&_svg:not([class*='size-'])]:size-3.5 [&_svg]:pointer-events-none [&_svg]:shrink-0",s),e[6]=s,e[7]=f):f=e[7];let d;e[8]===Symbol.for("react.memo_cache_sentinel")?(d=y.jsx($r,{render:y.jsx(fn,{className:"pointer-events-none size-3.5 text-muted-foreground"})}),e[8]=d):d=e[8];let m;return e[9]!==n||e[10]!==i||e[11]!==r||e[12]!==u||e[13]!==f?(m=y.jsxs(zr,{className:f,"data-size":u,"data-slot":"select-trigger",id:i,...r,children:[n,d]}),e[9]=n,e[10]=i,e[11]=r,e[12]=u,e[13]=f,e[14]=m):m=e[14],m}function Ct(t){const e=We.c(26);let n,s,i,r,c,u,f,d;e[0]!==t?({className:s,children:n,side:r,sideOffset:c,align:u,alignOffset:f,alignItemWithTrigger:d,...i}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=i,e[4]=r,e[5]=c,e[6]=u,e[7]=f,e[8]=d):(n=e[1],s=e[2],i=e[3],r=e[4],c=e[5],u=e[6],f=e[7],d=e[8]);const m=r===void 0?"bottom":r,p=c===void 0?4:c,b=u===void 0?"center":u,P=f===void 0?0:f,w=d===void 0?!0:d;let x;e[9]!==s?(x=$e("data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative isolate z-50 max-h-(--available-height) w-(--anchor-width) min-w-32 origin-(--transform-origin) overflow-y-auto overflow-x-hidden rounded-lg bg-popover text-popover-foreground shadow-md ring-1 ring-foreground/10 duration-100 data-closed:animate-out data-open:animate-in",s),e[9]=s,e[10]=x):x=e[10];let T;e[11]===Symbol.for("react.memo_cache_sentinel")?(T=y.jsx(Rs,{}),e[11]=T):T=e[11];let o;e[12]!==n?(o=y.jsx(ds,{children:n}),e[12]=n,e[13]=o):o=e[13];let R;e[14]===Symbol.for("react.memo_cache_sentinel")?(R=y.jsx(ws,{}),e[14]=R):R=e[14];let a;e[15]!==i||e[16]!==x||e[17]!==o?(a=y.jsxs(as,{className:x,"data-slot":"select-content",...i,children:[T,o,R]}),e[15]=i,e[16]=x,e[17]=o,e[18]=a):a=e[18];let h;return e[19]!==b||e[20]!==w||e[21]!==P||e[22]!==m||e[23]!==p||e[24]!==a?(h=y.jsx(Yr,{children:y.jsx(ts,{align:b,alignItemWithTrigger:w,alignOffset:P,className:"isolate z-50",side:m,sideOffset:p,children:a})}),e[19]=b,e[20]=w,e[21]=P,e[22]=m,e[23]=p,e[24]=a,e[25]=h):h=e[25],h}function Et(t){const e=We.c(13);let n,s,i;e[0]!==t?({className:s,children:n,...i}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=i):(n=e[1],s=e[2],i=e[3]);let r;e[4]!==s?(r=$e("relative flex min-h-7 w-full cursor-default select-none items-center gap-2 rounded-md px-2 py-1 text-xs/relaxed outline-hidden focus:bg-accent focus:text-accent-foreground not-data-[variant=destructive]:focus:**:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg:not([class*='size-'])]:size-3.5 [&_svg]:pointer-events-none [&_svg]:shrink-0 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),e[4]=s,e[5]=r):r=e[5];let c;e[6]!==n?(c=y.jsx(xs,{className:"flex flex-1 shrink-0 gap-2 whitespace-nowrap",children:n}),e[6]=n,e[7]=c):c=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=y.jsx(gs,{render:y.jsx("span",{className:"pointer-events-none absolute right-2 flex items-center justify-center"}),children:y.jsx(xr,{className:"pointer-events-none"})}),e[8]=u):u=e[8];let f;return e[9]!==i||e[10]!==r||e[11]!==c?(f=y.jsxs(ms,{className:r,"data-slot":"select-item",...i,children:[c,u]}),e[9]=i,e[10]=r,e[11]=c,e[12]=f):f=e[12],f}function Rs(t){const e=We.c(9);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let i;e[3]!==n?(i=$e("top-0 z-10 flex w-full cursor-default items-center justify-center bg-popover py-1 [&_svg:not([class*='size-'])]:size-3.5",n),e[3]=n,e[4]=i):i=e[4];let r;e[5]===Symbol.for("react.memo_cache_sentinel")?(r=y.jsx(wr,{}),e[5]=r):r=e[5];let c;return e[6]!==s||e[7]!==i?(c=y.jsx(bs,{className:i,"data-slot":"select-scroll-up-button",...s,children:r}),e[6]=s,e[7]=i,e[8]=c):c=e[8],c}function ws(t){const e=We.c(9);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let i;e[3]!==n?(i=$e("bottom-0 z-10 flex w-full cursor-default items-center justify-center bg-popover py-1 [&_svg:not([class*='size-'])]:size-3.5",n),e[3]=n,e[4]=i):i=e[4];let r;e[5]===Symbol.for("react.memo_cache_sentinel")?(r=y.jsx(fn,{}),e[5]=r):r=e[5];let c;return e[6]!==s||e[7]!==i?(c=y.jsx(ys,{className:i,"data-slot":"select-scroll-down-button",...s,children:r}),e[6]=s,e[7]=i,e[8]=c):c=e[8],c}const Ss=["sg-placeholder"],Is="subnet-placeholder";function ks(){const t=rr(),{data:e}=Rt(sr),{data:n}=Rt(or),{data:s}=Rt(ir),i=yr(),r=e.Images??[],c=n.KeyPairs??[],u=s.InstanceTypes?.flatMap(I=>I.InstanceType?[I.InstanceType]:[])??[],f=s.InstanceTypes?.reduce((I,O)=>{const N=O.InstanceType;return N&&(I[N]=(I[N]||0)+1),I},{})??{},d=Object.keys(f).sort(),m=r[0]?.ImageId,p=c[0]?.KeyName,b=d.find(I=>I.endsWith(".nano"))??d[0],{control:P,handleSubmit:w,register:x,watch:T,formState:{errors:o,isSubmitting:R}}=dr({resolver:pr(lr.refine(I=>I.count<=(f[I.instanceType]??1),{message:"Cannot exceed available capacity",path:["count"]})),defaultValues:{count:1,imageId:m??"",keyName:p??"",instanceType:b??""}}),a=T("instanceType"),h=a?f[a]??1:1,E=async I=>{await i.mutateAsync({...I,securityGroupIds:Ss,subnetId:Is}),t({to:"/ec2/describe-instances"})};return y.jsxs(y.Fragment,{children:[y.jsx(gr,{to:"/ec2/describe-instances",children:"Back to instances"}),y.jsx(hr,{title:"Run EC2 Instances"}),u.length===0&&y.jsx(qt,{msg:"No compute available. No new instances can be created until compute is available."}),i.error&&y.jsx(qt,{error:i.error,msg:"Failed to create instance"}),y.jsxs("form",{className:"max-w-4xl space-y-6",onSubmit:w(E),children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx(st,{htmlFor:"imageId",children:"Image"}),y.jsx(bt,{control:P,name:"imageId",render:({field:I})=>{const O=r.find(N=>N.ImageId===I.value);return y.jsxs(vt,{onValueChange:N=>I.onChange(N),value:I.value??"",children:[y.jsx(Mt,{className:"w-full",id:"imageId",children:y.jsx(Tt,{children:O?`${O.Name||"Unnamed"} (${O.Architecture})`:""})}),y.jsx(Ct,{children:r.map(N=>y.jsxs(Et,{value:N.ImageId??"",children:[N.Name||"Unnamed"," (",N.Architecture,")"]},N.ImageId))})]})}}),o.imageId&&y.jsx("p",{className:"text-destructive text-sm",children:o.imageId.message})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx(st,{htmlFor:"instanceType",children:"Instance Type"}),y.jsx(bt,{control:P,name:"instanceType",render:({field:I})=>y.jsxs(vt,{onValueChange:O=>I.onChange(O),value:I.value?I.value:"",children:[y.jsx(Mt,{className:"w-full",id:"instanceType",children:y.jsx(Tt,{})}),y.jsx(Ct,{children:d.map(O=>y.jsxs(Et,{value:O,children:[O," (",f[O]," available)"]},O))})]})}),o.instanceType&&y.jsx("p",{className:"text-destructive text-sm",children:o.instanceType.message})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx(st,{htmlFor:"keyName",children:"Key Pair"}),y.jsx(bt,{control:P,name:"keyName",render:({field:I})=>y.jsxs(vt,{onValueChange:O=>I.onChange(O),value:I.value?I.value:"",children:[y.jsx(Mt,{className:"w-full",id:"keyName",children:y.jsx(Tt,{})}),y.jsx(Ct,{children:c.map(O=>y.jsx(Et,{value:O.KeyName??"",children:O.KeyName},O.KeyPairId))})]})}),o.keyName&&y.jsx("p",{className:"text-destructive text-sm",children:o.keyName.message})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx(st,{htmlFor:"count",children:"Number of Instances"}),y.jsx(mr,{id:"count",type:"number",...x("count",{valueAsNumber:!0})}),y.jsx("p",{className:"text-muted-foreground text-xs",id:"count-description",children:a&&`Available capacity for ${a}: ${h}`}),o.count&&y.jsx("p",{className:"text-destructive text-sm",children:o.count.message})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(Wt,{disabled:R||i.isPending,onClick:()=>t({to:"/ec2/describe-instances"}),type:"button",variant:"outline",children:"Cancel"}),y.jsx(Wt,{disabled:R||i.isPending||u.length===0,type:"submit",children:R||i.isPending?"Creating…":"Create Instance"})]})]})]})}export{ks as component};
