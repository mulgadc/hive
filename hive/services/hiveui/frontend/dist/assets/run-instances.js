import{g as rn,A as Dt,h as Se,i as tt,k as Le,l as De,m as Bt,t as Pn,r as i,n as on,p as ke,q as zt,v as On,w as ye,x as Nn,E as sn,y as ln,z as Ve,C as jn,D as kn,F as Z,G as Vn,H as pe,I as Wt,J as Kt,K as mt,M as Ue,N as wt,P as $t,Q as Ln,R as cn,S as Dn,T as Fn,U as ht,j as h,V as J,W as qt,X as Ft,Y as Hn,Z as kt,_ as Un,$ as F,a0 as _n,a1 as xt,a2 as Bn,a3 as zn,a4 as Wn,a5 as an,a6 as Kn,a7 as un,a8 as $n,a9 as qn,aa as Ht,ab as fn,ac as Ne,ad as Yn,ae as Gn,af as Xn,ag as Qn,ah as Jn,ai as Zn,aj as er,ak as tr,al as nr,am as dn,an as pn,ao as Yt,ap as rr,aq as or,ar as sr,as as ir,at as mn,au as lr,av as It,c as qe,a as Ye,u as cr,aw as ar,ax as ur,ay as fr,B as Gt}from"./index.js";import{e as dr,f as gn,g as hn,h as Xt,i as pr,j as mr,k as gr,u as hr,a as xr,c as lt,b as ct,C as vt,F as at,I as yr}from"./field.js";import{u as Tt}from"./useSuspenseQuery.js";import{B as br}from"./back-link.js";import{E as Qt}from"./error-banner.js";import{P as Rr}from"./page-heading.js";import{C as Sr}from"./check.js";import{c as wr}from"./ec2.js";import{b as Ir}from"./ec22.js";const vr=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],xn=rn("chevron-down",vr);const Tr=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Mr=rn("chevron-up",Tr);function ut(t,e,n){return Math.floor(t/e)!==n}function Je(t,e){return e<0||e>=t.current.length}function Mt(t,e){return xe(t,{disabledIndices:e})}function Jt(t,e){return xe(t,{decrement:!0,startingIndex:t.current.length,disabledIndices:e})}function xe(t,{startingIndex:e=-1,decrement:n=!1,disabledIndices:r,amount:s=1}={}){let o=e;do o+=n?-s:s;while(o>=0&&o<=t.current.length-1&&Ze(t,o,r));return o}function Cr(t,{event:e,orientation:n,loopFocus:r,rtl:s,cols:o,disabledIndices:c,minIndex:u,maxIndex:f,prevIndex:p,stopEvent:y=!1}){let a=p;const R=[],w={};let T=!1;{let l=null,g=-1;t.current.forEach((m,d)=>{if(m==null)return;const x=m.closest('[role="row"]');x&&(T=!0),(x!==l||g===-1)&&(l=x,g+=1,R[g]=[]),R[g].push(d),w[d]=g})}const b=T&&R.length>0&&R.some(l=>l.length!==o);function I(l){if(!b||p===-1)return;const g=w[p];if(g==null)return;const m=R[g].indexOf(p);let d=l==="up"?g-1:g+1;r&&(d<0?d=R.length-1:d>=R.length&&(d=0));const x=new Set;for(;d>=0&&d<R.length&&!x.has(d);){x.add(d);const A=R[d];if(A.length===0){d=l==="up"?d-1:d+1;continue}const P=Math.min(m,A.length-1);for(let N=P;N>=0;N-=1){const ee=A[N];if(!Ze(t,ee,c))return ee}d=l==="up"?d-1:d+1,r&&(d<0?d=R.length-1:d>=R.length&&(d=0))}}if(e.key===Dt){const l=I("up");if(l!==void 0)y&&Se(e),a=l;else{if(y&&Se(e),p===-1)a=f;else if(a=xe(t,{startingIndex:a,amount:o,decrement:!0,disabledIndices:c}),r&&(p-o<u||a<0)){const g=p%o,m=f%o,d=f-(m-g);m===g?a=f:a=m>g?d:d-o}Je(t,a)&&(a=p)}}if(e.key===tt){const l=I("down");l!==void 0?(y&&Se(e),a=l):(y&&Se(e),p===-1?a=u:(a=xe(t,{startingIndex:p,amount:o,disabledIndices:c}),r&&p+o>f&&(a=xe(t,{startingIndex:p%o-o,amount:o,disabledIndices:c}))),Je(t,a)&&(a=p))}if(n==="both"){const l=Bt(p/o);e.key===(s?Le:De)&&(y&&Se(e),p%o!==o-1?(a=xe(t,{startingIndex:p,disabledIndices:c}),r&&ut(a,o,l)&&(a=xe(t,{startingIndex:p-p%o-1,disabledIndices:c}))):r&&(a=xe(t,{startingIndex:p-p%o-1,disabledIndices:c})),ut(a,o,l)&&(a=p)),e.key===(s?De:Le)&&(y&&Se(e),p%o!==0?(a=xe(t,{startingIndex:p,decrement:!0,disabledIndices:c}),r&&ut(a,o,l)&&(a=xe(t,{startingIndex:p+(o-p%o),decrement:!0,disabledIndices:c}))):r&&(a=xe(t,{startingIndex:p+(o-p%o),decrement:!0,disabledIndices:c})),ut(a,o,l)&&(a=p));const g=Bt(f/o)===l;Je(t,a)&&(r&&g?a=e.key===(s?De:Le)?f:xe(t,{startingIndex:p-p%o-1,disabledIndices:c}):a=p)}return a}function Er(t,e,n){const r=[];let s=0;return t.forEach(({width:o,height:c},u)=>{let f=!1;for(;!f;){const p=[];for(let y=0;y<o;y+=1)for(let a=0;a<c;a+=1)p.push(s+y+a*e);s%e+o<=e&&p.every(y=>r[y]==null)?(p.forEach(y=>{r[y]=u}),f=!0):s+=1}}),[...r]}function Ar(t,e,n,r,s){if(t===-1)return-1;const o=n.indexOf(t),c=e[t];switch(s){case"tl":return o;case"tr":return c?o+c.width-1:o;case"bl":return c?o+(c.height-1)*r:o;case"br":return n.lastIndexOf(t);default:return-1}}function Pr(t,e){return e.flatMap((n,r)=>t.includes(n)?[r]:[])}function Ze(t,e,n){if(typeof n=="function")return n(e);if(n)return n.includes(e);const r=t.current[e];return r?r.hasAttribute("disabled")||r.getAttribute("aria-disabled")==="true":!1}function Or(t,e={}){const n="rootStore"in t?t.rootStore:t,r=n.context.dataRef,{enabled:s=!0,event:o="click",toggle:c=!0,ignoreMouse:u=!1,stickIfOpen:f=!0,touchOpenDelay:p=0,reason:y=Pn}=e,a=i.useRef(void 0),R=on(),w=ke(),T=i.useMemo(()=>({onPointerDown(b){a.current=b.pointerType},onMouseDown(b){const I=a.current,l=b.nativeEvent,g=n.select("open");if(b.button!==0||o==="click"||zt(I,!0)&&u)return;const m=r.current.openEvent,d=m?.type,x=n.select("domReferenceElement")!==b.currentTarget,A=g&&x||!(g&&c&&(!(m&&f)||d==="click"||d==="mousedown"));if(Nn(l.target)){const N=ye(y,l,l.target);A&&I==="touch"&&p>0?w.start(p,()=>{n.setOpen(!0,N)}):n.setOpen(A,N);return}const P=b.currentTarget;R.request(()=>{const N=ye(y,l,P);A&&I==="touch"&&p>0?w.start(p,()=>{n.setOpen(!0,N)}):n.setOpen(A,N)})},onClick(b){if(o==="mousedown-only")return;const I=a.current;if(o==="mousedown"&&I){a.current=void 0;return}if(zt(I,!0)&&u)return;const l=n.select("open"),g=r.current.openEvent,m=n.select("domReferenceElement")!==b.currentTarget,d=l&&m||!(l&&c&&(!(g&&f)||On(g))),x=ye(y,b.nativeEvent,b.currentTarget);d&&I==="touch"&&p>0?w.start(p,()=>{n.setOpen(!0,x)}):n.setOpen(d,x)},onKeyDown(){a.current=void 0}}),[r,o,u,n,f,c,R,w,p,y]);return i.useMemo(()=>s?{reference:T}:sn,[s,T])}const Nr="Escape";function yt(t,e,n){switch(t){case"vertical":return e;case"horizontal":return n;default:return e||n}}function ft(t,e){return yt(e,t===Dt||t===tt,t===Le||t===De)}function Ct(t,e,n){return yt(e,t===tt,n?t===Le:t===De)||t==="Enter"||t===" "||t===""}function jr(t,e,n){return yt(e,n?t===Le:t===De,t===tt)}function kr(t,e,n,r){const s=n?t===De:t===Le,o=t===Dt;return e==="both"||e==="horizontal"&&r&&r>1?t===Nr:yt(e,s,o)}function Vr(t,e){const n="rootStore"in t?t.rootStore:t,r=n.useState("open"),s=n.useState("floatingElement"),o=n.useState("domReferenceElement"),c=n.context.dataRef,{listRef:u,activeIndex:f,onNavigate:p=()=>{},enabled:y=!0,selectedIndex:a=null,allowEscape:R=!1,loopFocus:w=!1,nested:T=!1,rtl:b=!1,virtual:I=!1,focusItemOnOpen:l="auto",focusItemOnHover:g=!0,openOnArrowKeyDown:m=!0,disabledIndices:d=void 0,orientation:x="vertical",parentOrientation:A,cols:P=1,id:N,resetOnPointerLeave:ee=!0,externalTree:ce}=e,Q=ln(s),z=Ve(Q),ne=jn(),j=kn(ce);Z(()=>{c.current.orientation=x},[c,x]);const se=Vn(o),q=i.useRef(l),E=i.useRef(a??-1),W=i.useRef(null),v=i.useRef(!0),O=pe(M=>{p(E.current===-1?null:E.current,M)}),te=i.useRef(O),C=i.useRef(!!s),Y=i.useRef(r),H=i.useRef(!1),ae=i.useRef(!1),V=Ve(d),$=Ve(r),oe=Ve(a),Ie=Ve(ee),Te=pe(()=>{function M(K){I?j?.events.emit("virtualfocus",K):Wt(K,{sync:H.current,preventScroll:!0})}const D=u.current[E.current],S=ae.current;D&&M(D),(H.current?K=>K():requestAnimationFrame)(()=>{const K=u.current[E.current]||D;if(!K)return;D||M(K),G&&(S||!v.current)&&K.scrollIntoView?.({block:"nearest",inline:"nearest"})})});Z(()=>{y&&(r&&s?(E.current=a??-1,q.current&&a!=null&&(ae.current=!0,O())):C.current&&(E.current=-1,te.current()))},[y,r,s,a,O]),Z(()=>{if(y){if(!r){H.current=!1;return}if(s)if(f==null){if(H.current=!1,oe.current!=null)return;if(C.current&&(E.current=-1,Te()),(!Y.current||!C.current)&&q.current&&(W.current!=null||q.current===!0&&W.current==null)){let M=0;const D=()=>{u.current[0]==null?(M<2&&(M?requestAnimationFrame:queueMicrotask)(D),M+=1):(E.current=W.current==null||Ct(W.current,x,b)||T?Mt(u):Jt(u),W.current=null,O())};D()}}else Je(u,f)||(E.current=f,Te(),ae.current=!1)}},[y,r,s,f,oe,T,u,x,b,O,Te,V]),Z(()=>{if(!y||s||!j||I||!C.current)return;const M=j.nodesRef.current,D=M.find(K=>K.id===ne)?.context?.elements.floating,S=Kt(mt(s)),_=M.some(K=>K.context&&Ue(K.context.elements.floating,S));D&&!_&&v.current&&D.focus({preventScroll:!0})},[y,s,j,ne,I]),Z(()=>{te.current=O,Y.current=r,C.current=!!s}),Z(()=>{r||(W.current=null,q.current=l)},[r,l]);const B=f!=null,G=i.useMemo(()=>{function M(S){if(!$.current)return;const _=u.current.indexOf(S.currentTarget);_!==-1&&E.current!==_&&(E.current=_,O(S))}return{onFocus(S){H.current=!0,M(S)},onClick:({currentTarget:S})=>S.focus({preventScroll:!0}),onMouseMove(S){H.current=!0,ae.current=!1,g&&M(S)},onPointerLeave(S){if(!$.current||!v.current||S.pointerType==="touch")return;H.current=!0;const _=S.relatedTarget;!g||u.current.includes(_)||Ie.current&&(Wt(null,{sync:!0}),E.current=-1,O(S),I||z.current?.focus({preventScroll:!0}))}}},[$,z,g,u,O,Ie,I]),ue=i.useCallback(()=>A??j?.nodesRef.current.find(M=>M.id===ne)?.context?.dataRef?.current.orientation,[ne,j,A]),ie=pe(M=>{if(v.current=!1,H.current=!0,M.which===229||!$.current&&M.currentTarget===z.current)return;if(T&&kr(M.key,x,b,P)){ft(M.key,ue())||Se(M),n.setOpen(!1,ye(wt,M.nativeEvent)),$t(o)&&(I?j?.events.emit("virtualfocus",o):o.focus());return}const D=E.current,S=Mt(u,d),_=Jt(u,d);if(se||(M.key==="Home"&&(Se(M),E.current=S,O(M)),M.key==="End"&&(Se(M),E.current=_,O(M))),P>1){const K=Array.from({length:u.current.length},()=>({width:1,height:1})),L=Er(K,P),ge=L.findIndex(Re=>Re!=null&&!Ze(u,Re,d)),we=L.reduce((Re,re,he)=>re!=null&&!Ze(u,re,d)?he:Re,-1),Ee=L[Cr({current:L.map(Re=>Re!=null?u.current[Re]:null)},{event:M,orientation:x,loopFocus:w,rtl:b,cols:P,disabledIndices:Pr([...(typeof d!="function"?d:null)||u.current.map((Re,re)=>Ze(u,re,d)?re:void 0),void 0],L),minIndex:ge,maxIndex:we,prevIndex:Ar(E.current>_?S:E.current,K,L,P,M.key===tt?"bl":M.key===(b?Le:De)?"tr":"tl"),stopEvent:!0})];if(Ee!=null&&(E.current=Ee,O(M)),x==="both")return}if(ft(M.key,x)){if(Se(M),r&&!I&&Kt(M.currentTarget.ownerDocument)===M.currentTarget){E.current=Ct(M.key,x,b)?S:_,O(M);return}Ct(M.key,x,b)?w?D>=_?R&&D!==u.current.length?E.current=-1:(H.current=!1,E.current=S):E.current=xe(u,{startingIndex:D,disabledIndices:d}):E.current=Math.min(_,xe(u,{startingIndex:D,disabledIndices:d})):w?D<=S?R&&D!==-1?E.current=u.current.length:(H.current=!1,E.current=_):E.current=xe(u,{startingIndex:D,decrement:!0,disabledIndices:d}):E.current=Math.max(S,xe(u,{startingIndex:D,decrement:!0,disabledIndices:d})),Je(u,E.current)&&(E.current=-1),O(M)}}),fe=i.useMemo(()=>I&&r&&B&&{"aria-activedescendant":`${N}-${f}`},[I,r,B,N,f]),be=i.useMemo(()=>({"aria-orientation":x==="both"?void 0:x,...se?{}:fe,onKeyDown(M){if(M.key==="Tab"&&M.shiftKey&&r&&!I){const D=Ln(M.nativeEvent);if(D&&!Ue(z.current,D))return;Se(M),n.setOpen(!1,ye(cn,M.nativeEvent)),$t(o)&&o.focus();return}ie(M)},onPointerMove(){v.current=!0}}),[fe,ie,z,x,se,n,r,I,o]),X=i.useMemo(()=>{function M(S){l==="auto"&&Dn(S.nativeEvent)&&(q.current=!I)}function D(S){q.current=l,l==="auto"&&Fn(S.nativeEvent)&&(q.current=!0)}return{onKeyDown(S){const _=n.select("open");v.current=!1;const K=S.key.startsWith("Arrow"),L=jr(S.key,ue(),b),ge=ft(S.key,x),we=(T?L:ge)||S.key==="Enter"||S.key.trim()==="";if(I&&_)return ie(S);if(!(!_&&!m&&K)){if(we){const Ee=ft(S.key,ue());W.current=T&&Ee?null:S.key}if(T){L&&(Se(S),_?(E.current=Mt(u,V.current),O(S)):n.setOpen(!0,ye(wt,S.nativeEvent,S.currentTarget)));return}ge&&(oe.current!=null&&(E.current=oe.current),Se(S),!_&&m?n.setOpen(!0,ye(wt,S.nativeEvent,S.currentTarget)):ie(S),_&&O(S))}},onFocus(S){n.select("open")&&!I&&(E.current=-1,O(S))},onPointerDown:D,onPointerEnter:D,onMouseDown:M,onClick:M}},[ie,V,l,u,T,O,n,m,x,ue,b,oe,I]),de=i.useMemo(()=>({...fe,...X}),[fe,X]);return i.useMemo(()=>y?{reference:de,floating:be,item:G,trigger:X}:{},[y,de,be,X,G])}function Lr(t,e){const n="rootStore"in t?t.rootStore:t,r=n.context.dataRef,s=n.useState("open"),{listRef:o,activeIndex:c,onMatch:u,onTypingChange:f,enabled:p=!0,resetMs:y=750,selectedIndex:a=null}=e,R=ke(),w=i.useRef(""),T=i.useRef(a??c??-1),b=i.useRef(null);Z(()=>{!s&&a!==null||(R.clear(),b.current=null,w.current!==""&&(w.current=""))},[s,a,R]),Z(()=>{s&&w.current===""&&(T.current=a??c??-1)},[s,a,c]);const I=pe(x=>{x?r.current.typing||(r.current.typing=x,f?.(x)):r.current.typing&&(r.current.typing=x,f?.(x))}),l=pe(x=>{function A(z,ne,j){const se=ne.find(q=>q?.toLocaleLowerCase().indexOf(j.toLocaleLowerCase())===0);return se?z.indexOf(se):-1}const P=o.current;if(w.current.length>0&&w.current[0]!==" "&&(A(P,P,w.current)===-1?I(!1):x.key===" "&&Se(x)),P==null||x.key.length!==1||x.ctrlKey||x.metaKey||x.altKey)return;s&&x.key!==" "&&(Se(x),I(!0));const N=w.current==="";N&&(T.current=a??c??-1),P.every(z=>z?z[0]?.toLocaleLowerCase()!==z[1]?.toLocaleLowerCase():!0)&&w.current===x.key&&(w.current="",T.current=b.current),w.current+=x.key,R.start(y,()=>{w.current="",T.current=b.current,I(!1)});const ce=N?a??c??-1:T.current,Q=A(P,[...P.slice((ce||0)+1),...P.slice(0,(ce||0)+1)],w.current);Q!==-1?(u?.(Q),b.current=Q):x.key!==" "&&(w.current="",I(!1))}),g=pe(x=>{const A=x.relatedTarget,P=n.select("domReferenceElement"),N=n.select("floatingElement"),ee=Ue(P,A),ce=Ue(N,A);ee||ce||(R.clear(),w.current="",T.current=b.current,I(!1))}),m=i.useMemo(()=>({onKeyDown:l,onBlur:g}),[l,g]),d=i.useMemo(()=>({onKeyDown:l,onKeyUp(x){x.key===" "&&I(!1)},onBlur:g}),[l,g,I]);return i.useMemo(()=>p?{reference:m,floating:d}:{},[p,m,d])}const yn=i.createContext(null),bn=i.createContext(null);function je(){const t=i.useContext(yn);if(t===null)throw new Error(ht(60));return t}function Rn(){const t=i.useContext(bn);if(t===null)throw new Error(ht(61));return t}const Dr=(t,e)=>Object.is(t,e);function $e(t,e,n){return t==null||e==null?Object.is(t,e):n(t,e)}function Fr(t,e,n){return!t||t.length===0?!1:t.some(r=>r===void 0?!1:$e(e,r,n))}function et(t,e,n){return!t||t.length===0?-1:t.findIndex(r=>r===void 0?!1:$e(r,e,n))}function Hr(t,e,n){return t.filter(r=>!$e(e,r,n))}function Vt(t){if(t==null)return"";if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return String(t)}}function Sn(t){return t!=null&&t.length>0&&typeof t[0]=="object"&&t[0]!=null&&"items"in t[0]}function Ur(t){if(!Array.isArray(t))return t!=null&&!("null"in t);if(Sn(t)){for(const e of t)for(const n of e.items)if(n&&n.value==null&&n.label!=null)return!0;return!1}for(const e of t)if(e&&e.value==null&&e.label!=null)return!0;return!1}function _r(t,e){if(e&&t!=null)return e(t)??"";if(t&&typeof t=="object"){if("label"in t&&t.label!=null)return String(t.label);if("value"in t)return String(t.value)}return Vt(t)}function Ke(t,e){return e&&t!=null?e(t)??"":t&&typeof t=="object"&&"value"in t&&"label"in t?Vt(t.value):Vt(t)}function wn(t,e,n){function r(){return _r(t,n)}if(n&&t!=null)return n(t);if(t&&typeof t=="object"&&"label"in t&&t.label!=null)return t.label;if(e&&!Array.isArray(e))return e[t]??r();if(Array.isArray(e)){const s=Sn(e)?e.flatMap(o=>o.items):e;if(t==null||typeof t!="object"){const o=s.find(c=>c.value===t);return o&&o.label!=null?o.label:r()}if("value"in t){const o=s.find(c=>c&&c.value===t.value);if(o&&o.label!=null)return o.label}}return r()}function Br(t,e,n){return t.reduce((r,s,o)=>(o>0&&r.push(", "),r.push(h.jsx(i.Fragment,{children:wn(s,e,n)},o)),r),[])}const k={id:J(t=>t.id),modal:J(t=>t.modal),multiple:J(t=>t.multiple),items:J(t=>t.items),itemToStringLabel:J(t=>t.itemToStringLabel),itemToStringValue:J(t=>t.itemToStringValue),isItemEqualToValue:J(t=>t.isItemEqualToValue),value:J(t=>t.value),hasSelectedValue:J(t=>{const{value:e,multiple:n,itemToStringValue:r}=t;return e==null?!1:n&&Array.isArray(e)?e.length>0:Ke(e,r)!==""}),hasNullItemLabel:J((t,e)=>e?Ur(t.items):!1),open:J(t=>t.open),mounted:J(t=>t.mounted),forceMount:J(t=>t.forceMount),transitionStatus:J(t=>t.transitionStatus),openMethod:J(t=>t.openMethod),activeIndex:J(t=>t.activeIndex),selectedIndex:J(t=>t.selectedIndex),isActive:J((t,e)=>t.activeIndex===e),isSelected:J((t,e,n)=>{const r=t.isItemEqualToValue,s=t.value;return t.multiple?Array.isArray(s)&&s.some(o=>$e(n,o,r)):t.selectedIndex===e&&t.selectedIndex!==null?!0:$e(n,s,r)}),isSelectedByFocus:J((t,e)=>t.selectedIndex===e),popupProps:J(t=>t.popupProps),triggerProps:J(t=>t.triggerProps),triggerElement:J(t=>t.triggerElement),positionerElement:J(t=>t.positionerElement),listElement:J(t=>t.listElement),scrollUpArrowVisible:J(t=>t.scrollUpArrowVisible),scrollDownArrowVisible:J(t=>t.scrollDownArrowVisible),hasScrollArrows:J(t=>t.hasScrollArrows)};function zr(t,e){const n=i.useRef(t),r=pe(e);Z(()=>{n.current!==t&&r(n.current)},[t,r]),Z(()=>{n.current=t},[t])}function Wr(t){const{id:e,value:n,defaultValue:r=null,onValueChange:s,open:o,defaultOpen:c=!1,onOpenChange:u,name:f,autoComplete:p,disabled:y=!1,readOnly:a=!1,required:R=!1,modal:w=!0,actionsRef:T,inputRef:b,onOpenChangeComplete:I,items:l,multiple:g=!1,itemToStringLabel:m,itemToStringValue:d,isItemEqualToValue:x=Dr,highlightItemOnHover:A=!0,children:P}=t,{clearErrors:N}=dr(),{setDirty:ee,setTouched:ce,setFocused:Q,shouldValidateOnChange:z,validityData:ne,setFilled:j,name:se,disabled:q,validation:E,validationMode:W}=gn(),v=hn({id:e}),O=q||y,te=se??f,[C,Y]=Xt({controlled:n,default:g?r??qt:r,name:"Select",state:"value"}),[H,ae]=Xt({controlled:o,default:c,name:"Select",state:"open"}),V=i.useRef([]),$=i.useRef([]),oe=i.useRef(null),Ie=i.useRef(null),Te=i.useRef(0),B=i.useRef(null),G=i.useRef([]),ue=i.useRef(!1),ie=i.useRef(!1),fe=i.useRef(null),be=i.useRef({allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}),X=i.useRef(!1),{mounted:de,setMounted:M,transitionStatus:D}=Ft(H),{openMethod:S,triggerProps:_,reset:K}=Hn(H),L=kt(()=>new Un({id:v,modal:w,multiple:g,itemToStringLabel:m,itemToStringValue:d,isItemEqualToValue:x,value:C,open:H,mounted:de,transitionStatus:D,items:l,forceMount:!1,openMethod:null,activeIndex:null,selectedIndex:null,popupProps:{},triggerProps:{},triggerElement:null,positionerElement:null,listElement:null,scrollUpArrowVisible:!1,scrollDownArrowVisible:!1,hasScrollArrows:!1})).current,ge=F(L,k.activeIndex),we=F(L,k.selectedIndex),Ee=F(L,k.triggerElement),Re=F(L,k.positionerElement),re=i.useMemo(()=>g&&Array.isArray(C)&&C.length===0?"":Ke(C,d),[g,C,d]),he=i.useMemo(()=>g&&Array.isArray(C)?C.map(U=>Ke(U,d)):Ke(C,d),[g,C,d]),me=Ve(L.state.triggerElement);pr({id:v,commit:E.commit,value:C,controlRef:me,name:te,getValue:()=>he});const _e=i.useRef(C);Z(()=>{C!==_e.current&&L.set("forceMount",!0)},[L,C]),Z(()=>{j(g?Array.isArray(C)&&C.length>0:C!=null)},[g,C,j]),Z(function(){if(H)return;const le=G.current;if(g){const Ce=Array.isArray(C)?C:[];if(Ce.length===0){L.set("selectedIndex",null);return}const ve=Ce[Ce.length-1],it=et(le,ve,x);L.set("selectedIndex",it===-1?null:it);return}const Me=et(le,C,x);L.set("selectedIndex",Me===-1?null:Me)},[g,H,C,G,x,L]),zr(C,()=>{N(te),ee(C!==ne.initialValue),z()?E.commit(C):E.commit(C,!0)});const Ge=pe((U,le)=>{if(u?.(U,le),!le.isCanceled&&(ae(U),!U&&(le.reason===cn||le.reason===_n)&&(ce(!0),Q(!1),W==="onBlur"&&E.commit(C)),!U&&L.state.activeIndex!==null)){const Me=V.current[L.state.activeIndex];queueMicrotask(()=>{Me?.setAttribute("tabindex","-1")})}}),Be=pe(()=>{M(!1),L.set("activeIndex",null),K(),I?.(!1)});xt({enabled:!T,open:H,ref:oe,onComplete(){H||Be()}}),i.useImperativeHandle(T,()=>({unmount:Be}),[Be]);const Fe=pe((U,le)=>{s?.(U,le),!le.isCanceled&&Y(U)}),Ae=pe(()=>{const U=L.state.listElement||oe.current;if(!U)return;const le=U.scrollTop,Me=U.scrollTop+U.clientHeight,Ce=le>1,ve=Me<U.scrollHeight-1;L.state.scrollUpArrowVisible!==Ce&&L.set("scrollUpArrowVisible",Ce),L.state.scrollDownArrowVisible!==ve&&L.set("scrollDownArrowVisible",ve)}),Pe=Bn({open:H,onOpenChange:Ge,elements:{reference:Ee,floating:Re}}),nt=Or(Pe,{enabled:!a&&!O,event:"mousedown"}),Xe=zn(Pe,{bubbles:!1}),Oe=Vr(Pe,{enabled:!a&&!O,listRef:V,activeIndex:ge,selectedIndex:we,disabledIndices:qt,onNavigate(U){U===null&&!H||L.set("activeIndex",U)},focusItemOnHover:!1}),bt=Lr(Pe,{enabled:!a&&!O&&(H||!g),listRef:$,activeIndex:ge,selectedIndex:we,onMatch(U){H?L.set("activeIndex",U):Fe(G.current[U],ye("none"))},onTypingChange(U){ue.current=U}}),{getReferenceProps:ze,getFloatingProps:We,getItemProps:rt}=Wn([nt,Xe,Oe,bt]),Qe=i.useMemo(()=>an(ze(),_,v?{id:v}:sn),[ze,_,v]);Kn(()=>{L.update({popupProps:We(),triggerProps:Qe})}),Z(()=>{L.update({id:v,modal:w,multiple:g,value:C,open:H,mounted:de,transitionStatus:D,popupProps:We(),triggerProps:Qe,items:l,itemToStringLabel:m,itemToStringValue:d,isItemEqualToValue:x,openMethod:S})},[L,v,w,g,C,H,de,D,We,Qe,l,m,d,x,S]);const ot=i.useMemo(()=>({store:L,name:te,required:R,disabled:O,readOnly:a,multiple:g,itemToStringLabel:m,itemToStringValue:d,highlightItemOnHover:A,setValue:Fe,setOpen:Ge,listRef:V,popupRef:oe,scrollHandlerRef:Ie,handleScrollArrowVisibility:Ae,scrollArrowsMountedCountRef:Te,getItemProps:rt,events:Pe.context.events,valueRef:B,valuesRef:G,labelsRef:$,typingRef:ue,selectionRef:be,selectedItemTextRef:fe,validation:E,onOpenChangeComplete:I,keyboardActiveRef:ie,alignItemWithTriggerActiveRef:X,initialValueRef:_e}),[L,te,R,O,a,g,m,d,A,Fe,Ge,rt,Pe.context.events,E,I,Ae]),st=un(b,E.inputRef),Rt=g&&Array.isArray(C)&&C.length>0,St=i.useMemo(()=>!g||!Array.isArray(C)||!te?null:C.map(U=>{const le=Ke(U,d);return h.jsx("input",{type:"hidden",name:te,value:le},le)}),[g,C,te,d]);return h.jsx(yn.Provider,{value:ot,children:h.jsxs(bn.Provider,{value:Pe,children:[P,h.jsx("input",{...E.getInputValidationProps({onFocus(){L.state.triggerElement?.focus({focusVisible:!0})},onChange(U){if(U.nativeEvent.defaultPrevented)return;const le=U.target.value,Me=ye(Ht,U.nativeEvent);function Ce(){if(g)return;const ve=G.current.find(it=>Ke(it,d).toLowerCase()===le.toLowerCase());ve!=null&&(ee(ve!==ne.initialValue),Fe(ve,Me),z()&&E.commit(ve))}L.set("forceMount",!0),queueMicrotask(Ce)}}),name:g?void 0:te,autoComplete:p,value:re,disabled:O,required:R&&!Rt,readOnly:a,ref:st,style:te?$n:qn,tabIndex:-1,"aria-hidden":!0}),St]})})}function Kr(t){const e=t.getBoundingClientRect(),n=window.getComputedStyle(t,"::before"),r=window.getComputedStyle(t,"::after");if(!(n.content!=="none"||r.content!=="none"))return e;const o=parseFloat(n.width)||0,c=parseFloat(n.height)||0,u=parseFloat(r.width)||0,f=parseFloat(r.height)||0,p=Math.max(e.width,o,u),y=Math.max(e.height,c,f),a=p-e.width,R=y-e.height;return{left:e.left-a/2,right:e.right+a/2,top:e.top-R/2,bottom:e.bottom+R/2}}const dt=2,$r=400,Zt=200,qr={...Gn,...gr,value:()=>null},Yr=i.forwardRef(function(e,n){const{render:r,className:s,id:o,disabled:c=!1,nativeButton:u=!0,...f}=e,{setTouched:p,setFocused:y,validationMode:a,state:R,disabled:w}=gn(),{labelId:T}=mr(),{store:b,setOpen:I,selectionRef:l,validation:g,readOnly:m,required:d,alignItemWithTriggerActiveRef:x,disabled:A,keyboardActiveRef:P}=je(),N=w||A||c,ee=F(b,k.open),ce=F(b,k.value),Q=F(b,k.triggerProps),z=F(b,k.positionerElement),ne=F(b,k.listElement),j=F(b,k.id),se=F(b,k.hasSelectedValue),q=!se&&ee,E=F(b,k.hasNullItemLabel,q),W=o??j;hn({id:W});const v=Ve(z),O=i.useRef(null),{getButtonProps:te,buttonRef:C}=fn({disabled:N,native:u}),Y=pe(G=>{b.set("triggerElement",G)}),H=un(n,O,C,Y),ae=ke(),V=ke(),$=ke(),oe=ke();i.useEffect(()=>{if(ee)return!(se||E)?$.start($r,()=>{l.current.allowUnselectedMouseUp=!0,l.current.allowSelectedMouseUp=!0}):oe.start(Zt,()=>{l.current.allowUnselectedMouseUp=!0,$.start(Zt,()=>{l.current.allowSelectedMouseUp=!0})}),()=>{$.clear(),oe.clear()};l.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1},V.clear()},[ee,se,E,l,V,$,oe]);const Ie=i.useMemo(()=>ne?.id??ln(z)?.id,[ne,z]),Te=an(Q,{id:W,role:"combobox","aria-expanded":ee?"true":"false","aria-haspopup":"listbox","aria-controls":ee?Ie:void 0,"aria-labelledby":T,"aria-readonly":m||void 0,"aria-required":d||void 0,tabIndex:N?-1:0,ref:H,onFocus(G){y(!0),ee&&x.current&&I(!1,ye(Ht,G.nativeEvent)),ae.start(0,()=>{b.set("forceMount",!0)})},onBlur(G){Ue(z,G.relatedTarget)||(p(!0),y(!1),a==="onBlur"&&g.commit(ce))},onPointerMove(){P.current=!1},onKeyDown(){P.current=!0},onMouseDown(G){if(ee)return;const ue=mt(G.currentTarget);function ie(fe){if(!O.current)return;const be=fe.target;if(Ue(O.current,be)||Ue(v.current,be)||be===O.current)return;const X=Kr(O.current);fe.clientX>=X.left-dt&&fe.clientX<=X.right+dt&&fe.clientY>=X.top-dt&&fe.clientY<=X.bottom+dt||I(!1,ye(Yn,fe))}V.start(0,()=>{ue.addEventListener("mouseup",ie,{once:!0})})}},g.getValidationProps,f,te);Te.role="combobox";const B={...R,open:ee,disabled:N,value:ce,readOnly:m,placeholder:!se};return Ne("button",e,{ref:[n,O],state:B,stateAttributesMapping:qr,props:Te})}),Gr={value:()=>null},Xr=i.forwardRef(function(e,n){const{className:r,render:s,children:o,placeholder:c,...u}=e,{store:f,valueRef:p}=je(),y=F(f,k.value),a=F(f,k.items),R=F(f,k.itemToStringLabel),w=F(f,k.hasSelectedValue),T=!w&&c!=null&&o==null,b=F(f,k.hasNullItemLabel,T),I={value:y,placeholder:!w};let l=null;return typeof o=="function"?l=o(y):o!=null?l=o:!w&&c!=null&&!b?l=c:Array.isArray(y)?l=Br(y,a,R):l=wn(y,a,R),Ne("span",e,{state:I,ref:[n,p],props:[{children:l},u],stateAttributesMapping:Gr})}),Qr=i.forwardRef(function(e,n){const{className:r,render:s,...o}=e,{store:c}=je(),f={open:F(c,k.open)};return Ne("span",e,{state:f,ref:n,props:[{"aria-hidden":!0,children:"▼"},o],stateAttributesMapping:Xn})}),Jr=i.createContext(void 0),Zr=i.forwardRef(function(e,n){const{store:r}=je(),s=F(r,k.mounted),o=F(r,k.forceMount);return s||o?h.jsx(Jr.Provider,{value:!0,children:h.jsx(Qn,{ref:n,...e})}):null}),In=i.createContext({register:()=>{},unregister:()=>{},subscribeMapChange:()=>()=>{},elementsRef:{current:[]},nextIndexRef:{current:0}});function eo(){return i.useContext(In)}function to(t){const{children:e,elementsRef:n,labelsRef:r,onMapChange:s}=t,o=pe(s),c=i.useRef(0),u=kt(ro).current,f=kt(no).current,[p,y]=i.useState(0),a=i.useRef(p),R=pe((l,g)=>{f.set(l,g??null),a.current+=1,y(a.current)}),w=pe(l=>{f.delete(l),a.current+=1,y(a.current)}),T=i.useMemo(()=>{const l=new Map;return Array.from(f.keys()).filter(m=>m.isConnected).sort(oo).forEach((m,d)=>{const x=f.get(m)??{};l.set(m,{...x,index:d})}),l},[f,p]);Z(()=>{if(typeof MutationObserver!="function"||T.size===0)return;const l=new MutationObserver(g=>{const m=new Set,d=x=>m.has(x)?m.delete(x):m.add(x);g.forEach(x=>{x.removedNodes.forEach(d),x.addedNodes.forEach(d)}),m.size===0&&(a.current+=1,y(a.current))});return T.forEach((g,m)=>{m.parentElement&&l.observe(m.parentElement,{childList:!0})}),()=>{l.disconnect()}},[T]),Z(()=>{a.current===p&&(n.current.length!==T.size&&(n.current.length=T.size),r&&r.current.length!==T.size&&(r.current.length=T.size),c.current=T.size),o(T)},[o,T,n,r,p]),Z(()=>()=>{n.current=[]},[n]),Z(()=>()=>{r&&(r.current=[])},[r]);const b=pe(l=>(u.add(l),()=>{u.delete(l)}));Z(()=>{u.forEach(l=>l(T))},[u,T]);const I=i.useMemo(()=>({register:R,unregister:w,subscribeMapChange:b,elementsRef:n,labelsRef:r,nextIndexRef:c}),[R,w,b,n,r,c]);return h.jsx(In.Provider,{value:I,children:e})}function no(){return new Map}function ro(){return new Set}function oo(t,e){const n=t.compareDocumentPosition(e);return n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS?1:0}const vn=i.createContext(void 0);function Ut(){const t=i.useContext(vn);if(!t)throw new Error(ht(59));return t}function gt(t,e){t&&Object.assign(t.style,e)}const Tn={position:"relative",maxHeight:"100%",overflowX:"hidden",overflowY:"auto"},so={position:"fixed"},io=i.forwardRef(function(e,n){const{anchor:r,positionMethod:s="absolute",className:o,render:c,side:u="bottom",align:f="center",sideOffset:p=0,alignOffset:y=0,collisionBoundary:a="clipping-ancestors",collisionPadding:R,arrowPadding:w=5,sticky:T=!1,disableAnchorTracking:b,alignItemWithTrigger:I=!0,collisionAvoidance:l=Jn,...g}=e,{store:m,listRef:d,labelsRef:x,alignItemWithTriggerActiveRef:A,selectedItemTextRef:P,valuesRef:N,initialValueRef:ee,popupRef:ce,setValue:Q}=je(),z=Rn(),ne=F(m,k.open),j=F(m,k.mounted),se=F(m,k.modal),q=F(m,k.value),E=F(m,k.openMethod),W=F(m,k.positionerElement),v=F(m,k.triggerElement),O=F(m,k.isItemEqualToValue),te=F(m,k.transitionStatus),C=i.useRef(null),Y=i.useRef(null),[H,ae]=i.useState(I),V=j&&H&&E!=="touch";!j&&H!==I&&ae(I),Z(()=>{j||(k.scrollUpArrowVisible(m.state)&&m.set("scrollUpArrowVisible",!1),k.scrollDownArrowVisible(m.state)&&m.set("scrollDownArrowVisible",!1))},[m,j]),i.useImperativeHandle(A,()=>V),Zn((V||se)&&ne&&E!=="touch",v);const $=er({anchor:r,floatingRootContext:z,positionMethod:s,mounted:j,side:u,sideOffset:p,align:f,alignOffset:y,arrowPadding:w,collisionBoundary:a,collisionPadding:R,sticky:T,disableAnchorTracking:b??V,collisionAvoidance:l,keepMounted:!0}),oe=V?"none":$.side,Ie=V?so:$.positionerStyles,Te=i.useMemo(()=>{const X={};return ne||(X.pointerEvents="none"),{role:"presentation",hidden:!j,style:{...Ie,...X}}},[ne,j,Ie]),B={open:ne,side:oe,align:$.align,anchorHidden:$.anchorHidden},G=pe(X=>{m.set("positionerElement",X)}),ue=Ne("div",e,{ref:[n,G],state:B,stateAttributesMapping:pn,props:[Te,dn(te),g]}),ie=i.useRef(0),fe=pe(X=>{if(X.size===0&&ie.current===0||N.current.length===0)return;const de=ie.current;if(ie.current=X.size,X.size===de)return;const M=ye(Ht);if(de!==0&&!m.state.multiple&&q!==null&&et(N.current,q,O)===-1){const S=ee.current,K=S!=null&&et(N.current,S,O)!==-1?S:null;Q(K,M),K===null&&(m.set("selectedIndex",null),P.current=null)}if(de!==0&&m.state.multiple&&Array.isArray(q)){const D=_=>et(N.current,_,O)!==-1,S=q.filter(_=>D(_));(S.length!==q.length||S.some(_=>!Fr(q,_,O)))&&(Q(S,M),S.length===0&&(m.set("selectedIndex",null),P.current=null))}if(ne&&V){m.update({scrollUpArrowVisible:!1,scrollDownArrowVisible:!1});const D={height:""};gt(W,D),gt(ce.current,D)}}),be=i.useMemo(()=>({...$,side:oe,alignItemWithTriggerActive:V,setControlledAlignItemWithTrigger:ae,scrollUpArrowRef:C,scrollDownArrowRef:Y}),[$,oe,V,ae]);return h.jsx(to,{elementsRef:d,labelsRef:x,onMapChange:fe,children:h.jsxs(vn.Provider,{value:be,children:[j&&se&&h.jsx(tr,{inert:nr(!ne),cutout:v}),ue]})})});function Mn(t){const e=t.currentTarget.getBoundingClientRect();return e.top+1<=t.clientY&&t.clientY<=e.bottom-1&&e.left+1<=t.clientX&&t.clientX<=e.right-1}const pt="base-ui-disable-scrollbar",Lt={className:pt,getElement(t){return h.jsx("style",{nonce:t,href:pt,precedence:"base-ui:low",children:`.${pt}{scrollbar-width:none}.${pt}::-webkit-scrollbar{display:none}`})}},lo=i.createContext(void 0);function co(t){return i.useContext(lo)}function Et(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const ao=i.createContext(void 0),uo={disableStyleElements:!1};function fo(){return i.useContext(ao)??uo}const He=1,po={...pn,...mn},mo=i.forwardRef(function(e,n){const{render:r,className:s,finalFocus:o,...c}=e,{store:u,popupRef:f,onOpenChangeComplete:p,setOpen:y,valueRef:a,selectedItemTextRef:R,keyboardActiveRef:w,multiple:T,handleScrollArrowVisibility:b,scrollHandlerRef:I,highlightItemOnHover:l}=je(),{side:g,align:m,alignItemWithTriggerActive:d,setControlledAlignItemWithTrigger:x,scrollDownArrowRef:A,scrollUpArrowRef:P}=Ut(),N=co()!=null,ee=Rn(),{nonce:ce,disableStyleElements:Q}=fo(),z=ke(),ne=F(u,k.id),j=F(u,k.open),se=F(u,k.mounted),q=F(u,k.popupProps),E=F(u,k.transitionStatus),W=F(u,k.triggerElement),v=F(u,k.positionerElement),O=F(u,k.listElement),te=i.useRef(0),C=i.useRef(!1),Y=i.useRef(0),H=i.useRef(!1),ae=i.useRef({}),V=on(),$=pe(B=>{if(!v||!f.current||!H.current)return;if(C.current||!d){b();return}const G=v.style.top==="0px",ue=v.style.bottom==="0px",ie=v.getBoundingClientRect().height,fe=mt(v),be=getComputedStyle(v),X=parseFloat(be.marginTop),de=parseFloat(be.marginBottom),M=en(getComputedStyle(f.current)),D=Math.min(fe.documentElement.clientHeight-X-de,M),S=B.scrollTop,_=tn(B);let K=0,L=null,ge=!1,we=!1;const Ee=re=>{v.style.height=`${re}px`},Re=(re,he)=>{const me=Et(re,0,D-ie);me>0&&Ee(ie+me),B.scrollTop=he,D-(ie+me)<=He&&(C.current=!0),b()};if(G){const re=_-S,he=ie+re,me=Math.min(he,D);if(K=me,re<=He){Re(re,_);return}D-me>He?we=!0:ge=!0}else if(ue){const re=S,he=ie+re,me=Math.min(he,D),_e=he-D;if(K=me,re<=He){Re(re,0);return}D-me>He?L=0:(ge=!0,S<_&&(L=S-(re-_e)))}if(K=Math.ceil(K),K!==0&&Ee(K),we||L!=null){const re=tn(B),he=we?re:Et(L,0,re);Math.abs(B.scrollTop-he)>He&&(B.scrollTop=he)}(ge||K>=D-He)&&(C.current=!0),b()});i.useImperativeHandle(I,()=>$,[$]),xt({open:j,ref:f,onComplete(){j&&p?.(!0)}});const oe={open:j,transitionStatus:E,side:g,align:m};Z(()=>{!v||!f.current||Object.keys(ae.current).length||(ae.current={top:v.style.top||"0",left:v.style.left||"0",right:v.style.right,height:v.style.height,bottom:v.style.bottom,minHeight:v.style.minHeight,maxHeight:v.style.maxHeight,marginTop:v.style.marginTop,marginBottom:v.style.marginBottom})},[f,v]),Z(()=>{j||d||(H.current=!1,C.current=!1,te.current=0,Y.current=0,gt(v,ae.current))},[j,d,v,f]),Z(()=>{const B=f.current;if(!(!j||!W||!v||!B||u.state.transitionStatus==="ending")){if(!d){H.current=!0,V.request(b),B.style.removeProperty("--transform-origin");return}queueMicrotask(()=>{const G=go(B);B.style.removeProperty("--transform-origin");try{const ue=getComputedStyle(v),ie=getComputedStyle(B),fe=mt(W),be=Yt(v),X=W.getBoundingClientRect(),de=v.getBoundingClientRect(),M=X.left,D=X.height,S=O||B,_=S.scrollHeight,K=parseFloat(ie.borderBottomWidth),L=parseFloat(ue.marginTop)||10,ge=parseFloat(ue.marginBottom)||10,we=parseFloat(ue.minHeight)||100,Ee=en(ie),Re=5,re=5,he=20,me=fe.documentElement.clientHeight-L-ge,_e=fe.documentElement.clientWidth,Ge=me-X.bottom+D,Be=R.current,Fe=a.current;let Ae,Pe=0,nt=0;if(Be&&Fe){const U=Fe.getBoundingClientRect();Ae=Be.getBoundingClientRect();const le=U.left-M,Me=Ae.left-de.left,Ce=U.top-X.top+U.height/2,ve=Ae.top-de.top+Ae.height/2;Pe=le-Me,nt=ve-Ce}const Xe=Ge+nt+ge+K;let Oe=Math.min(me,Xe);const bt=me-L-ge,ze=Xe-Oe,We=Math.max(Re,M+Pe),rt=_e-re,Qe=Math.max(0,We+de.width-rt);v.style.left=`${We-Qe}px`,v.style.height=`${Oe}px`,v.style.maxHeight="auto",v.style.marginTop=`${L}px`,v.style.marginBottom=`${ge}px`,B.style.height="100%";const ot=S.scrollHeight-S.clientHeight,st=ze>=ot;st&&(Oe=Math.min(me,de.height)-(ze-ot));const Rt=X.top<he||X.bottom>me-he||Oe<Math.min(_,we),St=(be.visualViewport?.scale??1)!==1&&rr;if(Rt||St){H.current=!0,gt(v,ae.current),or.flushSync(()=>x(!1));return}if(st){const U=Math.max(0,me-Xe);v.style.top=de.height>=bt?"0":`${U}px`,v.style.height=`${Oe}px`,S.scrollTop=S.scrollHeight-S.clientHeight,te.current=Math.max(we,Oe)}else v.style.bottom="0",te.current=Math.max(we,Oe),S.scrollTop=ze;if(Ae){const U=de.top,le=de.height,Me=Ae.top+Ae.height/2,Ce=le>0?(Me-U)/le*100:50,ve=Et(Ce,0,100);B.style.setProperty("--transform-origin",`50% ${ve}%`)}(te.current===me||Oe>=Ee)&&(C.current=!0),b(),setTimeout(()=>{H.current=!0})}finally{G()}})}},[u,j,v,W,a,R,f,b,d,x,V,A,P,O]),i.useEffect(()=>{if(!d||!v||!j)return;const B=Yt(v);function G(ue){y(!1,ye(ir,ue))}return B.addEventListener("resize",G),()=>{B.removeEventListener("resize",G)}},[y,d,v,j]);const Ie={...O?{role:"presentation","aria-orientation":void 0}:{role:"listbox","aria-multiselectable":T||void 0,id:`${ne}-list`},onKeyDown(B){w.current=!0,N&&lr.has(B.key)&&B.stopPropagation()},onMouseMove(){w.current=!1},onPointerLeave(B){if(!l||Mn(B)||B.pointerType==="touch")return;const G=B.currentTarget;z.start(0,()=>{u.set("activeIndex",null),G.focus({preventScroll:!0})})},onScroll(B){O||$(B.currentTarget)},...d&&{style:O?{height:"100%"}:Tn}},Te=Ne("div",e,{ref:[n,f],state:oe,stateAttributesMapping:po,props:[q,Ie,dn(E),{className:!O&&d?Lt.className:void 0},c]});return h.jsxs(i.Fragment,{children:[!Q&&Lt.getElement(ce),h.jsx(sr,{context:ee,modal:!1,disabled:!se,returnFocus:o,restoreFocus:!0,children:Te})]})});function en(t){const e=t.maxHeight||"";return e.endsWith("px")&&parseFloat(e)||1/0}function tn(t){return Math.max(0,t.scrollHeight-t.clientHeight)}const nn=[["transform","none"],["scale","1"],["translate","0 0"]];function go(t){const{style:e}=t,n={};for(const[r,s]of nn)n[r]=e.getPropertyValue(r),e.setProperty(r,s,"important");return()=>{for(const[r]of nn){const s=n[r];s?e.setProperty(r,s):e.removeProperty(r)}}}const ho=i.forwardRef(function(e,n){const{className:r,render:s,...o}=e,{store:c,scrollHandlerRef:u}=je(),{alignItemWithTriggerActive:f}=Ut(),p=F(c,k.hasScrollArrows),y=F(c,k.openMethod),a=F(c,k.multiple),w={id:`${F(c,k.id)}-list`,role:"listbox","aria-multiselectable":a||void 0,onScroll(b){u.current?.(b.currentTarget)},...f&&{style:Tn},className:p&&y!=="touch"?Lt.className:void 0},T=pe(b=>{c.set("listElement",b)});return Ne("div",e,{ref:[n,T],props:[w,o]})});let Cn=(function(t){return t[t.None=0]="None",t[t.GuessFromOrder=1]="GuessFromOrder",t})({});function xo(t={}){const{label:e,metadata:n,textRef:r,indexGuessBehavior:s,index:o}=t,{register:c,unregister:u,subscribeMapChange:f,elementsRef:p,labelsRef:y,nextIndexRef:a}=eo(),R=i.useRef(-1),[w,T]=i.useState(o??(s===Cn.GuessFromOrder?()=>{if(R.current===-1){const l=a.current;a.current+=1,R.current=l}return R.current}:-1)),b=i.useRef(null),I=i.useCallback(l=>{if(b.current=l,w!==-1&&l!==null&&(p.current[w]=l,y)){const g=e!==void 0;y.current[w]=g?e:r?.current?.textContent??l.textContent}},[w,p,y,e,r]);return Z(()=>{if(o!=null)return;const l=b.current;if(l)return c(l,n),()=>{u(l)}},[o,c,u,n]),Z(()=>{if(o==null)return f(l=>{const g=b.current?l.get(b.current)?.index:null;g!=null&&T(g)})},[o,f,T]),i.useMemo(()=>({ref:I,index:w}),[w,I])}const En=i.createContext(void 0);function _t(){const t=i.useContext(En);if(!t)throw new Error(ht(57));return t}const yo=i.memo(i.forwardRef(function(e,n){const{render:r,className:s,value:o=null,label:c,disabled:u=!1,nativeButton:f=!1,...p}=e,y=i.useRef(null),a=xo({label:c,textRef:y,indexGuessBehavior:Cn.GuessFromOrder}),{store:R,getItemProps:w,setOpen:T,setValue:b,selectionRef:I,typingRef:l,valuesRef:g,keyboardActiveRef:m,multiple:d,highlightItemOnHover:x}=je(),A=ke(),P=F(R,k.isActive,a.index),N=F(R,k.isSelected,a.index,o),ee=F(R,k.isSelectedByFocus,a.index),ce=F(R,k.isItemEqualToValue),Q=a.index,z=Q!==-1,ne=i.useRef(null),j=Ve(Q);Z(()=>{if(!z)return;const V=g.current;return V[Q]=o,()=>{delete V[Q]}},[z,Q,o,g]),Z(()=>{if(!z)return;const V=R.state.value;let $=V;d&&Array.isArray(V)&&V.length>0&&($=V[V.length-1]),$!==void 0&&$e(o,$,ce)&&R.set("selectedIndex",Q)},[z,Q,d,ce,R,o]);const se={disabled:u,selected:N,highlighted:P},q=w({active:P,selected:N});q.onFocus=void 0,q.id=void 0;const E=i.useRef(null),W=i.useRef("mouse"),v=i.useRef(!1),{getButtonProps:O,buttonRef:te}=fn({disabled:u,focusableWhenDisabled:!0,native:f});function C(V){const $=R.state.value;if(d){const oe=Array.isArray($)?$:[],Ie=N?Hr(oe,o,ce):[...oe,o];b(Ie,ye(It,V))}else b(o,ye(It,V)),T(!1,ye(It,V))}const Y={role:"option","aria-selected":N,tabIndex:P?0:-1,onFocus(){R.set("activeIndex",Q)},onMouseEnter(){!m.current&&R.state.selectedIndex===null&&x&&R.set("activeIndex",Q)},onMouseMove(){x&&R.set("activeIndex",Q)},onMouseLeave(V){!x||m.current||Mn(V)||A.start(0,()=>{R.state.activeIndex===Q&&R.set("activeIndex",null)})},onTouchStart(){I.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}},onKeyDown(V){E.current=V.key,R.set("activeIndex",Q)},onClick(V){v.current=!1,!(V.type==="keydown"&&E.current===null)&&(u||E.current===" "&&l.current||W.current!=="touch"&&!P||(E.current=null,C(V.nativeEvent)))},onPointerEnter(V){W.current=V.pointerType},onPointerDown(V){W.current=V.pointerType,v.current=!0},onMouseUp(V){if(u)return;if(v.current){v.current=!1;return}const $=!I.current.allowSelectedMouseUp&&N,oe=!I.current.allowUnselectedMouseUp&&!N;$||oe||W.current!=="touch"&&!P||C(V.nativeEvent)}},H=Ne("div",e,{ref:[te,n,a.ref,ne],state:se,props:[q,Y,p,O]}),ae=i.useMemo(()=>({selected:N,indexRef:j,textRef:y,selectedByFocus:ee,hasRegistered:z}),[N,j,y,ee,z]);return h.jsx(En.Provider,{value:ae,children:H})})),bo=i.forwardRef(function(e,n){const r=e.keepMounted??!1,{selected:s}=_t();return r||s?h.jsx(Ro,{...e,ref:n}):null}),Ro=i.memo(i.forwardRef((t,e)=>{const{render:n,className:r,keepMounted:s,...o}=t,{selected:c}=_t(),u=i.useRef(null),{transitionStatus:f,setMounted:p}=Ft(c),a=Ne("span",t,{ref:[e,u],state:{selected:c,transitionStatus:f},props:[{"aria-hidden":!0,children:"✔️"},o],stateAttributesMapping:mn});return xt({open:c,ref:u,onComplete(){c||p(!1)}}),a})),So=i.memo(i.forwardRef(function(e,n){const{indexRef:r,textRef:s,selectedByFocus:o,hasRegistered:c}=_t(),{selectedItemTextRef:u}=je(),{className:f,render:p,...y}=e,a=i.useCallback(w=>{if(!w||!c)return;const T=u.current===null||!u.current.isConnected;(o||T&&r.current===0)&&(u.current=w)},[u,r,o,c]);return Ne("div",e,{ref:[a,n,s],props:y})})),An=i.forwardRef(function(e,n){const{render:r,className:s,direction:o,keepMounted:c=!1,...u}=e,{store:f,popupRef:p,listRef:y,handleScrollArrowVisibility:a,scrollArrowsMountedCountRef:R}=je(),{side:w,scrollDownArrowRef:T,scrollUpArrowRef:b}=Ut(),I=o==="up"?k.scrollUpArrowVisible:k.scrollDownArrowVisible,l=F(f,I),g=F(f,k.openMethod),m=l&&g!=="touch",d=ke(),x=o==="up"?b:T,{transitionStatus:A,setMounted:P}=Ft(m);Z(()=>(R.current+=1,f.state.hasScrollArrows||f.set("hasScrollArrows",!0),()=>{R.current=Math.max(0,R.current-1),R.current===0&&f.state.hasScrollArrows&&f.set("hasScrollArrows",!1)}),[f,R]),xt({open:m,ref:x,onComplete(){m||P(!1)}});const ce=Ne("div",e,{ref:[n,x],state:{direction:o,visible:m,side:w,transitionStatus:A},props:[{"aria-hidden":!0,children:o==="up"?"▲":"▼",style:{position:"absolute"},onMouseMove(z){if(z.movementX===0&&z.movementY===0||d.isStarted())return;f.set("activeIndex",null);function ne(){const j=f.state.listElement??p.current;if(!j)return;f.set("activeIndex",null),a();const se=j.scrollTop===0,q=Math.round(j.scrollTop+j.clientHeight)>=j.scrollHeight;if(y.current.length===0&&(o==="up"?f.set("scrollUpArrowVisible",!se):f.set("scrollDownArrowVisible",!q)),o==="up"&&se||o==="down"&&q){d.clear();return}if((f.state.listElement||p.current)&&y.current&&y.current.length>0){const W=y.current,v=x.current?.offsetHeight||0;if(o==="up"){let O=0;const te=j.scrollTop+v;for(let Y=0;Y<W.length;Y+=1){const H=W[Y];if(H&&H.offsetTop>=te){O=Y;break}}const C=Math.max(0,O-1);if(C<O){const Y=W[C];Y&&(j.scrollTop=Math.max(0,Y.offsetTop-v))}else j.scrollTop=0}else{let O=W.length-1;const te=j.scrollTop+j.clientHeight-v;for(let Y=0;Y<W.length;Y+=1){const H=W[Y];if(H&&H.offsetTop+H.offsetHeight>te){O=Math.max(0,Y-1);break}}const C=Math.min(W.length-1,O+1);if(C>O){const Y=W[C];Y&&(j.scrollTop=Y.offsetTop+Y.offsetHeight-j.clientHeight+v)}else j.scrollTop=j.scrollHeight-j.clientHeight}}d.start(40,ne)}d.start(40,ne)},onMouseLeave(){d.clear()}},u]});return m||c?ce:null}),wo=i.forwardRef(function(e,n){return h.jsx(An,{...e,ref:n,direction:"down"})}),Io=i.forwardRef(function(e,n){return h.jsx(An,{...e,ref:n,direction:"up"})}),At=Wr;function Pt(t){const e=qe.c(8);let n,r;e[0]!==t?({className:n,...r}=t,e[0]=t,e[1]=n,e[2]=r):(n=e[1],r=e[2]);let s;e[3]!==n?(s=Ye("flex flex-1 text-left",n),e[3]=n,e[4]=s):s=e[4];let o;return e[5]!==r||e[6]!==s?(o=h.jsx(Xr,{className:s,"data-slot":"select-value",...r}),e[5]=r,e[6]=s,e[7]=o):o=e[7],o}function Ot(t){const e=qe.c(15);let n,r,s,o,c;e[0]!==t?({className:r,size:c,id:s,children:n,...o}=t,e[0]=t,e[1]=n,e[2]=r,e[3]=s,e[4]=o,e[5]=c):(n=e[1],r=e[2],s=e[3],o=e[4],c=e[5]);const u=c===void 0?"default":c;let f;e[6]!==r?(f=Ye("flex w-fit items-center justify-between gap-1.5 whitespace-nowrap rounded-md border border-input bg-input/20 px-2 py-1.5 text-xs/relaxed outline-none transition-colors focus-visible:border-ring focus-visible:ring-2 focus-visible:ring-ring/30 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-2 aria-invalid:ring-destructive/20 data-[size=default]:h-7 data-[size=sm]:h-6 data-placeholder:text-muted-foreground *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-1.5 dark:bg-input/30 dark:aria-invalid:border-destructive/50 dark:aria-invalid:ring-destructive/40 dark:hover:bg-input/50 [&_svg:not([class*='size-'])]:size-3.5 [&_svg]:pointer-events-none [&_svg]:shrink-0",r),e[6]=r,e[7]=f):f=e[7];let p;e[8]===Symbol.for("react.memo_cache_sentinel")?(p=h.jsx(Qr,{render:h.jsx(xn,{className:"pointer-events-none size-3.5 text-muted-foreground"})}),e[8]=p):p=e[8];let y;return e[9]!==n||e[10]!==s||e[11]!==o||e[12]!==u||e[13]!==f?(y=h.jsxs(Yr,{className:f,"data-size":u,"data-slot":"select-trigger",id:s,...o,children:[n,p]}),e[9]=n,e[10]=s,e[11]=o,e[12]=u,e[13]=f,e[14]=y):y=e[14],y}function Nt(t){const e=qe.c(26);let n,r,s,o,c,u,f,p;e[0]!==t?({className:r,children:n,side:o,sideOffset:c,align:u,alignOffset:f,alignItemWithTrigger:p,...s}=t,e[0]=t,e[1]=n,e[2]=r,e[3]=s,e[4]=o,e[5]=c,e[6]=u,e[7]=f,e[8]=p):(n=e[1],r=e[2],s=e[3],o=e[4],c=e[5],u=e[6],f=e[7],p=e[8]);const y=o===void 0?"bottom":o,a=c===void 0?4:c,R=u===void 0?"center":u,w=f===void 0?0:f,T=p===void 0?!0:p;let b;e[9]!==r?(b=Ye("data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative isolate z-50 max-h-(--available-height) w-(--anchor-width) min-w-32 origin-(--transform-origin) overflow-y-auto overflow-x-hidden rounded-lg bg-popover text-popover-foreground shadow-md ring-1 ring-foreground/10 duration-100 data-closed:animate-out data-open:animate-in",r),e[9]=r,e[10]=b):b=e[10];let I;e[11]===Symbol.for("react.memo_cache_sentinel")?(I=h.jsx(vo,{}),e[11]=I):I=e[11];let l;e[12]!==n?(l=h.jsx(ho,{children:n}),e[12]=n,e[13]=l):l=e[13];let g;e[14]===Symbol.for("react.memo_cache_sentinel")?(g=h.jsx(To,{}),e[14]=g):g=e[14];let m;e[15]!==s||e[16]!==b||e[17]!==l?(m=h.jsxs(mo,{className:b,"data-slot":"select-content",...s,children:[I,l,g]}),e[15]=s,e[16]=b,e[17]=l,e[18]=m):m=e[18];let d;return e[19]!==R||e[20]!==T||e[21]!==w||e[22]!==y||e[23]!==a||e[24]!==m?(d=h.jsx(Zr,{children:h.jsx(io,{align:R,alignItemWithTrigger:T,alignOffset:w,className:"isolate z-50",side:y,sideOffset:a,children:m})}),e[19]=R,e[20]=T,e[21]=w,e[22]=y,e[23]=a,e[24]=m,e[25]=d):d=e[25],d}function jt(t){const e=qe.c(13);let n,r,s;e[0]!==t?({className:r,children:n,...s}=t,e[0]=t,e[1]=n,e[2]=r,e[3]=s):(n=e[1],r=e[2],s=e[3]);let o;e[4]!==r?(o=Ye("relative flex min-h-7 w-full cursor-default select-none items-center gap-2 rounded-md px-2 py-1 text-xs/relaxed outline-hidden focus:bg-accent focus:text-accent-foreground not-data-[variant=destructive]:focus:**:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg:not([class*='size-'])]:size-3.5 [&_svg]:pointer-events-none [&_svg]:shrink-0 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",r),e[4]=r,e[5]=o):o=e[5];let c;e[6]!==n?(c=h.jsx(So,{className:"flex flex-1 shrink-0 gap-2 whitespace-nowrap",children:n}),e[6]=n,e[7]=c):c=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=h.jsx(bo,{render:h.jsx("span",{className:"pointer-events-none absolute right-2 flex items-center justify-center"}),children:h.jsx(Sr,{className:"pointer-events-none"})}),e[8]=u):u=e[8];let f;return e[9]!==s||e[10]!==o||e[11]!==c?(f=h.jsxs(yo,{className:o,"data-slot":"select-item",...s,children:[c,u]}),e[9]=s,e[10]=o,e[11]=c,e[12]=f):f=e[12],f}function vo(t){const e=qe.c(9);let n,r;e[0]!==t?({className:n,...r}=t,e[0]=t,e[1]=n,e[2]=r):(n=e[1],r=e[2]);let s;e[3]!==n?(s=Ye("top-0 z-10 flex w-full cursor-default items-center justify-center bg-popover py-1 [&_svg:not([class*='size-'])]:size-3.5",n),e[3]=n,e[4]=s):s=e[4];let o;e[5]===Symbol.for("react.memo_cache_sentinel")?(o=h.jsx(Mr,{}),e[5]=o):o=e[5];let c;return e[6]!==r||e[7]!==s?(c=h.jsx(Io,{className:s,"data-slot":"select-scroll-up-button",...r,children:o}),e[6]=r,e[7]=s,e[8]=c):c=e[8],c}function To(t){const e=qe.c(9);let n,r;e[0]!==t?({className:n,...r}=t,e[0]=t,e[1]=n,e[2]=r):(n=e[1],r=e[2]);let s;e[3]!==n?(s=Ye("bottom-0 z-10 flex w-full cursor-default items-center justify-center bg-popover py-1 [&_svg:not([class*='size-'])]:size-3.5",n),e[3]=n,e[4]=s):s=e[4];let o;e[5]===Symbol.for("react.memo_cache_sentinel")?(o=h.jsx(xn,{}),e[5]=o):o=e[5];let c;return e[6]!==r||e[7]!==s?(c=h.jsx(wo,{className:s,"data-slot":"select-scroll-down-button",...r,children:o}),e[6]=r,e[7]=s,e[8]=c):c=e[8],c}const Mo=["sg-placeholder"],Co="subnet-placeholder";function Fo(){const t=cr(),{data:e}=Tt(ar),{data:n}=Tt(ur),{data:r}=Tt(fr),s=wr(),o=e.Images??[],c=n.KeyPairs??[],u=r.InstanceTypes?.flatMap(A=>A.InstanceType?[A.InstanceType]:[])??[],f=r.InstanceTypes?.reduce((A,P)=>{const N=P.InstanceType;return N&&(A[N]=(A[N]||0)+1),A},{})??{},p=Object.keys(f).sort(),y=o[0]?.ImageId,a=c[0]?.KeyName,R=p.find(A=>A.endsWith(".nano"))??p[0],{control:w,handleSubmit:T,register:b,watch:I,formState:{errors:l,isSubmitting:g}}=hr({resolver:xr(Ir.refine(A=>A.count<=(f[A.instanceType]??1),{message:"Cannot exceed available capacity",path:["count"]})),defaultValues:{count:1,imageId:y??"",keyName:a??"",instanceType:R??""}}),m=I("instanceType"),d=m?f[m]??1:1,x=async A=>{await s.mutateAsync({...A,securityGroupIds:Mo,subnetId:Co}),t({to:"/ec2/describe-instances"})};return h.jsxs(h.Fragment,{children:[h.jsx(br,{to:"/ec2/describe-instances",children:"Back to instances"}),h.jsx(Rr,{title:"Run EC2 Instances"}),u.length===0&&h.jsx(Qt,{msg:"No compute available. No new instances can be created until compute is available."}),s.error&&h.jsx(Qt,{error:s.error,msg:"Failed to create instance"}),h.jsxs("form",{className:"max-w-4xl space-y-6",onSubmit:T(x),children:[h.jsxs(lt,{children:[h.jsx(ct,{children:h.jsx("label",{htmlFor:"imageId",children:"Image"})}),h.jsx(vt,{control:w,name:"imageId",render:({field:A})=>{const P=o.find(N=>N.ImageId===A.value);return h.jsxs(At,{onValueChange:N=>A.onChange(N),value:A.value??"",children:[h.jsx(Ot,{"aria-invalid":!!l.imageId,className:"w-full",id:"imageId",children:h.jsx(Pt,{children:P?`${P.Name||"Unnamed"} (${P.Architecture})`:""})}),h.jsx(Nt,{children:o.map(N=>h.jsxs(jt,{value:N.ImageId??"",children:[N.Name||"Unnamed"," (",N.Architecture,")"]},N.ImageId))})]})}}),h.jsx(at,{errors:[l.imageId]})]}),h.jsxs(lt,{children:[h.jsx(ct,{children:h.jsx("label",{htmlFor:"instanceType",children:"Instance Type"})}),h.jsx(vt,{control:w,name:"instanceType",render:({field:A})=>h.jsxs(At,{onValueChange:P=>A.onChange(P),value:A.value?A.value:"",children:[h.jsx(Ot,{"aria-invalid":!!l.instanceType,className:"w-full",id:"instanceType",children:h.jsx(Pt,{})}),h.jsx(Nt,{children:p.map(P=>h.jsxs(jt,{value:P,children:[P," (",f[P]," available)"]},P))})]})}),h.jsx(at,{errors:[l.instanceType]})]}),h.jsxs(lt,{children:[h.jsx(ct,{children:h.jsx("label",{htmlFor:"keyName",children:"Key Pair"})}),h.jsx(vt,{control:w,name:"keyName",render:({field:A})=>h.jsxs(At,{onValueChange:P=>A.onChange(P),value:A.value?A.value:"",children:[h.jsx(Ot,{"aria-invalid":!!l.keyName,className:"w-full",id:"keyName",children:h.jsx(Pt,{})}),h.jsx(Nt,{children:c.map(P=>h.jsx(jt,{value:P.KeyName??"",children:P.KeyName},P.KeyPairId))})]})}),h.jsx(at,{errors:[l.keyName]})]}),h.jsxs(lt,{children:[h.jsx(ct,{children:h.jsx("label",{htmlFor:"count",children:"Number of Instances"})}),h.jsx(yr,{"aria-describedby":"count-description","aria-invalid":!!l.count,id:"count",type:"number",...b("count",{valueAsNumber:!0})}),h.jsx("p",{className:"text-muted-foreground text-xs",id:"count-description",children:m&&`Available capacity for ${m}: ${d}`}),h.jsx(at,{errors:[l.count]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(Gt,{disabled:g||s.isPending,onClick:()=>t({to:"/ec2/describe-instances"}),type:"button",variant:"outline",children:"Cancel"}),h.jsx(Gt,{disabled:g||s.isPending||u.length===0,type:"submit",children:g||s.isPending?"Creating…":"Create Instance"})]})]})]})}export{Fo as component};
