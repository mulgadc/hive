import{g as en,A as Dt,k as Re,l as Je,m as He,n as Ue,o as _t,r as l,p as tn,q as Fe,t as zt,v as Mn,w as xe,x as yt,y as Cn,E as nn,z as rn,C as De,D as En,F as An,G as Y,H as Pn,I as de,J as On,K as Kt,L as Nn,M as Ge,N as bt,P as Wt,Q as Vn,R as on,S as jn,T as kn,U as Ot,V as dt,j as h,W as q,X as Ft,Y as Ln,Z as Nt,_ as Dn,$ as k,a0 as Fn,a1 as pt,a2 as Hn,a3 as Un,a4 as Bn,a5 as sn,a6 as ln,a7 as _n,a8 as zn,a9 as Ht,aa as cn,ab as Ve,ac as Vt,ad as Kn,ae as Wn,af as $n,ag as qn,ah as Yn,ai as Gn,aj as Xn,ak as Qn,al as Jn,am as an,an as $t,ao as Zn,ap as er,aq as tr,ar as nr,as as un,at as rr,au as or,av as Rt,c as We,a as $e,u as sr,aw as ir,ax as lr,ay as cr,az as ar,B as qt}from"./index.js";import{e as ur,f as fn,g as dn,h as Yt,i as fr,j as dr,k as pr,u as mr,a as gr,c as ot,b as st,C as wt,F as it,I as hr}from"./field.js";import{u as St}from"./useSuspenseQuery.js";import{B as xr}from"./back-link.js";import{E as Gt}from"./error-banner.js";import{P as yr}from"./page-heading.js";import{C as br}from"./check.js";import{c as Rr}from"./ec2.js";import"./useMutation.js";const wr=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],pn=en("chevron-down",wr);const Sr=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ir=en("chevron-up",Sr);function lt(t,e,n){return Math.floor(t/e)!==n}function Xe(t,e){return e<0||e>=t.current.length}function It(t,e){return he(t,{disabledIndices:e})}function Xt(t,e){return he(t,{decrement:!0,startingIndex:t.current.length,disabledIndices:e})}function he(t,{startingIndex:e=-1,decrement:n=!1,disabledIndices:o,amount:i=1}={}){let r=e;do r+=n?-i:i;while(r>=0&&r<=t.current.length-1&&Qe(t,r,o));return r}function vr(t,{event:e,orientation:n,loopFocus:o,rtl:i,cols:r,disabledIndices:c,minIndex:u,maxIndex:f,prevIndex:d,stopEvent:m=!1}){let p=d;const b=[],P={};let w=!1;{let s=null,R=-1;t.current.forEach((a,x)=>{if(a==null)return;const E=a.closest('[role="row"]');E&&(w=!0),(E!==s||R===-1)&&(s=E,R+=1,b[R]=[]),b[R].push(x),P[x]=R})}const y=w&&b.length>0&&b.some(s=>s.length!==r);function T(s){if(!y||d===-1)return;const R=P[d];if(R==null)return;const a=b[R].indexOf(d);let x=s==="up"?R-1:R+1;o&&(x<0?x=b.length-1:x>=b.length&&(x=0));const E=new Set;for(;x>=0&&x<b.length&&!E.has(x);){E.add(x);const I=b[x];if(I.length===0){x=s==="up"?x-1:x+1;continue}const O=Math.min(a,I.length-1);for(let N=O;N>=0;N-=1){const re=I[N];if(!Qe(t,re,c))return re}x=s==="up"?x-1:x+1,o&&(x<0?x=b.length-1:x>=b.length&&(x=0))}}if(e.key===Dt){const s=T("up");if(s!==void 0)m&&Re(e),p=s;else{if(m&&Re(e),d===-1)p=f;else if(p=he(t,{startingIndex:p,amount:r,decrement:!0,disabledIndices:c}),o&&(d-r<u||p<0)){const R=d%r,a=f%r,x=f-(a-R);a===R?p=f:p=a>R?x:x-r}Xe(t,p)&&(p=d)}}if(e.key===Je){const s=T("down");s!==void 0?(m&&Re(e),p=s):(m&&Re(e),d===-1?p=u:(p=he(t,{startingIndex:d,amount:r,disabledIndices:c}),o&&d+r>f&&(p=he(t,{startingIndex:d%r-r,amount:r,disabledIndices:c}))),Xe(t,p)&&(p=d))}if(n==="both"){const s=_t(d/r);e.key===(i?He:Ue)&&(m&&Re(e),d%r!==r-1?(p=he(t,{startingIndex:d,disabledIndices:c}),o&&lt(p,r,s)&&(p=he(t,{startingIndex:d-d%r-1,disabledIndices:c}))):o&&(p=he(t,{startingIndex:d-d%r-1,disabledIndices:c})),lt(p,r,s)&&(p=d)),e.key===(i?Ue:He)&&(m&&Re(e),d%r!==0?(p=he(t,{startingIndex:d,decrement:!0,disabledIndices:c}),o&&lt(p,r,s)&&(p=he(t,{startingIndex:d+(r-d%r),decrement:!0,disabledIndices:c}))):o&&(p=he(t,{startingIndex:d+(r-d%r),decrement:!0,disabledIndices:c})),lt(p,r,s)&&(p=d));const R=_t(f/r)===s;Xe(t,p)&&(o&&R?p=e.key===(i?Ue:He)?f:he(t,{startingIndex:d-d%r-1,disabledIndices:c}):p=d)}return p}function Tr(t,e,n){const o=[];let i=0;return t.forEach(({width:r,height:c},u)=>{let f=!1;for(n&&(i=0);!f;){const d=[];for(let m=0;m<r;m+=1)for(let p=0;p<c;p+=1)d.push(i+m+p*e);i%e+r<=e&&d.every(m=>o[m]==null)?(d.forEach(m=>{o[m]=u}),f=!0):i+=1}}),[...o]}function Mr(t,e,n,o,i){if(t===-1)return-1;const r=n.indexOf(t),c=e[t];switch(i){case"tl":return r;case"tr":return c?r+c.width-1:r;case"bl":return c?r+(c.height-1)*o:r;case"br":return n.lastIndexOf(t);default:return-1}}function Cr(t,e){return e.flatMap((n,o)=>t.includes(n)?[o]:[])}function Qe(t,e,n){if(typeof n=="function")return n(e);if(n)return n.includes(e);const o=t.current[e];return o?o.hasAttribute("disabled")||o.getAttribute("aria-disabled")==="true":!1}function Er(t,e={}){const n="rootStore"in t?t.rootStore:t,o=n.context.dataRef,{enabled:i=!0,event:r="click",toggle:c=!0,ignoreMouse:u=!1,stickIfOpen:f=!0,touchOpenDelay:d=0}=e,m=l.useRef(void 0),p=tn(),b=Fe(),P=l.useMemo(()=>({onPointerDown(w){m.current=w.pointerType},onMouseDown(w){const y=m.current,T=w.nativeEvent,s=n.select("open");if(w.button!==0||r==="click"||zt(y,!0)&&u)return;const R=o.current.openEvent,a=R?.type,x=n.select("domReferenceElement")!==w.currentTarget,E=s&&x||!(s&&c&&(!(R&&f)||a==="click"||a==="mousedown"));if(Cn(T.target)){const O=xe(yt,T,T.target);E&&y==="touch"&&d>0?b.start(d,()=>{n.setOpen(!0,O)}):n.setOpen(E,O);return}const I=w.currentTarget;p.request(()=>{const O=xe(yt,T,I);E&&y==="touch"&&d>0?b.start(d,()=>{n.setOpen(!0,O)}):n.setOpen(E,O)})},onClick(w){if(r==="mousedown-only")return;const y=m.current;if(r==="mousedown"&&y){m.current=void 0;return}if(zt(y,!0)&&u)return;const T=n.select("open"),s=o.current.openEvent,R=n.select("domReferenceElement")!==w.currentTarget,a=T&&R||!(T&&c&&(!(s&&f)||Mn(s))),x=xe(yt,w.nativeEvent,w.currentTarget);a&&y==="touch"&&d>0?b.start(d,()=>{n.setOpen(!0,x)}):n.setOpen(a,x)},onKeyDown(){m.current=void 0}}),[o,r,u,n,f,c,p,b,d]);return l.useMemo(()=>i?{reference:P}:nn,[i,P])}const Ar="Escape";function mt(t,e,n){switch(t){case"vertical":return e;case"horizontal":return n;default:return e||n}}function ct(t,e){return mt(e,t===Dt||t===Je,t===He||t===Ue)}function vt(t,e,n){return mt(e,t===Je,n?t===He:t===Ue)||t==="Enter"||t===" "||t===""}function Pr(t,e,n){return mt(e,n?t===He:t===Ue,t===Je)}function Or(t,e,n,o){const i=n?t===Ue:t===He,r=t===Dt;return e==="both"||e==="horizontal"&&o&&o>1?t===Ar:mt(e,i,r)}function Nr(t,e){const n="rootStore"in t?t.rootStore:t,o=n.useState("open"),i=n.useState("floatingElement"),r=n.useState("domReferenceElement"),c=n.context.dataRef,{listRef:u,activeIndex:f,onNavigate:d=()=>{},enabled:m=!0,selectedIndex:p=null,allowEscape:b=!1,loopFocus:P=!1,nested:w=!1,rtl:y=!1,virtual:T=!1,focusItemOnOpen:s="auto",focusItemOnHover:R=!0,openOnArrowKeyDown:a=!0,disabledIndices:x=void 0,orientation:E="vertical",parentOrientation:I,cols:O=1,scrollItemIntoView:N=!0,itemSizes:re,dense:ae=!1,id:K,resetOnPointerLeave:W=!0,externalTree:z}=e,D=rn(i),ee=De(D),U=En(),te=An(z);Y(()=>{c.current.orientation=E},[c,E]);const v=Pn(r),B=l.useRef(s),S=l.useRef(p??-1),A=l.useRef(null),ie=l.useRef(!0),M=de(g=>{d(S.current===-1?null:S.current,g)}),se=l.useRef(M),G=l.useRef(!!i),j=l.useRef(o),_=l.useRef(!1),ue=l.useRef(!1),Ie=De(x),H=De(o),fe=De(N),X=De(p),me=De(W),we=de(()=>{function g(Z){T?te?.events.emit("virtualfocus",Z):On(Z,{sync:_.current,preventScroll:!0})}const L=u.current[S.current],C=ue.current;L&&g(L),(_.current?Z=>Z():requestAnimationFrame)(()=>{const Z=u.current[S.current]||L;if(!Z)return;L||g(Z);const le=fe.current;le&&Q&&(C||!ie.current)&&Z.scrollIntoView?.(typeof le=="boolean"?{block:"nearest",inline:"nearest"}:le)})});Y(()=>{m&&(o&&i?(S.current=p??-1,B.current&&p!=null&&(ue.current=!0,M())):G.current&&(S.current=-1,se.current()))},[m,o,i,p,M]),Y(()=>{if(m){if(!o){_.current=!1;return}if(i)if(f==null){if(_.current=!1,X.current!=null)return;if(G.current&&(S.current=-1,we()),(!j.current||!G.current)&&B.current&&(A.current!=null||B.current===!0&&A.current==null)){let g=0;const L=()=>{u.current[0]==null?(g<2&&(g?requestAnimationFrame:queueMicrotask)(L),g+=1):(S.current=A.current==null||vt(A.current,E,y)||w?It(u):Xt(u),A.current=null,M())};L()}}else Xe(u,f)||(S.current=f,we(),ue.current=!1)}},[m,o,i,f,X,w,u,E,y,M,we,Ie]),Y(()=>{if(!m||i||!te||T||!G.current)return;const g=te.nodesRef.current,L=g.find(Z=>Z.id===U)?.context?.elements.floating,C=Kt(Nn(i)),$=g.some(Z=>Z.context&&Ge(Z.context.elements.floating,C));L&&!$&&ie.current&&L.focus({preventScroll:!0})},[m,i,te,U,T]),Y(()=>{se.current=M,j.current=o,G.current=!!i}),Y(()=>{o||(A.current=null,B.current=s)},[o,s]);const pe=f!=null,Q=l.useMemo(()=>{function g(C){if(!H.current)return;const $=u.current.indexOf(C.currentTarget);$!==-1&&S.current!==$&&(S.current=$,M(C))}return{onFocus(C){_.current=!0,g(C)},onClick:({currentTarget:C})=>C.focus({preventScroll:!0}),onMouseMove(C){_.current=!0,ue.current=!1,R&&g(C)},onPointerLeave(C){if(!H.current||!ie.current||C.pointerType==="touch")return;_.current=!0;const $=C.relatedTarget;!R||u.current.includes($)||me.current&&(S.current=-1,M(C),T||ee.current?.focus({preventScroll:!0}))}}},[H,ee,R,u,M,me,T]),J=l.useCallback(()=>I??te?.nodesRef.current.find(g=>g.id===U)?.context?.dataRef?.current.orientation,[U,te,I]),ye=de(g=>{if(ie.current=!1,_.current=!0,g.which===229||!H.current&&g.currentTarget===ee.current)return;if(w&&Or(g.key,E,y,O)){ct(g.key,J())||Re(g),n.setOpen(!1,xe(bt,g.nativeEvent)),Wt(r)&&(T?te?.events.emit("virtualfocus",r):r.focus());return}const L=S.current,C=It(u,x),$=Xt(u,x);if(v||(g.key==="Home"&&(Re(g),S.current=C,M(g)),g.key==="End"&&(Re(g),S.current=$,M(g))),O>1){const Z=re||Array.from({length:u.current.length},()=>({width:1,height:1})),le=Tr(Z,O,ae),ge=le.findIndex(Se=>Se!=null&&!Qe(u,Se,x)),be=le.reduce((Se,Me,Le)=>Me!=null&&!Qe(u,Me,x)?Le:Se,-1),ke=le[vr({current:le.map(Se=>Se!=null?u.current[Se]:null)},{event:g,orientation:E,loopFocus:P,rtl:y,cols:O,disabledIndices:Cr([...(typeof x!="function"?x:null)||u.current.map((Se,Me)=>Qe(u,Me,x)?Me:void 0),void 0],le),minIndex:ge,maxIndex:be,prevIndex:Mr(S.current>$?C:S.current,Z,le,O,g.key===Je?"bl":g.key===(y?He:Ue)?"tr":"tl"),stopEvent:!0})];if(ke!=null&&(S.current=ke,M(g)),E==="both")return}if(ct(g.key,E)){if(Re(g),o&&!T&&Kt(g.currentTarget.ownerDocument)===g.currentTarget){S.current=vt(g.key,E,y)?C:$,M(g);return}vt(g.key,E,y)?P?L>=$?b&&L!==u.current.length?S.current=-1:(_.current=!1,S.current=C):S.current=he(u,{startingIndex:L,disabledIndices:x}):S.current=Math.min($,he(u,{startingIndex:L,disabledIndices:x})):P?L<=C?b&&L!==-1?S.current=u.current.length:(_.current=!1,S.current=$):S.current=he(u,{startingIndex:L,decrement:!0,disabledIndices:x}):S.current=Math.max(C,he(u,{startingIndex:L,decrement:!0,disabledIndices:x})),Xe(u,S.current)&&(S.current=-1),M(g)}}),oe=l.useMemo(()=>T&&o&&pe&&{"aria-activedescendant":`${K}-${f}`},[T,o,pe,K,f]),ne=l.useMemo(()=>({"aria-orientation":E==="both"?void 0:E,...v?{}:oe,onKeyDown(g){if(g.key==="Tab"&&g.shiftKey&&o&&!T){const L=Vn(g.nativeEvent);if(L&&!Ge(ee.current,L))return;Re(g),n.setOpen(!1,xe(on,g.nativeEvent)),Wt(r)&&r.focus();return}ye(g)},onPointerMove(){ie.current=!0}}),[oe,ye,ee,E,v,n,o,T,r]),Te=l.useMemo(()=>{function g(C){s==="auto"&&jn(C.nativeEvent)&&(B.current=!T)}function L(C){B.current=s,s==="auto"&&kn(C.nativeEvent)&&(B.current=!0)}return{onKeyDown(C){const $=n.select("open");ie.current=!1;const Z=C.key.startsWith("Arrow"),le=Pr(C.key,J(),y),ge=ct(C.key,E),be=(w?le:ge)||C.key==="Enter"||C.key.trim()==="";if(T&&$)return ye(C);if(!(!$&&!a&&Z)){if(be){const ke=ct(C.key,J());A.current=w&&ke?null:C.key}if(w){le&&(Re(C),$?(S.current=It(u,Ie.current),M(C)):n.setOpen(!0,xe(bt,C.nativeEvent,C.currentTarget)));return}ge&&(X.current!=null&&(S.current=X.current),Re(C),!$&&a?n.setOpen(!0,xe(bt,C.nativeEvent,C.currentTarget)):ye(C),$&&M(C))}},onFocus(C){n.select("open")&&!T&&(S.current=-1,M(C))},onPointerDown:L,onPointerEnter:L,onMouseDown:g,onClick:g}},[ye,Ie,s,u,w,M,n,a,E,J,y,X,T]),Ae=l.useMemo(()=>({...oe,...Te}),[oe,Te]);return l.useMemo(()=>m?{reference:Ae,floating:ne,item:Q,trigger:Te}:{},[m,Ae,ne,Te,Q])}function Vr(t,e){const n="rootStore"in t?t.rootStore:t,o=n.useState("open"),i=n.context.dataRef,{listRef:r,activeIndex:c,onMatch:u,onTypingChange:f,enabled:d=!0,findMatch:m=null,resetMs:p=750,ignoreKeys:b=Ot,selectedIndex:P=null}=e,w=Fe(),y=l.useRef(""),T=l.useRef(P??c??-1),s=l.useRef(null);Y(()=>{o&&(w.clear(),s.current=null,y.current="")},[o,w]),Y(()=>{o&&y.current===""&&(T.current=P??c??-1)},[o,P,c]);const R=de(I=>{I?i.current.typing||(i.current.typing=I,f?.(I)):i.current.typing&&(i.current.typing=I,f?.(I))}),a=de(I=>{function O(W,z,D){const ee=m?m(z,D):z.find(U=>U?.toLocaleLowerCase().indexOf(D.toLocaleLowerCase())===0);return ee?W.indexOf(ee):-1}const N=r.current;if(y.current.length>0&&y.current[0]!==" "&&(O(N,N,y.current)===-1?R(!1):I.key===" "&&Re(I)),N==null||b.includes(I.key)||I.key.length!==1||I.ctrlKey||I.metaKey||I.altKey)return;o&&I.key!==" "&&(Re(I),R(!0)),N.every(W=>W?W[0]?.toLocaleLowerCase()!==W[1]?.toLocaleLowerCase():!0)&&y.current===I.key&&(y.current="",T.current=s.current),y.current+=I.key,w.start(p,()=>{y.current="",T.current=s.current,R(!1)});const ae=T.current,K=O(N,[...N.slice((ae||0)+1),...N.slice(0,(ae||0)+1)],y.current);K!==-1?(u?.(K),s.current=K):I.key!==" "&&(y.current="",R(!1))}),x=l.useMemo(()=>({onKeyDown:a}),[a]),E=l.useMemo(()=>({onKeyDown:a,onKeyUp(I){I.key===" "&&R(!1)}}),[a,R]);return l.useMemo(()=>d?{reference:x,floating:E}:{},[d,x,E])}function jr(t){const e=l.useRef(!0);e.current&&(e.current=!1,t())}const mn=l.createContext(null),gn=l.createContext(null);function je(){const t=l.useContext(mn);if(t===null)throw new Error(dt(60));return t}function hn(){const t=l.useContext(gn);if(t===null)throw new Error(dt(61));return t}const kr=(t,e)=>Object.is(t,e);function Ke(t,e,n){return t==null||e==null?Object.is(t,e):n(t,e)}function Tt(t,e,n){return!t||t.length===0?!1:t.some(o=>o===void 0?!1:Ke(o,e,n))}function jt(t,e,n){return!t||t.length===0?-1:t.findIndex(o=>o===void 0?!1:Ke(o,e,n))}function Lr(t,e,n){return t.filter(o=>!Ke(o,e,n))}function kt(t){if(t==null)return"";if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return String(t)}}function xn(t){return t!=null&&t.length>0&&typeof t[0]=="object"&&t[0]!=null&&"items"in t[0]}function Dr(t){if(!Array.isArray(t))return t!=null&&!("null"in t);if(xn(t)){for(const e of t)for(const n of e.items)if(n&&n.value==null&&n.label!=null)return!0;return!1}for(const e of t)if(e&&e.value==null&&e.label!=null)return!0;return!1}function Fr(t,e){if(e&&t!=null)return e(t)??"";if(t&&typeof t=="object"){if("label"in t&&t.label!=null)return String(t.label);if("value"in t)return String(t.value)}return kt(t)}function ze(t,e){return e&&t!=null?e(t)??"":t&&typeof t=="object"&&"value"in t&&"label"in t?kt(t.value):kt(t)}function yn(t,e,n){function o(){return Fr(t,n)}if(n&&t!=null)return n(t);if(t&&typeof t=="object"&&"label"in t&&t.label!=null)return t.label;if(e&&!Array.isArray(e))return e[t]??o();if(Array.isArray(e)){const i=xn(e)?e.flatMap(r=>r.items):e;if(t==null||typeof t!="object"){const r=i.find(c=>c.value===t);return r&&r.label!=null?r.label:o()}if("value"in t){const r=i.find(c=>c&&c.value===t.value);if(r&&r.label!=null)return r.label}}return o()}function Hr(t,e,n){return t.reduce((o,i,r)=>(r>0&&o.push(", "),o.push(h.jsx(l.Fragment,{children:yn(i,e,n)},r)),o),[])}const V={id:q(t=>t.id),modal:q(t=>t.modal),multiple:q(t=>t.multiple),items:q(t=>t.items),itemToStringLabel:q(t=>t.itemToStringLabel),itemToStringValue:q(t=>t.itemToStringValue),isItemEqualToValue:q(t=>t.isItemEqualToValue),value:q(t=>t.value),hasSelectedValue:q(t=>{const{value:e,multiple:n,itemToStringValue:o}=t;return e==null?!1:n&&Array.isArray(e)?e.length>0:ze(e,o)!==""}),hasNullItemLabel:q((t,e)=>e?Dr(t.items):!1),open:q(t=>t.open),mounted:q(t=>t.mounted),forceMount:q(t=>t.forceMount),transitionStatus:q(t=>t.transitionStatus),openMethod:q(t=>t.openMethod),activeIndex:q(t=>t.activeIndex),selectedIndex:q(t=>t.selectedIndex),isActive:q((t,e)=>t.activeIndex===e),isSelected:q((t,e,n)=>{const o=t.isItemEqualToValue,i=t.value;return t.multiple?Array.isArray(i)&&i.some(r=>Ke(r,n,o)):t.selectedIndex===e&&t.selectedIndex!==null?!0:Ke(i,n,o)}),isSelectedByFocus:q((t,e)=>t.selectedIndex===e),popupProps:q(t=>t.popupProps),triggerProps:q(t=>t.triggerProps),triggerElement:q(t=>t.triggerElement),positionerElement:q(t=>t.positionerElement),listElement:q(t=>t.listElement),scrollUpArrowVisible:q(t=>t.scrollUpArrowVisible),scrollDownArrowVisible:q(t=>t.scrollDownArrowVisible),hasScrollArrows:q(t=>t.hasScrollArrows)};function Ur(t,e){const n=l.useRef(t),o=de(e);Y(()=>{n.current!==t&&o(n.current)},[t,o]),Y(()=>{n.current=t},[t])}function Br(t){const{id:e,value:n,defaultValue:o=null,onValueChange:i,open:r,defaultOpen:c=!1,onOpenChange:u,name:f,disabled:d=!1,readOnly:m=!1,required:p=!1,modal:b=!0,actionsRef:P,inputRef:w,onOpenChangeComplete:y,items:T,multiple:s=!1,itemToStringLabel:R,itemToStringValue:a,isItemEqualToValue:x=kr,highlightItemOnHover:E=!0,children:I}=t,{clearErrors:O}=ur(),{setDirty:N,setTouched:re,setFocused:ae,shouldValidateOnChange:K,validityData:W,setFilled:z,name:D,disabled:ee,validation:U,validationMode:te}=fn(),v=dn({id:e}),B=ee||d,S=D??f,[A,ie]=Yt({controlled:n,default:s?o??Ot:o,name:"Select",state:"value"}),[M,se]=Yt({controlled:r,default:c,name:"Select",state:"open"}),G=l.useRef([]),j=l.useRef([]),_=l.useRef(null),ue=l.useRef(null),Ie=l.useRef(0),H=l.useRef(null),fe=l.useRef([]),X=l.useRef(!1),me=l.useRef(!1),we=l.useRef(null),pe=l.useRef({allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}),Q=l.useRef(!1),{mounted:J,setMounted:ye,transitionStatus:oe}=Ft(M),{openMethod:ne,triggerProps:Te,reset:Ae}=Ln(M),g=Nt(()=>new Dn({id:v,modal:b,multiple:s,itemToStringLabel:R,itemToStringValue:a,isItemEqualToValue:x,value:A,open:M,mounted:J,transitionStatus:oe,items:T,forceMount:!1,openMethod:null,activeIndex:null,selectedIndex:null,popupProps:{},triggerProps:{},triggerElement:null,positionerElement:null,listElement:null,scrollUpArrowVisible:!1,scrollDownArrowVisible:!1,hasScrollArrows:!1})).current,L=k(g,V.activeIndex),C=k(g,V.selectedIndex),$=k(g,V.triggerElement),Z=k(g,V.positionerElement),le=l.useMemo(()=>s&&Array.isArray(A)&&A.length===0?"":ze(A,a),[s,A,a]),ge=l.useMemo(()=>s&&Array.isArray(A)?A.map(F=>ze(F,a)):ze(A,a),[s,A,a]),be=De(g.state.triggerElement);fr({id:v,commit:U.commit,value:A,controlRef:be,name:S,getValue:()=>ge});const ke=l.useRef(A);Y(()=>{A!==ke.current&&g.set("forceMount",!0)},[g,A]),Y(()=>{z(s?Array.isArray(A)&&A.length>0:A!=null)},[s,A,z]),Y(function(){if(M)return;const ce=fe.current;if(s){const Ee=Array.isArray(A)?A:[];if(Ee.length===0){g.set("selectedIndex",null);return}const ve=Ee[Ee.length-1],rt=jt(ce,ve,x);g.set("selectedIndex",rt===-1?null:rt);return}const Ce=jt(ce,A,x);g.set("selectedIndex",Ce===-1?null:Ce)},[s,M,A,fe,x,g]),Ur(A,()=>{O(S),N(A!==W.initialValue),K()?U.commit(A):U.commit(A,!0)});const Se=de((F,ce)=>{if(u?.(F,ce),!ce.isCanceled&&(se(F),!F&&(ce.reason===on||ce.reason===Fn)&&(re(!0),ae(!1),te==="onBlur"&&U.commit(A)),!F&&g.state.activeIndex!==null)){const Ce=G.current[g.state.activeIndex];queueMicrotask(()=>{Ce?.setAttribute("tabindex","-1")})}}),Me=de(()=>{ye(!1),g.set("activeIndex",null),Ae(),y?.(!1)});pt({enabled:!P,open:M,ref:_,onComplete(){M||Me()}}),l.useImperativeHandle(P,()=>({unmount:Me}),[Me]);const Le=de((F,ce)=>{i?.(F,ce),!ce.isCanceled&&ie(F)}),Pe=de(()=>{const F=g.state.listElement||_.current;if(!F)return;const ce=F.scrollTop,Ce=F.scrollTop+F.clientHeight,Ee=ce>1,ve=Ce<F.scrollHeight-1;g.state.scrollUpArrowVisible!==Ee&&g.set("scrollUpArrowVisible",Ee),g.state.scrollDownArrowVisible!==ve&&g.set("scrollDownArrowVisible",ve)}),Oe=Hn({open:M,onOpenChange:Se,elements:{reference:$,floating:Z}}),Ze=Er(Oe,{enabled:!m&&!B,event:"mousedown"}),qe=Un(Oe,{bubbles:!1}),Ne=Nr(Oe,{enabled:!m&&!B,listRef:G,activeIndex:L,selectedIndex:C,disabledIndices:Ot,onNavigate(F){F===null&&!M||g.set("activeIndex",F)},focusItemOnHover:!1}),gt=Vr(Oe,{enabled:!m&&!B&&(M||!s),listRef:j,activeIndex:L,selectedIndex:C,onMatch(F){M?g.set("activeIndex",F):Le(fe.current[F],xe("none"))},onTypingChange(F){X.current=F}}),{getReferenceProps:Be,getFloatingProps:_e,getItemProps:et}=Bn([Ze,qe,Ne,gt]),Ye=l.useMemo(()=>sn(Be(),Te,v?{id:v}:nn),[Be,Te,v]);jr(()=>{g.update({popupProps:_e(),triggerProps:Ye})}),Y(()=>{g.update({id:v,modal:b,multiple:s,value:A,open:M,mounted:J,transitionStatus:oe,popupProps:_e(),triggerProps:Ye,items:T,itemToStringLabel:R,itemToStringValue:a,isItemEqualToValue:x,openMethod:ne})},[g,v,b,s,A,M,J,oe,_e,Ye,T,R,a,x,ne]);const tt=l.useMemo(()=>({store:g,name:S,required:p,disabled:B,readOnly:m,multiple:s,itemToStringLabel:R,itemToStringValue:a,highlightItemOnHover:E,setValue:Le,setOpen:Se,listRef:G,popupRef:_,scrollHandlerRef:ue,handleScrollArrowVisibility:Pe,scrollArrowsMountedCountRef:Ie,getItemProps:et,events:Oe.context.events,valueRef:H,valuesRef:fe,labelsRef:j,typingRef:X,selectionRef:pe,selectedItemTextRef:we,validation:U,onOpenChangeComplete:y,keyboardActiveRef:me,alignItemWithTriggerActiveRef:Q,initialValueRef:ke}),[g,S,p,B,m,s,R,a,E,Le,Se,et,Oe.context.events,U,y,Pe]),nt=ln(w,U.inputRef),ht=s&&Array.isArray(A)&&A.length>0,xt=l.useMemo(()=>!s||!Array.isArray(A)||!S?null:A.map(F=>{const ce=ze(F,a);return h.jsx("input",{type:"hidden",name:S,value:ce},ce)}),[s,A,S,a]);return h.jsx(mn.Provider,{value:tt,children:h.jsxs(gn.Provider,{value:Oe,children:[I,h.jsx("input",{...U.getInputValidationProps({onFocus(){g.state.triggerElement?.focus({focusVisible:!0})},onChange(F){if(F.nativeEvent.defaultPrevented)return;const ce=F.target.value,Ce=xe(Ht,F.nativeEvent);function Ee(){if(s)return;const ve=fe.current.find(rt=>ze(rt,a).toLowerCase()===ce.toLowerCase());ve!=null&&(N(ve!==W.initialValue),Le(ve,Ce),K()&&U.commit(ve))}g.set("forceMount",!0),queueMicrotask(Ee)}}),name:s?void 0:S,value:le,disabled:B,required:p&&!ht,readOnly:m,ref:nt,style:S?_n:zn,tabIndex:-1,"aria-hidden":!0}),xt]})})}function _r(t){const e=t.getBoundingClientRect(),n=window.getComputedStyle(t,"::before"),o=window.getComputedStyle(t,"::after");if(!(n.content!=="none"||o.content!=="none"))return e;const r=parseFloat(n.width)||0,c=parseFloat(n.height)||0,u=parseFloat(o.width)||0,f=parseFloat(o.height)||0,d=Math.max(e.width,r,u),m=Math.max(e.height,c,f),p=d-e.width,b=m-e.height;return{left:e.left-p/2,right:e.right+p/2,top:e.top-b/2,bottom:e.bottom+b/2}}const at=2,zr=400,Qt=200,Kr={...Wn,...pr,value:()=>null},Wr=l.forwardRef(function(e,n){const{render:o,className:i,id:r,disabled:c=!1,nativeButton:u=!0,...f}=e,{setTouched:d,setFocused:m,validationMode:p,state:b,disabled:P}=fn(),{labelId:w}=dr(),{store:y,setOpen:T,selectionRef:s,validation:R,readOnly:a,required:x,alignItemWithTriggerActiveRef:E,disabled:I,keyboardActiveRef:O}=je(),N=P||I||c,re=k(y,V.open),ae=k(y,V.value),K=k(y,V.triggerProps),W=k(y,V.positionerElement),z=k(y,V.listElement),D=k(y,V.id),ee=k(y,V.hasSelectedValue),U=!ee&&re,te=k(y,V.hasNullItemLabel,U),v=r??D;dn({id:v});const B=De(W),S=l.useRef(null),{getButtonProps:A,buttonRef:ie}=cn({disabled:N,native:u}),M=de(X=>{y.set("triggerElement",X)}),se=ln(n,S,ie,M),G=Fe(),j=Fe(),_=Fe(),ue=Fe();l.useEffect(()=>{if(re)return!(ee||te)?_.start(zr,()=>{s.current.allowUnselectedMouseUp=!0,s.current.allowSelectedMouseUp=!0}):ue.start(Qt,()=>{s.current.allowUnselectedMouseUp=!0,_.start(Qt,()=>{s.current.allowSelectedMouseUp=!0})}),()=>{_.clear(),ue.clear()};s.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1},j.clear()},[re,ee,te,s,j,_,ue]);const Ie=l.useMemo(()=>z?.id??rn(W)?.id,[z,W]),H=sn(K,{id:v,role:"combobox","aria-expanded":re?"true":"false","aria-haspopup":"listbox","aria-controls":re?Ie:void 0,"aria-labelledby":w,"aria-readonly":a||void 0,"aria-required":x||void 0,tabIndex:N?-1:0,ref:se,onFocus(X){m(!0),re&&E.current&&T(!1,xe(Ht,X.nativeEvent)),G.start(0,()=>{y.set("forceMount",!0)})},onBlur(X){Ge(W,X.relatedTarget)||(d(!0),m(!1),p==="onBlur"&&R.commit(ae))},onPointerMove(){O.current=!1},onKeyDown(){O.current=!0},onMouseDown(X){if(re)return;const me=Vt(X.currentTarget);function we(pe){if(!S.current)return;const Q=pe.target;if(Ge(S.current,Q)||Ge(B.current,Q)||Q===S.current)return;const J=_r(S.current);pe.clientX>=J.left-at&&pe.clientX<=J.right+at&&pe.clientY>=J.top-at&&pe.clientY<=J.bottom+at||T(!1,xe(Kn,pe))}j.start(0,()=>{me.addEventListener("mouseup",we,{once:!0})})}},R.getValidationProps,f,A);H.role="combobox";const fe=l.useMemo(()=>({...b,open:re,disabled:N,value:ae,readOnly:a,placeholder:!ee}),[b,re,N,ae,a,ee]);return Ve("button",e,{ref:[n,S],state:fe,stateAttributesMapping:Kr,props:H})}),$r={value:()=>null},qr=l.forwardRef(function(e,n){const{className:o,render:i,children:r,placeholder:c,...u}=e,{store:f,valueRef:d}=je(),m=k(f,V.value),p=k(f,V.items),b=k(f,V.itemToStringLabel),P=k(f,V.hasSelectedValue),w=!P&&c!=null&&r==null,y=k(f,V.hasNullItemLabel,w),T=l.useMemo(()=>({value:m,placeholder:!P}),[m,P]);let s=null;return typeof r=="function"?s=r(m):r!=null?s=r:!P&&c!=null&&!y?s=c:Array.isArray(m)?s=Hr(m,p,b):s=yn(m,p,b),Ve("span",e,{state:T,ref:[n,d],props:[{children:s},u],stateAttributesMapping:$r})}),Yr=l.forwardRef(function(e,n){const{className:o,render:i,...r}=e,{store:c}=je(),u=k(c,V.open),f=l.useMemo(()=>({open:u}),[u]);return Ve("span",e,{state:f,ref:n,props:[{"aria-hidden":!0,children:"▼"},r],stateAttributesMapping:$n})}),Gr=l.createContext(void 0),Xr=l.forwardRef(function(e,n){const{store:o}=je(),i=k(o,V.mounted),r=k(o,V.forceMount);return i||r?h.jsx(Gr.Provider,{value:!0,children:h.jsx(qn,{ref:n,...e})}):null}),bn=l.createContext({register:()=>{},unregister:()=>{},subscribeMapChange:()=>()=>{},elementsRef:{current:[]},nextIndexRef:{current:0}});function Qr(){return l.useContext(bn)}function Jr(t){const{children:e,elementsRef:n,labelsRef:o,onMapChange:i}=t,r=de(i),c=l.useRef(0),u=Nt(eo).current,f=Nt(Zr).current,[d,m]=l.useState(0),p=l.useRef(d),b=de((s,R)=>{f.set(s,R??null),p.current+=1,m(p.current)}),P=de(s=>{f.delete(s),p.current+=1,m(p.current)}),w=l.useMemo(()=>{const s=new Map;return Array.from(f.keys()).filter(a=>a.isConnected).sort(to).forEach((a,x)=>{const E=f.get(a)??{};s.set(a,{...E,index:x})}),s},[f,d]);Y(()=>{if(typeof MutationObserver!="function"||w.size===0)return;const s=new MutationObserver(R=>{const a=new Set,x=E=>a.has(E)?a.delete(E):a.add(E);R.forEach(E=>{E.removedNodes.forEach(x),E.addedNodes.forEach(x)}),a.size===0&&(p.current+=1,m(p.current))});return w.forEach((R,a)=>{a.parentElement&&s.observe(a.parentElement,{childList:!0})}),()=>{s.disconnect()}},[w]),Y(()=>{p.current===d&&(n.current.length!==w.size&&(n.current.length=w.size),o&&o.current.length!==w.size&&(o.current.length=w.size),c.current=w.size),r(w)},[r,w,n,o,d]),Y(()=>()=>{n.current=[]},[n]),Y(()=>()=>{o&&(o.current=[])},[o]);const y=de(s=>(u.add(s),()=>{u.delete(s)}));Y(()=>{u.forEach(s=>s(w))},[u,w]);const T=l.useMemo(()=>({register:b,unregister:P,subscribeMapChange:y,elementsRef:n,labelsRef:o,nextIndexRef:c}),[b,P,y,n,o,c]);return h.jsx(bn.Provider,{value:T,children:e})}function Zr(){return new Map}function eo(){return new Set}function to(t,e){const n=t.compareDocumentPosition(e);return n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS?1:0}const Rn=l.createContext(void 0);function Ut(){const t=l.useContext(Rn);if(!t)throw new Error(dt(59));return t}function ft(t,e){t&&Object.assign(t.style,e)}const wn={position:"relative",maxHeight:"100%",overflowX:"hidden",overflowY:"auto"},no={position:"fixed"},ro=l.forwardRef(function(e,n){const{anchor:o,positionMethod:i="absolute",className:r,render:c,side:u="bottom",align:f="center",sideOffset:d=0,alignOffset:m=0,collisionBoundary:p="clipping-ancestors",collisionPadding:b,arrowPadding:P=5,sticky:w=!1,disableAnchorTracking:y,alignItemWithTrigger:T=!0,collisionAvoidance:s=Yn,...R}=e,{store:a,listRef:x,labelsRef:E,alignItemWithTriggerActiveRef:I,selectedItemTextRef:O,valuesRef:N,initialValueRef:re,popupRef:ae,setValue:K}=je(),W=hn(),z=k(a,V.open),D=k(a,V.mounted),ee=k(a,V.modal),U=k(a,V.value),te=k(a,V.openMethod),v=k(a,V.positionerElement),B=k(a,V.triggerElement),S=k(a,V.isItemEqualToValue),A=l.useRef(null),ie=l.useRef(null),[M,se]=l.useState(T),G=D&&M&&te!=="touch";!D&&M!==T&&se(T),Y(()=>{D||(V.scrollUpArrowVisible(a.state)&&a.set("scrollUpArrowVisible",!1),V.scrollDownArrowVisible(a.state)&&a.set("scrollDownArrowVisible",!1))},[a,D]),l.useImperativeHandle(I,()=>G),Gn((G||ee)&&z&&te!=="touch",B);const j=Xn({anchor:o,floatingRootContext:W,positionMethod:i,mounted:D,side:u,sideOffset:d,align:f,alignOffset:m,arrowPadding:P,collisionBoundary:p,collisionPadding:b,sticky:w,disableAnchorTracking:y??G,collisionAvoidance:s,keepMounted:!0}),_=G?"none":j.side,ue=G?no:j.positionerStyles,Ie=l.useMemo(()=>{const Q={};return z||(Q.pointerEvents="none"),{role:"presentation",hidden:!D,style:{...ue,...Q}}},[z,D,ue]),H=l.useMemo(()=>({open:z,side:_,align:j.align,anchorHidden:j.anchorHidden}),[z,_,j.align,j.anchorHidden]),fe=de(Q=>{a.set("positionerElement",Q)}),X=Ve("div",e,{ref:[n,fe],state:H,stateAttributesMapping:an,props:[Ie,R]}),me=l.useRef(0),we=de(Q=>{if(Q.size===0&&me.current===0||N.current.length===0)return;const J=me.current;if(me.current=Q.size,Q.size===J)return;const ye=xe(Ht);if(J!==0&&!a.state.multiple&&U!==null&&jt(N.current,U,S)===-1){const ne=re.current,Ae=ne!=null&&Tt(N.current,ne,S)?ne:null;K(Ae,ye),Ae===null&&(a.set("selectedIndex",null),O.current=null)}if(J!==0&&a.state.multiple&&Array.isArray(U)){const oe=U.filter(ne=>Tt(N.current,ne,S));(oe.length!==U.length||oe.some(ne=>!Tt(U,ne,S)))&&(K(oe,ye),oe.length===0&&(a.set("selectedIndex",null),O.current=null))}if(z&&G){a.update({scrollUpArrowVisible:!1,scrollDownArrowVisible:!1});const oe={height:""};ft(v,oe),ft(ae.current,oe)}}),pe=l.useMemo(()=>({...j,side:_,alignItemWithTriggerActive:G,setControlledAlignItemWithTrigger:se,scrollUpArrowRef:A,scrollDownArrowRef:ie}),[j,_,G,se]);return h.jsx(Jr,{elementsRef:x,labelsRef:E,onMapChange:we,children:h.jsxs(Rn.Provider,{value:pe,children:[D&&ee&&h.jsx(Qn,{inert:Jn(!z),cutout:B}),X]})})});function Sn(t){const e=t.currentTarget.getBoundingClientRect();return e.top+1<=t.clientY&&t.clientY<=e.bottom-1&&e.left+1<=t.clientX&&t.clientX<=e.right-1}const ut="base-ui-disable-scrollbar",Lt={className:ut,getElement(t){return h.jsx("style",{nonce:t,href:ut,precedence:"base-ui:low",children:`.${ut}{scrollbar-width:none}.${ut}::-webkit-scrollbar{display:none}`})}},oo=l.createContext(void 0);function so(t){return l.useContext(oo)}function io(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const lo=l.createContext(void 0),co={disableStyleElements:!1};function ao(){return l.useContext(lo)??co}const uo={...an,...un},fo=l.forwardRef(function(e,n){const{render:o,className:i,...r}=e,{store:c,popupRef:u,onOpenChangeComplete:f,setOpen:d,valueRef:m,selectedItemTextRef:p,keyboardActiveRef:b,multiple:P,handleScrollArrowVisibility:w,scrollHandlerRef:y,highlightItemOnHover:T}=je(),{side:s,align:R,alignItemWithTriggerActive:a,setControlledAlignItemWithTrigger:x,scrollDownArrowRef:E,scrollUpArrowRef:I}=Ut(),O=so()!=null,N=hn(),{nonce:re,disableStyleElements:ae}=ao(),K=Fe(),W=k(c,V.id),z=k(c,V.open),D=k(c,V.mounted),ee=k(c,V.popupProps),U=k(c,V.transitionStatus),te=k(c,V.triggerElement),v=k(c,V.positionerElement),B=k(c,V.listElement),S=l.useRef(0),A=l.useRef(!1),ie=l.useRef(0),M=l.useRef(!1),se=l.useRef({}),G=tn(),j=de(H=>{if(!v||!u.current||!M.current)return;if(A.current||!a){w();return}const fe=v.style.top==="0px",X=v.style.bottom==="0px",me=v.getBoundingClientRect().height,we=Vt(v),pe=getComputedStyle(v),Q=parseFloat(pe.marginTop),J=parseFloat(pe.marginBottom),ye=Jt(getComputedStyle(u.current)),oe=we.documentElement.clientHeight-Q-J,ne=H.scrollTop,Te=H.scrollHeight,Ae=H.clientHeight,g=Te-Ae;let L=0,C=null,$=!1;if(fe){const Z=g-ne,le=me+Z,ge=Math.min(le,oe);L=ge,ge!==oe?C=g:$=!0}else if(X){const Z=ne-0,le=me+Z,ge=Math.min(le,oe),be=le-oe;L=ge,ge!==oe?C=0:($=!0,ne<g&&(C=ne-(Z-be)))}L!==0&&(v.style.height=`${L}px`),C!=null&&(H.scrollTop=C),($||L>=ye)&&(A.current=!0),w()});l.useImperativeHandle(y,()=>j,[j]),pt({open:z,ref:u,onComplete(){z&&f?.(!0)}});const _=l.useMemo(()=>({open:z,transitionStatus:U,side:s,align:R}),[z,U,s,R]);Y(()=>{!v||!u.current||Object.keys(se.current).length||(se.current={top:v.style.top||"0",left:v.style.left||"0",right:v.style.right,height:v.style.height,bottom:v.style.bottom,minHeight:v.style.minHeight,maxHeight:v.style.maxHeight,marginTop:v.style.marginTop,marginBottom:v.style.marginBottom})},[u,v]),Y(()=>{z||a||(M.current=!1,A.current=!1,S.current=0,ie.current=0,ft(v,se.current))},[z,a,v,u]),Y(()=>{const H=u.current;if(!(!z||!te||!v||!H||c.state.transitionStatus==="ending")){if(!a){M.current=!0,G.request(w),H.style.removeProperty("--transform-origin");return}queueMicrotask(()=>{const fe=mo(H);H.style.removeProperty("--transform-origin");try{const X=getComputedStyle(v),me=getComputedStyle(H),we=Vt(te),pe=$t(v),Q=te.getBoundingClientRect(),J=v.getBoundingClientRect(),ye=Q.left,oe=Q.height,ne=B||H,Te=ne.scrollHeight,Ae=parseFloat(me.borderBottomWidth),g=parseFloat(X.marginTop)||10,L=parseFloat(X.marginBottom)||10,C=parseFloat(X.minHeight)||100,$=Jt(me),Z=5,le=5,ge=20,be=we.documentElement.clientHeight-g-L,ke=we.documentElement.clientWidth,Se=be-Q.bottom+oe,Me=p.current,Le=m.current;let Pe,Oe=0,Ze=0;if(Me&&Le){const F=Le.getBoundingClientRect();Pe=Me.getBoundingClientRect();const ce=F.left-ye,Ce=Pe.left-J.left,Ee=F.top-Q.top+F.height/2,ve=Pe.top-J.top+Pe.height/2;Oe=ce-Ce,Ze=ve-Ee}const qe=Se+Ze+L+Ae;let Ne=Math.min(be,qe);const gt=be-g-L,Be=qe-Ne,_e=Math.max(Z,ye+Oe),et=ke-le,Ye=Math.max(0,_e+J.width-et);v.style.left=`${_e-Ye}px`,v.style.height=`${Ne}px`,v.style.maxHeight="auto",v.style.marginTop=`${g}px`,v.style.marginBottom=`${L}px`,H.style.height="100%";const tt=ne.scrollHeight-ne.clientHeight,nt=Be>=tt;nt&&(Ne=Math.min(be,J.height)-(Be-tt));const ht=Q.top<ge||Q.bottom>be-ge||Ne<Math.min(Te,C),xt=(pe.visualViewport?.scale??1)!==1&&Zn;if(ht||xt){M.current=!0,ft(v,se.current),er.flushSync(()=>x(!1));return}if(nt){const F=Math.max(0,be-qe);v.style.top=J.height>=gt?"0":`${F}px`,v.style.height=`${Ne}px`,ne.scrollTop=ne.scrollHeight-ne.clientHeight,S.current=Math.max(C,Ne)}else v.style.bottom="0",S.current=Math.max(C,Ne),ne.scrollTop=Be;if(Pe){const F=J.top,ce=J.height,Ce=Pe.top+Pe.height/2,Ee=ce>0?(Ce-F)/ce*100:50,ve=io(Ee,0,100);H.style.setProperty("--transform-origin",`50% ${ve}%`)}(S.current===be||Ne>=$)&&(A.current=!0),w(),setTimeout(()=>{M.current=!0})}finally{fe()}})}},[c,z,v,te,m,p,u,w,a,x,G,E,I,B]),l.useEffect(()=>{if(!a||!v||!z)return;const H=$t(v);function fe(X){d(!1,xe(nr,X))}return H.addEventListener("resize",fe),()=>{H.removeEventListener("resize",fe)}},[d,a,v,z]);const ue={...B?{role:"presentation","aria-orientation":void 0}:{role:"listbox","aria-multiselectable":P||void 0,id:`${W}-list`},onKeyDown(H){b.current=!0,O&&or.has(H.key)&&H.stopPropagation()},onMouseMove(){b.current=!1},onPointerLeave(H){if(!T||Sn(H)||H.pointerType==="touch")return;const fe=H.currentTarget;K.start(0,()=>{c.set("activeIndex",null),fe.focus({preventScroll:!0})})},onScroll(H){B||y.current?.(H.currentTarget)},...a&&{style:B?{height:"100%"}:wn}},Ie=Ve("div",e,{ref:[n,u],state:_,stateAttributesMapping:uo,props:[ee,ue,rr(U),{className:!B&&a?Lt.className:void 0},r]});return h.jsxs(l.Fragment,{children:[!ae&&Lt.getElement(re),h.jsx(tr,{context:N,modal:!1,disabled:!D,restoreFocus:!0,children:Ie})]})});function Jt(t){const e=t.maxHeight||"";return e.endsWith("px")&&parseFloat(e)||1/0}const Zt={transform:"none",scale:"1",translate:"0 0"};function po(t,e,n){n?t.setProperty(e,n):t.removeProperty(e)}function mo(t){const{style:e}=t,n={},o=Object.keys(Zt);for(const i of o)n[i]=e.getPropertyValue(i),e.setProperty(i,Zt[i]);return()=>{for(const i of o)po(e,i,n[i])}}const go=l.forwardRef(function(e,n){const{className:o,render:i,...r}=e,{store:c,scrollHandlerRef:u}=je(),{alignItemWithTriggerActive:f}=Ut(),d=k(c,V.hasScrollArrows),m=k(c,V.openMethod),p=k(c,V.multiple),P={id:`${k(c,V.id)}-list`,role:"listbox","aria-multiselectable":p||void 0,onScroll(y){u.current?.(y.currentTarget)},...f&&{style:wn},className:d&&m!=="touch"?Lt.className:void 0},w=de(y=>{c.set("listElement",y)});return Ve("div",e,{ref:[n,w],props:[P,r]})});let In=(function(t){return t[t.None=0]="None",t[t.GuessFromOrder=1]="GuessFromOrder",t})({});function ho(t={}){const{label:e,metadata:n,textRef:o,indexGuessBehavior:i,index:r}=t,{register:c,unregister:u,subscribeMapChange:f,elementsRef:d,labelsRef:m,nextIndexRef:p}=Qr(),b=l.useRef(-1),[P,w]=l.useState(r??(i===In.GuessFromOrder?()=>{if(b.current===-1){const s=p.current;p.current+=1,b.current=s}return b.current}:-1)),y=l.useRef(null),T=l.useCallback(s=>{if(y.current=s,P!==-1&&s!==null&&(d.current[P]=s,m)){const R=e!==void 0;m.current[P]=R?e:o?.current?.textContent??s.textContent}},[P,d,m,e,o]);return Y(()=>{if(r!=null)return;const s=y.current;if(s)return c(s,n),()=>{u(s)}},[r,c,u,n]),Y(()=>{if(r==null)return f(s=>{const R=y.current?s.get(y.current)?.index:null;R!=null&&w(R)})},[r,f,w]),l.useMemo(()=>({ref:T,index:P}),[P,T])}const vn=l.createContext(void 0);function Bt(){const t=l.useContext(vn);if(!t)throw new Error(dt(57));return t}const xo=l.memo(l.forwardRef(function(e,n){const{render:o,className:i,value:r=null,label:c,disabled:u=!1,nativeButton:f=!1,...d}=e,m=l.useRef(null),p=ho({label:c,textRef:m,indexGuessBehavior:In.GuessFromOrder}),{store:b,getItemProps:P,setOpen:w,setValue:y,selectionRef:T,typingRef:s,valuesRef:R,keyboardActiveRef:a,multiple:x,highlightItemOnHover:E}=je(),I=Fe(),O=k(b,V.isActive,p.index),N=k(b,V.isSelected,p.index,r),re=k(b,V.isSelectedByFocus,p.index),ae=k(b,V.isItemEqualToValue),K=p.index,W=K!==-1,z=l.useRef(null),D=De(K);Y(()=>{if(!W)return;const j=R.current;return j[K]=r,()=>{delete j[K]}},[W,K,r,R]),Y(()=>{if(!W)return;const j=b.state.value;let _=j;x&&Array.isArray(j)&&j.length>0&&(_=j[j.length-1]),_!==void 0&&Ke(_,r,ae)&&b.set("selectedIndex",K)},[W,K,x,ae,b,r]);const ee=l.useMemo(()=>({disabled:u,selected:N,highlighted:O}),[u,N,O]),U=P({active:O,selected:N});U.onFocus=void 0,U.id=void 0;const te=l.useRef(null),v=l.useRef("mouse"),B=l.useRef(!1),{getButtonProps:S,buttonRef:A}=cn({disabled:u,focusableWhenDisabled:!0,native:f});function ie(j){const _=b.state.value;if(x){const ue=Array.isArray(_)?_:[],Ie=N?Lr(ue,r,ae):[...ue,r];y(Ie,xe(Rt,j))}else y(r,xe(Rt,j)),w(!1,xe(Rt,j))}const M={role:"option","aria-selected":N,tabIndex:O?0:-1,onFocus(){b.set("activeIndex",K)},onMouseEnter(){!a.current&&b.state.selectedIndex===null&&b.set("activeIndex",K)},onMouseMove(){E&&b.set("activeIndex",K)},onMouseLeave(j){!E||a.current||Sn(j)||I.start(0,()=>{b.state.activeIndex===K&&b.set("activeIndex",null)})},onTouchStart(){T.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}},onKeyDown(j){te.current=j.key,b.set("activeIndex",K)},onClick(j){B.current=!1,!(j.type==="keydown"&&te.current===null)&&(u||te.current===" "&&s.current||v.current!=="touch"&&!O||(te.current=null,ie(j.nativeEvent)))},onPointerEnter(j){v.current=j.pointerType},onPointerDown(j){v.current=j.pointerType,B.current=!0},onMouseUp(j){if(u)return;if(B.current){B.current=!1;return}const _=!T.current.allowSelectedMouseUp&&N,ue=!T.current.allowUnselectedMouseUp&&!N;_||ue||v.current!=="touch"&&!O||ie(j.nativeEvent)}},se=Ve("div",e,{ref:[A,n,p.ref,z],state:ee,props:[U,M,d,S]}),G=l.useMemo(()=>({selected:N,indexRef:D,textRef:m,selectedByFocus:re,hasRegistered:W}),[N,D,m,re,W]);return h.jsx(vn.Provider,{value:G,children:se})})),yo=l.forwardRef(function(e,n){const o=e.keepMounted??!1,{selected:i}=Bt();return o||i?h.jsx(bo,{...e,ref:n}):null}),bo=l.memo(l.forwardRef((t,e)=>{const{render:n,className:o,keepMounted:i,...r}=t,{selected:c}=Bt(),u=l.useRef(null),{transitionStatus:f,setMounted:d}=Ft(c),m=l.useMemo(()=>({selected:c,transitionStatus:f}),[c,f]),p=Ve("span",t,{ref:[e,u],state:m,props:[{"aria-hidden":!0,children:"✔️"},r],stateAttributesMapping:un});return pt({open:c,ref:u,onComplete(){c||d(!1)}}),p})),Ro=l.memo(l.forwardRef(function(e,n){const{indexRef:o,textRef:i,selectedByFocus:r,hasRegistered:c}=Bt(),{selectedItemTextRef:u}=je(),{className:f,render:d,...m}=e,p=l.useCallback(P=>{if(!P||!c)return;const w=u.current===null||!u.current.isConnected;(r||w&&o.current===0)&&(u.current=P)},[u,o,r,c]);return Ve("div",e,{ref:[p,n,i],props:m})})),Tn=l.forwardRef(function(e,n){const{render:o,className:i,direction:r,keepMounted:c=!1,...u}=e,{store:f,popupRef:d,listRef:m,handleScrollArrowVisibility:p,scrollArrowsMountedCountRef:b}=je(),{side:P,scrollDownArrowRef:w,scrollUpArrowRef:y}=Ut(),T=r==="up"?V.scrollUpArrowVisible:V.scrollDownArrowVisible,s=k(f,T),R=k(f,V.openMethod),a=s&&R!=="touch",x=Fe(),E=r==="up"?y:w,{transitionStatus:I,setMounted:O}=Ft(a);Y(()=>(b.current+=1,f.state.hasScrollArrows||f.set("hasScrollArrows",!0),()=>{b.current=Math.max(0,b.current-1),b.current===0&&f.state.hasScrollArrows&&f.set("hasScrollArrows",!1)}),[f,b]),pt({open:a,ref:E,onComplete(){a||O(!1)}});const N=l.useMemo(()=>({direction:r,visible:a,side:P,transitionStatus:I}),[r,a,P,I]),ae=Ve("div",e,{ref:[n,E],state:N,props:[{"aria-hidden":!0,children:r==="up"?"▲":"▼",style:{position:"absolute"},onMouseMove(W){if(W.movementX===0&&W.movementY===0||x.isStarted())return;f.set("activeIndex",null);function z(){const D=f.state.listElement??d.current;if(!D)return;f.set("activeIndex",null),p();const ee=D.scrollTop===0,U=Math.round(D.scrollTop+D.clientHeight)>=D.scrollHeight;if(m.current.length===0&&(r==="up"?f.set("scrollUpArrowVisible",!ee):f.set("scrollDownArrowVisible",!U)),r==="up"&&ee||r==="down"&&U){x.clear();return}if((f.state.listElement||d.current)&&m.current&&m.current.length>0){const v=m.current,B=E.current?.offsetHeight||0;if(r==="up"){let S=0;const A=D.scrollTop+B;for(let M=0;M<v.length;M+=1){const se=v[M];if(se&&se.offsetTop>=A){S=M;break}}const ie=Math.max(0,S-1);if(ie<S){const M=v[ie];M&&(D.scrollTop=Math.max(0,M.offsetTop-B))}else D.scrollTop=0}else{let S=v.length-1;const A=D.scrollTop+D.clientHeight-B;for(let M=0;M<v.length;M+=1){const se=v[M];if(se&&se.offsetTop+se.offsetHeight>A){S=Math.max(0,M-1);break}}const ie=Math.min(v.length-1,S+1);if(ie>S){const M=v[ie];M&&(D.scrollTop=M.offsetTop+M.offsetHeight-D.clientHeight+B)}else D.scrollTop=D.scrollHeight-D.clientHeight}}x.start(40,z)}x.start(40,z)},onMouseLeave(){x.clear()}},u]});return a||c?ae:null}),wo=l.forwardRef(function(e,n){return h.jsx(Tn,{...e,ref:n,direction:"down"})}),So=l.forwardRef(function(e,n){return h.jsx(Tn,{...e,ref:n,direction:"up"})}),Mt=Br;function Ct(t){const e=We.c(8);let n,o;e[0]!==t?({className:n,...o}=t,e[0]=t,e[1]=n,e[2]=o):(n=e[1],o=e[2]);let i;e[3]!==n?(i=$e("flex flex-1 text-left",n),e[3]=n,e[4]=i):i=e[4];let r;return e[5]!==o||e[6]!==i?(r=h.jsx(qr,{className:i,"data-slot":"select-value",...o}),e[5]=o,e[6]=i,e[7]=r):r=e[7],r}function Et(t){const e=We.c(15);let n,o,i,r,c;e[0]!==t?({className:o,size:c,id:i,children:n,...r}=t,e[0]=t,e[1]=n,e[2]=o,e[3]=i,e[4]=r,e[5]=c):(n=e[1],o=e[2],i=e[3],r=e[4],c=e[5]);const u=c===void 0?"default":c;let f;e[6]!==o?(f=$e("flex w-fit items-center justify-between gap-1.5 whitespace-nowrap rounded-md border border-input bg-input/20 px-2 py-1.5 text-xs/relaxed outline-none transition-colors focus-visible:border-ring focus-visible:ring-2 focus-visible:ring-ring/30 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-2 aria-invalid:ring-destructive/20 data-[size=default]:h-7 data-[size=sm]:h-6 data-placeholder:text-muted-foreground *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-1.5 dark:bg-input/30 dark:aria-invalid:border-destructive/50 dark:aria-invalid:ring-destructive/40 dark:hover:bg-input/50 [&_svg:not([class*='size-'])]:size-3.5 [&_svg]:pointer-events-none [&_svg]:shrink-0",o),e[6]=o,e[7]=f):f=e[7];let d;e[8]===Symbol.for("react.memo_cache_sentinel")?(d=h.jsx(Yr,{render:h.jsx(pn,{className:"pointer-events-none size-3.5 text-muted-foreground"})}),e[8]=d):d=e[8];let m;return e[9]!==n||e[10]!==i||e[11]!==r||e[12]!==u||e[13]!==f?(m=h.jsxs(Wr,{className:f,"data-size":u,"data-slot":"select-trigger",id:i,...r,children:[n,d]}),e[9]=n,e[10]=i,e[11]=r,e[12]=u,e[13]=f,e[14]=m):m=e[14],m}function At(t){const e=We.c(26);let n,o,i,r,c,u,f,d;e[0]!==t?({className:o,children:n,side:r,sideOffset:c,align:u,alignOffset:f,alignItemWithTrigger:d,...i}=t,e[0]=t,e[1]=n,e[2]=o,e[3]=i,e[4]=r,e[5]=c,e[6]=u,e[7]=f,e[8]=d):(n=e[1],o=e[2],i=e[3],r=e[4],c=e[5],u=e[6],f=e[7],d=e[8]);const m=r===void 0?"bottom":r,p=c===void 0?4:c,b=u===void 0?"center":u,P=f===void 0?0:f,w=d===void 0?!0:d;let y;e[9]!==o?(y=$e("data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative isolate z-50 max-h-(--available-height) w-(--anchor-width) min-w-32 origin-(--transform-origin) overflow-y-auto overflow-x-hidden rounded-lg bg-popover text-popover-foreground shadow-md ring-1 ring-foreground/10 duration-100 data-closed:animate-out data-open:animate-in",o),e[9]=o,e[10]=y):y=e[10];let T;e[11]===Symbol.for("react.memo_cache_sentinel")?(T=h.jsx(Io,{}),e[11]=T):T=e[11];let s;e[12]!==n?(s=h.jsx(go,{children:n}),e[12]=n,e[13]=s):s=e[13];let R;e[14]===Symbol.for("react.memo_cache_sentinel")?(R=h.jsx(vo,{}),e[14]=R):R=e[14];let a;e[15]!==i||e[16]!==y||e[17]!==s?(a=h.jsxs(fo,{className:y,"data-slot":"select-content",...i,children:[T,s,R]}),e[15]=i,e[16]=y,e[17]=s,e[18]=a):a=e[18];let x;return e[19]!==b||e[20]!==w||e[21]!==P||e[22]!==m||e[23]!==p||e[24]!==a?(x=h.jsx(Xr,{children:h.jsx(ro,{align:b,alignItemWithTrigger:w,alignOffset:P,className:"isolate z-50",side:m,sideOffset:p,children:a})}),e[19]=b,e[20]=w,e[21]=P,e[22]=m,e[23]=p,e[24]=a,e[25]=x):x=e[25],x}function Pt(t){const e=We.c(13);let n,o,i;e[0]!==t?({className:o,children:n,...i}=t,e[0]=t,e[1]=n,e[2]=o,e[3]=i):(n=e[1],o=e[2],i=e[3]);let r;e[4]!==o?(r=$e("relative flex min-h-7 w-full cursor-default select-none items-center gap-2 rounded-md px-2 py-1 text-xs/relaxed outline-hidden focus:bg-accent focus:text-accent-foreground not-data-[variant=destructive]:focus:**:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg:not([class*='size-'])]:size-3.5 [&_svg]:pointer-events-none [&_svg]:shrink-0 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",o),e[4]=o,e[5]=r):r=e[5];let c;e[6]!==n?(c=h.jsx(Ro,{className:"flex flex-1 shrink-0 gap-2 whitespace-nowrap",children:n}),e[6]=n,e[7]=c):c=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=h.jsx(yo,{render:h.jsx("span",{className:"pointer-events-none absolute right-2 flex items-center justify-center"}),children:h.jsx(br,{className:"pointer-events-none"})}),e[8]=u):u=e[8];let f;return e[9]!==i||e[10]!==r||e[11]!==c?(f=h.jsxs(xo,{className:r,"data-slot":"select-item",...i,children:[c,u]}),e[9]=i,e[10]=r,e[11]=c,e[12]=f):f=e[12],f}function Io(t){const e=We.c(9);let n,o;e[0]!==t?({className:n,...o}=t,e[0]=t,e[1]=n,e[2]=o):(n=e[1],o=e[2]);let i;e[3]!==n?(i=$e("top-0 z-10 flex w-full cursor-default items-center justify-center bg-popover py-1 [&_svg:not([class*='size-'])]:size-3.5",n),e[3]=n,e[4]=i):i=e[4];let r;e[5]===Symbol.for("react.memo_cache_sentinel")?(r=h.jsx(Ir,{}),e[5]=r):r=e[5];let c;return e[6]!==o||e[7]!==i?(c=h.jsx(So,{className:i,"data-slot":"select-scroll-up-button",...o,children:r}),e[6]=o,e[7]=i,e[8]=c):c=e[8],c}function vo(t){const e=We.c(9);let n,o;e[0]!==t?({className:n,...o}=t,e[0]=t,e[1]=n,e[2]=o):(n=e[1],o=e[2]);let i;e[3]!==n?(i=$e("bottom-0 z-10 flex w-full cursor-default items-center justify-center bg-popover py-1 [&_svg:not([class*='size-'])]:size-3.5",n),e[3]=n,e[4]=i):i=e[4];let r;e[5]===Symbol.for("react.memo_cache_sentinel")?(r=h.jsx(pn,{}),e[5]=r):r=e[5];let c;return e[6]!==o||e[7]!==i?(c=h.jsx(wo,{className:i,"data-slot":"select-scroll-down-button",...o,children:r}),e[6]=o,e[7]=i,e[8]=c):c=e[8],c}const To=["sg-placeholder"],Mo="subnet-placeholder";function Do(){const t=sr(),{data:e}=St(ir),{data:n}=St(lr),{data:o}=St(cr),i=Rr(),r=e.Images??[],c=n.KeyPairs??[],u=o.InstanceTypes?.flatMap(I=>I.InstanceType?[I.InstanceType]:[])??[],f=o.InstanceTypes?.reduce((I,O)=>{const N=O.InstanceType;return N&&(I[N]=(I[N]||0)+1),I},{})??{},d=Object.keys(f).sort(),m=r[0]?.ImageId,p=c[0]?.KeyName,b=d.find(I=>I.endsWith(".nano"))??d[0],{control:P,handleSubmit:w,register:y,watch:T,formState:{errors:s,isSubmitting:R}}=mr({resolver:gr(ar.refine(I=>I.count<=(f[I.instanceType]??1),{message:"Cannot exceed available capacity",path:["count"]})),defaultValues:{count:1,imageId:m??"",keyName:p??"",instanceType:b??""}}),a=T("instanceType"),x=a?f[a]??1:1,E=async I=>{await i.mutateAsync({...I,securityGroupIds:To,subnetId:Mo}),t({to:"/ec2/describe-instances"})};return h.jsxs(h.Fragment,{children:[h.jsx(xr,{to:"/ec2/describe-instances",children:"Back to instances"}),h.jsx(yr,{title:"Run EC2 Instances"}),u.length===0&&h.jsx(Gt,{msg:"No compute available. No new instances can be created until compute is available."}),i.error&&h.jsx(Gt,{error:i.error,msg:"Failed to create instance"}),h.jsxs("form",{className:"max-w-4xl space-y-6",onSubmit:w(E),children:[h.jsxs(ot,{children:[h.jsx(st,{children:h.jsx("label",{htmlFor:"imageId",children:"Image"})}),h.jsx(wt,{control:P,name:"imageId",render:({field:I})=>{const O=r.find(N=>N.ImageId===I.value);return h.jsxs(Mt,{onValueChange:N=>I.onChange(N),value:I.value??"",children:[h.jsx(Et,{"aria-invalid":!!s.imageId,className:"w-full",id:"imageId",children:h.jsx(Ct,{children:O?`${O.Name||"Unnamed"} (${O.Architecture})`:""})}),h.jsx(At,{children:r.map(N=>h.jsxs(Pt,{value:N.ImageId??"",children:[N.Name||"Unnamed"," (",N.Architecture,")"]},N.ImageId))})]})}}),h.jsx(it,{errors:[s.imageId]})]}),h.jsxs(ot,{children:[h.jsx(st,{children:h.jsx("label",{htmlFor:"instanceType",children:"Instance Type"})}),h.jsx(wt,{control:P,name:"instanceType",render:({field:I})=>h.jsxs(Mt,{onValueChange:O=>I.onChange(O),value:I.value?I.value:"",children:[h.jsx(Et,{"aria-invalid":!!s.instanceType,className:"w-full",id:"instanceType",children:h.jsx(Ct,{})}),h.jsx(At,{children:d.map(O=>h.jsxs(Pt,{value:O,children:[O," (",f[O]," available)"]},O))})]})}),h.jsx(it,{errors:[s.instanceType]})]}),h.jsxs(ot,{children:[h.jsx(st,{children:h.jsx("label",{htmlFor:"keyName",children:"Key Pair"})}),h.jsx(wt,{control:P,name:"keyName",render:({field:I})=>h.jsxs(Mt,{onValueChange:O=>I.onChange(O),value:I.value?I.value:"",children:[h.jsx(Et,{"aria-invalid":!!s.keyName,className:"w-full",id:"keyName",children:h.jsx(Ct,{})}),h.jsx(At,{children:c.map(O=>h.jsx(Pt,{value:O.KeyName??"",children:O.KeyName},O.KeyPairId))})]})}),h.jsx(it,{errors:[s.keyName]})]}),h.jsxs(ot,{children:[h.jsx(st,{children:h.jsx("label",{htmlFor:"count",children:"Number of Instances"})}),h.jsx(hr,{"aria-invalid":!!s.count,id:"count",type:"number",...y("count",{valueAsNumber:!0})}),h.jsx("p",{className:"text-muted-foreground text-xs",id:"count-description",children:a&&`Available capacity for ${a}: ${x}`}),h.jsx(it,{errors:[s.count]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(qt,{disabled:R||i.isPending,onClick:()=>t({to:"/ec2/describe-instances"}),type:"button",variant:"outline",children:"Cancel"}),h.jsx(qt,{disabled:R||i.isPending||u.length===0,type:"submit",children:R||i.isPending?"Creating…":"Create Instance"})]})]})]})}export{Do as component};
