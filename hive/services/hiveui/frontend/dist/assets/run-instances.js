import{g as Jt,A as jt,k as Re,l as Je,m as Fe,n as Ue,o as Ut,r as l,p as Zt,q as He,t as Bt,v as In,w as xe,x as ht,y as Tn,E as en,z as tn,C as De,D as Mn,F as Cn,G as Y,H as En,I as de,J as An,K as _t,L as Pn,M as Ge,N as xt,P as zt,Q as On,R as nn,S as Nn,T as Vn,U as At,V as ut,j as y,W as q,X as Lt,Y as kn,Z as Pt,_ as jn,$ as N,a0 as Ln,a1 as ft,a2 as Dn,a3 as Hn,a4 as Fn,a5 as rn,a6 as sn,a7 as Un,a8 as Bn,a9 as Dt,aa as on,ab as Ve,ac as Ot,ad as _n,ae as zn,af as Wn,ag as Kn,ah as $n,ai as qn,aj as Yn,ak as Gn,al as Xn,am as ln,an as Wt,ao as Qn,ap as Jn,aq as Zn,ar as er,as as cn,at as tr,au as nr,av as yt,c as Ke,a as $e,u as rr,aw as sr,ax as or,ay as ir,az as lr,B as Kt}from"./index.js";import{b as cr,c as an,d as un,e as $t,f as ar,g as ur,h as fr,u as dr,a as pr,C as bt,I as mr}from"./zod.js";import{u as Rt}from"./useSuspenseQuery.js";import{B as gr}from"./back-link.js";import{E as qt,L as st}from"./error-banner.js";import{P as hr}from"./page-heading.js";import{C as xr}from"./check.js";import{b as yr}from"./ec2.js";import"./useMutation.js";const br=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],fn=Jt("chevron-down",br);const Rr=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],wr=Jt("chevron-up",Rr);function ot(t,e,n){return Math.floor(t/e)!==n}function Xe(t,e){return e<0||e>=t.current.length}function wt(t,e){return he(t,{disabledIndices:e})}function Yt(t,e){return he(t,{decrement:!0,startingIndex:t.current.length,disabledIndices:e})}function he(t,{startingIndex:e=-1,decrement:n=!1,disabledIndices:s,amount:o=1}={}){let r=e;do r+=n?-o:o;while(r>=0&&r<=t.current.length-1&&Qe(t,r,s));return r}function Sr(t,{event:e,orientation:n,loopFocus:s,rtl:o,cols:r,disabledIndices:a,minIndex:u,maxIndex:d,prevIndex:m,stopEvent:g=!1}){let p=m;const b=[],A={};let R=!1;{let c=null,w=-1;t.current.forEach((i,f)=>{if(i==null)return;const v=i.closest('[role="row"]');v&&(R=!0),(v!==c||w===-1)&&(c=v,w+=1,b[w]=[]),b[w].push(f),A[f]=w})}const x=R&&b.length>0&&b.some(c=>c.length!==r);function T(c){if(!x||m===-1)return;const w=A[m];if(w==null)return;const i=b[w].indexOf(m);let f=c==="up"?w-1:w+1;s&&(f<0?f=b.length-1:f>=b.length&&(f=0));const v=new Set;for(;f>=0&&f<b.length&&!v.has(f);){v.add(f);const V=b[f];if(V.length===0){f=c==="up"?f-1:f+1;continue}const B=Math.min(i,V.length-1);for(let k=B;k>=0;k-=1){const re=V[k];if(!Qe(t,re,a))return re}f=c==="up"?f-1:f+1,s&&(f<0?f=b.length-1:f>=b.length&&(f=0))}}if(e.key===jt){const c=T("up");if(c!==void 0)g&&Re(e),p=c;else{if(g&&Re(e),m===-1)p=d;else if(p=he(t,{startingIndex:p,amount:r,decrement:!0,disabledIndices:a}),s&&(m-r<u||p<0)){const w=m%r,i=d%r,f=d-(i-w);i===w?p=d:p=i>w?f:f-r}Xe(t,p)&&(p=m)}}if(e.key===Je){const c=T("down");c!==void 0?(g&&Re(e),p=c):(g&&Re(e),m===-1?p=u:(p=he(t,{startingIndex:m,amount:r,disabledIndices:a}),s&&m+r>d&&(p=he(t,{startingIndex:m%r-r,amount:r,disabledIndices:a}))),Xe(t,p)&&(p=m))}if(n==="both"){const c=Ut(m/r);e.key===(o?Fe:Ue)&&(g&&Re(e),m%r!==r-1?(p=he(t,{startingIndex:m,disabledIndices:a}),s&&ot(p,r,c)&&(p=he(t,{startingIndex:m-m%r-1,disabledIndices:a}))):s&&(p=he(t,{startingIndex:m-m%r-1,disabledIndices:a})),ot(p,r,c)&&(p=m)),e.key===(o?Ue:Fe)&&(g&&Re(e),m%r!==0?(p=he(t,{startingIndex:m,decrement:!0,disabledIndices:a}),s&&ot(p,r,c)&&(p=he(t,{startingIndex:m+(r-m%r),decrement:!0,disabledIndices:a}))):s&&(p=he(t,{startingIndex:m+(r-m%r),decrement:!0,disabledIndices:a})),ot(p,r,c)&&(p=m));const w=Ut(d/r)===c;Xe(t,p)&&(s&&w?p=e.key===(o?Ue:Fe)?d:he(t,{startingIndex:m-m%r-1,disabledIndices:a}):p=m)}return p}function vr(t,e,n){const s=[];let o=0;return t.forEach(({width:r,height:a},u)=>{let d=!1;for(n&&(o=0);!d;){const m=[];for(let g=0;g<r;g+=1)for(let p=0;p<a;p+=1)m.push(o+g+p*e);o%e+r<=e&&m.every(g=>s[g]==null)?(m.forEach(g=>{s[g]=u}),d=!0):o+=1}}),[...s]}function Ir(t,e,n,s,o){if(t===-1)return-1;const r=n.indexOf(t),a=e[t];switch(o){case"tl":return r;case"tr":return a?r+a.width-1:r;case"bl":return a?r+(a.height-1)*s:r;case"br":return n.lastIndexOf(t);default:return-1}}function Tr(t,e){return e.flatMap((n,s)=>t.includes(n)?[s]:[])}function Qe(t,e,n){if(typeof n=="function")return n(e);if(n)return n.includes(e);const s=t.current[e];return s?s.hasAttribute("disabled")||s.getAttribute("aria-disabled")==="true":!1}function Mr(t,e={}){const n="rootStore"in t?t.rootStore:t,s=n.context.dataRef,{enabled:o=!0,event:r="click",toggle:a=!0,ignoreMouse:u=!1,stickIfOpen:d=!0,touchOpenDelay:m=0}=e,g=l.useRef(void 0),p=Zt(),b=He(),A=l.useMemo(()=>({onPointerDown(R){g.current=R.pointerType},onMouseDown(R){const x=g.current,T=R.nativeEvent,c=n.select("open");if(R.button!==0||r==="click"||Bt(x,!0)&&u)return;const w=s.current.openEvent,i=w?.type,f=n.select("domReferenceElement")!==R.currentTarget,v=c&&f||!(c&&a&&(!(w&&d)||i==="click"||i==="mousedown"));if(Tn(T.target)){const B=xe(ht,T,T.target);v&&x==="touch"&&m>0?b.start(m,()=>{n.setOpen(!0,B)}):n.setOpen(v,B);return}const V=R.currentTarget;p.request(()=>{const B=xe(ht,T,V);v&&x==="touch"&&m>0?b.start(m,()=>{n.setOpen(!0,B)}):n.setOpen(v,B)})},onClick(R){if(r==="mousedown-only")return;const x=g.current;if(r==="mousedown"&&x){g.current=void 0;return}if(Bt(x,!0)&&u)return;const T=n.select("open"),c=s.current.openEvent,w=n.select("domReferenceElement")!==R.currentTarget,i=T&&w||!(T&&a&&(!(c&&d)||In(c))),f=xe(ht,R.nativeEvent,R.currentTarget);i&&x==="touch"&&m>0?b.start(m,()=>{n.setOpen(!0,f)}):n.setOpen(i,f)},onKeyDown(){g.current=void 0}}),[s,r,u,n,d,a,p,b,m]);return l.useMemo(()=>o?{reference:A}:en,[o,A])}const Cr="Escape";function dt(t,e,n){switch(t){case"vertical":return e;case"horizontal":return n;default:return e||n}}function it(t,e){return dt(e,t===jt||t===Je,t===Fe||t===Ue)}function St(t,e,n){return dt(e,t===Je,n?t===Fe:t===Ue)||t==="Enter"||t===" "||t===""}function Er(t,e,n){return dt(e,n?t===Fe:t===Ue,t===Je)}function Ar(t,e,n,s){const o=n?t===Ue:t===Fe,r=t===jt;return e==="both"||e==="horizontal"&&s&&s>1?t===Cr:dt(e,o,r)}function Pr(t,e){const n="rootStore"in t?t.rootStore:t,s=n.useState("open"),o=n.useState("floatingElement"),r=n.useState("domReferenceElement"),a=n.context.dataRef,{listRef:u,activeIndex:d,onNavigate:m=()=>{},enabled:g=!0,selectedIndex:p=null,allowEscape:b=!1,loopFocus:A=!1,nested:R=!1,rtl:x=!1,virtual:T=!1,focusItemOnOpen:c="auto",focusItemOnHover:w=!0,openOnArrowKeyDown:i=!0,disabledIndices:f=void 0,orientation:v="vertical",parentOrientation:V,cols:B=1,scrollItemIntoView:k=!0,itemSizes:re,dense:ae=!1,id:W,resetOnPointerLeave:K=!0,externalTree:z}=e,L=tn(o),ee=De(L),F=Mn(),te=Cn(z);Y(()=>{a.current.orientation=v},[a,v]);const I=En(r),U=l.useRef(c),S=l.useRef(p??-1),E=l.useRef(null),ie=l.useRef(!0),M=de(h=>{m(S.current===-1?null:S.current,h)}),oe=l.useRef(M),G=l.useRef(!!o),O=l.useRef(s),_=l.useRef(!1),ue=l.useRef(!1),ve=De(f),H=De(s),fe=De(k),X=De(p),me=De(K),we=de(()=>{function h(Z){T?te?.events.emit("virtualfocus",Z):An(Z,{sync:_.current,preventScroll:!0})}const j=u.current[S.current],C=ue.current;j&&h(j),(_.current?Z=>Z():requestAnimationFrame)(()=>{const Z=u.current[S.current]||j;if(!Z)return;j||h(Z);const le=fe.current;le&&Q&&(C||!ie.current)&&Z.scrollIntoView?.(typeof le=="boolean"?{block:"nearest",inline:"nearest"}:le)})});Y(()=>{g&&(s&&o?(S.current=p??-1,U.current&&p!=null&&(ue.current=!0,M())):G.current&&(S.current=-1,oe.current()))},[g,s,o,p,M]),Y(()=>{if(g){if(!s){_.current=!1;return}if(o)if(d==null){if(_.current=!1,X.current!=null)return;if(G.current&&(S.current=-1,we()),(!O.current||!G.current)&&U.current&&(E.current!=null||U.current===!0&&E.current==null)){let h=0;const j=()=>{u.current[0]==null?(h<2&&(h?requestAnimationFrame:queueMicrotask)(j),h+=1):(S.current=E.current==null||St(E.current,v,x)||R?wt(u):Yt(u),E.current=null,M())};j()}}else Xe(u,d)||(S.current=d,we(),ue.current=!1)}},[g,s,o,d,X,R,u,v,x,M,we,ve]),Y(()=>{if(!g||o||!te||T||!G.current)return;const h=te.nodesRef.current,j=h.find(Z=>Z.id===F)?.context?.elements.floating,C=_t(Pn(o)),$=h.some(Z=>Z.context&&Ge(Z.context.elements.floating,C));j&&!$&&ie.current&&j.focus({preventScroll:!0})},[g,o,te,F,T]),Y(()=>{oe.current=M,O.current=s,G.current=!!o}),Y(()=>{s||(E.current=null,U.current=c)},[s,c]);const pe=d!=null,Q=l.useMemo(()=>{function h(C){if(!H.current)return;const $=u.current.indexOf(C.currentTarget);$!==-1&&S.current!==$&&(S.current=$,M(C))}return{onFocus(C){_.current=!0,h(C)},onClick:({currentTarget:C})=>C.focus({preventScroll:!0}),onMouseMove(C){_.current=!0,ue.current=!1,w&&h(C)},onPointerLeave(C){if(!H.current||!ie.current||C.pointerType==="touch")return;_.current=!0;const $=C.relatedTarget;!w||u.current.includes($)||me.current&&(S.current=-1,M(C),T||ee.current?.focus({preventScroll:!0}))}}},[H,ee,w,u,M,me,T]),J=l.useCallback(()=>V??te?.nodesRef.current.find(h=>h.id===F)?.context?.dataRef?.current.orientation,[F,te,V]),ye=de(h=>{if(ie.current=!1,_.current=!0,h.which===229||!H.current&&h.currentTarget===ee.current)return;if(R&&Ar(h.key,v,x,B)){it(h.key,J())||Re(h),n.setOpen(!1,xe(xt,h.nativeEvent)),zt(r)&&(T?te?.events.emit("virtualfocus",r):r.focus());return}const j=S.current,C=wt(u,f),$=Yt(u,f);if(I||(h.key==="Home"&&(Re(h),S.current=C,M(h)),h.key==="End"&&(Re(h),S.current=$,M(h))),B>1){const Z=re||Array.from({length:u.current.length},()=>({width:1,height:1})),le=vr(Z,B,ae),ge=le.findIndex(Se=>Se!=null&&!Qe(u,Se,f)),be=le.reduce((Se,Me,Le)=>Me!=null&&!Qe(u,Me,f)?Le:Se,-1),je=le[Sr({current:le.map(Se=>Se!=null?u.current[Se]:null)},{event:h,orientation:v,loopFocus:A,rtl:x,cols:B,disabledIndices:Tr([...(typeof f!="function"?f:null)||u.current.map((Se,Me)=>Qe(u,Me,f)?Me:void 0),void 0],le),minIndex:ge,maxIndex:be,prevIndex:Ir(S.current>$?C:S.current,Z,le,B,h.key===Je?"bl":h.key===(x?Fe:Ue)?"tr":"tl"),stopEvent:!0})];if(je!=null&&(S.current=je,M(h)),v==="both")return}if(it(h.key,v)){if(Re(h),s&&!T&&_t(h.currentTarget.ownerDocument)===h.currentTarget){S.current=St(h.key,v,x)?C:$,M(h);return}St(h.key,v,x)?A?j>=$?b&&j!==u.current.length?S.current=-1:(_.current=!1,S.current=C):S.current=he(u,{startingIndex:j,disabledIndices:f}):S.current=Math.min($,he(u,{startingIndex:j,disabledIndices:f})):A?j<=C?b&&j!==-1?S.current=u.current.length:(_.current=!1,S.current=$):S.current=he(u,{startingIndex:j,decrement:!0,disabledIndices:f}):S.current=Math.max(C,he(u,{startingIndex:j,decrement:!0,disabledIndices:f})),Xe(u,S.current)&&(S.current=-1),M(h)}}),se=l.useMemo(()=>T&&s&&pe&&{"aria-activedescendant":`${W}-${d}`},[T,s,pe,W,d]),ne=l.useMemo(()=>({"aria-orientation":v==="both"?void 0:v,...I?{}:se,onKeyDown(h){if(h.key==="Tab"&&h.shiftKey&&s&&!T){const j=On(h.nativeEvent);if(j&&!Ge(ee.current,j))return;Re(h),n.setOpen(!1,xe(nn,h.nativeEvent)),zt(r)&&r.focus();return}ye(h)},onPointerMove(){ie.current=!0}}),[se,ye,ee,v,I,n,s,T,r]),Te=l.useMemo(()=>{function h(C){c==="auto"&&Nn(C.nativeEvent)&&(U.current=!T)}function j(C){U.current=c,c==="auto"&&Vn(C.nativeEvent)&&(U.current=!0)}return{onKeyDown(C){const $=n.select("open");ie.current=!1;const Z=C.key.startsWith("Arrow"),le=Er(C.key,J(),x),ge=it(C.key,v),be=(R?le:ge)||C.key==="Enter"||C.key.trim()==="";if(T&&$)return ye(C);if(!(!$&&!i&&Z)){if(be){const je=it(C.key,J());E.current=R&&je?null:C.key}if(R){le&&(Re(C),$?(S.current=wt(u,ve.current),M(C)):n.setOpen(!0,xe(xt,C.nativeEvent,C.currentTarget)));return}ge&&(X.current!=null&&(S.current=X.current),Re(C),!$&&i?n.setOpen(!0,xe(xt,C.nativeEvent,C.currentTarget)):ye(C),$&&M(C))}},onFocus(C){n.select("open")&&!T&&(S.current=-1,M(C))},onPointerDown:j,onPointerEnter:j,onMouseDown:h,onClick:h}},[ye,ve,c,u,R,M,n,i,v,J,x,X,T]),Ae=l.useMemo(()=>({...se,...Te}),[se,Te]);return l.useMemo(()=>g?{reference:Ae,floating:ne,item:Q,trigger:Te}:{},[g,Ae,ne,Te,Q])}function Or(t,e){const n="rootStore"in t?t.rootStore:t,s=n.useState("open"),o=n.context.dataRef,{listRef:r,activeIndex:a,onMatch:u,onTypingChange:d,enabled:m=!0,findMatch:g=null,resetMs:p=750,ignoreKeys:b=At,selectedIndex:A=null}=e,R=He(),x=l.useRef(""),T=l.useRef(A??a??-1),c=l.useRef(null);Y(()=>{s&&(R.clear(),c.current=null,x.current="")},[s,R]),Y(()=>{s&&x.current===""&&(T.current=A??a??-1)},[s,A,a]);const w=de(V=>{V?o.current.typing||(o.current.typing=V,d?.(V)):o.current.typing&&(o.current.typing=V,d?.(V))}),i=de(V=>{function B(K,z,L){const ee=g?g(z,L):z.find(F=>F?.toLocaleLowerCase().indexOf(L.toLocaleLowerCase())===0);return ee?K.indexOf(ee):-1}const k=r.current;if(x.current.length>0&&x.current[0]!==" "&&(B(k,k,x.current)===-1?w(!1):V.key===" "&&Re(V)),k==null||b.includes(V.key)||V.key.length!==1||V.ctrlKey||V.metaKey||V.altKey)return;s&&V.key!==" "&&(Re(V),w(!0)),k.every(K=>K?K[0]?.toLocaleLowerCase()!==K[1]?.toLocaleLowerCase():!0)&&x.current===V.key&&(x.current="",T.current=c.current),x.current+=V.key,R.start(p,()=>{x.current="",T.current=c.current,w(!1)});const ae=T.current,W=B(k,[...k.slice((ae||0)+1),...k.slice(0,(ae||0)+1)],x.current);W!==-1?(u?.(W),c.current=W):V.key!==" "&&(x.current="",w(!1))}),f=l.useMemo(()=>({onKeyDown:i}),[i]),v=l.useMemo(()=>({onKeyDown:i,onKeyUp(V){V.key===" "&&w(!1)}}),[i,w]);return l.useMemo(()=>m?{reference:f,floating:v}:{},[m,f,v])}function Nr(t){const e=l.useRef(!0);e.current&&(e.current=!1,t())}const dn=l.createContext(null),pn=l.createContext(null);function ke(){const t=l.useContext(dn);if(t===null)throw new Error(ut(60));return t}function mn(){const t=l.useContext(pn);if(t===null)throw new Error(ut(61));return t}const Vr=(t,e)=>Object.is(t,e);function We(t,e,n){return t==null||e==null?Object.is(t,e):n(t,e)}function vt(t,e,n){return!t||t.length===0?!1:t.some(s=>s===void 0?!1:We(s,e,n))}function Nt(t,e,n){return!t||t.length===0?-1:t.findIndex(s=>s===void 0?!1:We(s,e,n))}function kr(t,e,n){return t.filter(s=>!We(s,e,n))}function Vt(t){if(t==null)return"";if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return String(t)}}function gn(t){return t!=null&&t.length>0&&typeof t[0]=="object"&&t[0]!=null&&"items"in t[0]}function jr(t){if(!Array.isArray(t))return t!=null&&!("null"in t);if(gn(t)){for(const e of t)for(const n of e.items)if(n&&n.value==null&&n.label!=null)return!0;return!1}for(const e of t)if(e&&e.value==null&&e.label!=null)return!0;return!1}function Lr(t,e){if(e&&t!=null)return e(t)??"";if(t&&typeof t=="object"){if("label"in t&&t.label!=null)return String(t.label);if("value"in t)return String(t.value)}return Vt(t)}function ze(t,e){return e&&t!=null?e(t)??"":t&&typeof t=="object"&&"value"in t&&"label"in t?Vt(t.value):Vt(t)}function hn(t,e,n){function s(){return Lr(t,n)}if(n&&t!=null)return n(t);if(t&&typeof t=="object"&&"label"in t&&t.label!=null)return t.label;if(e&&!Array.isArray(e))return e[t]??s();if(Array.isArray(e)){const o=gn(e)?e.flatMap(r=>r.items):e;if(t==null||typeof t!="object"){const r=o.find(a=>a.value===t);return r&&r.label!=null?r.label:s()}if("value"in t){const r=o.find(a=>a&&a.value===t.value);if(r&&r.label!=null)return r.label}}return s()}function Dr(t,e,n){return t.reduce((s,o,r)=>(r>0&&s.push(", "),s.push(y.jsx(l.Fragment,{children:hn(o,e,n)},r)),s),[])}const P={id:q(t=>t.id),modal:q(t=>t.modal),multiple:q(t=>t.multiple),items:q(t=>t.items),itemToStringLabel:q(t=>t.itemToStringLabel),itemToStringValue:q(t=>t.itemToStringValue),isItemEqualToValue:q(t=>t.isItemEqualToValue),value:q(t=>t.value),hasSelectedValue:q(t=>{const{value:e,multiple:n,itemToStringValue:s}=t;return e==null?!1:n&&Array.isArray(e)?e.length>0:ze(e,s)!==""}),hasNullItemLabel:q((t,e)=>e?jr(t.items):!1),open:q(t=>t.open),mounted:q(t=>t.mounted),forceMount:q(t=>t.forceMount),transitionStatus:q(t=>t.transitionStatus),openMethod:q(t=>t.openMethod),activeIndex:q(t=>t.activeIndex),selectedIndex:q(t=>t.selectedIndex),isActive:q((t,e)=>t.activeIndex===e),isSelected:q((t,e,n)=>{const s=t.isItemEqualToValue,o=t.value;return t.multiple?Array.isArray(o)&&o.some(r=>We(r,n,s)):t.selectedIndex===e&&t.selectedIndex!==null?!0:We(o,n,s)}),isSelectedByFocus:q((t,e)=>t.selectedIndex===e),popupProps:q(t=>t.popupProps),triggerProps:q(t=>t.triggerProps),triggerElement:q(t=>t.triggerElement),positionerElement:q(t=>t.positionerElement),listElement:q(t=>t.listElement),scrollUpArrowVisible:q(t=>t.scrollUpArrowVisible),scrollDownArrowVisible:q(t=>t.scrollDownArrowVisible),hasScrollArrows:q(t=>t.hasScrollArrows)};function Hr(t,e){const n=l.useRef(t),s=de(e);Y(()=>{n.current!==t&&s(n.current)},[t,s]),Y(()=>{n.current=t},[t])}function Fr(t){const{id:e,value:n,defaultValue:s=null,onValueChange:o,open:r,defaultOpen:a=!1,onOpenChange:u,name:d,disabled:m=!1,readOnly:g=!1,required:p=!1,modal:b=!0,actionsRef:A,inputRef:R,onOpenChangeComplete:x,items:T,multiple:c=!1,itemToStringLabel:w,itemToStringValue:i,isItemEqualToValue:f=Vr,highlightItemOnHover:v=!0,children:V}=t,{clearErrors:B}=cr(),{setDirty:k,setTouched:re,setFocused:ae,shouldValidateOnChange:W,validityData:K,setFilled:z,name:L,disabled:ee,validation:F,validationMode:te}=an(),I=un({id:e}),U=ee||m,S=L??d,[E,ie]=$t({controlled:n,default:c?s??At:s,name:"Select",state:"value"}),[M,oe]=$t({controlled:r,default:a,name:"Select",state:"open"}),G=l.useRef([]),O=l.useRef([]),_=l.useRef(null),ue=l.useRef(null),ve=l.useRef(0),H=l.useRef(null),fe=l.useRef([]),X=l.useRef(!1),me=l.useRef(!1),we=l.useRef(null),pe=l.useRef({allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}),Q=l.useRef(!1),{mounted:J,setMounted:ye,transitionStatus:se}=Lt(M),{openMethod:ne,triggerProps:Te,reset:Ae}=kn(M),h=Pt(()=>new jn({id:I,modal:b,multiple:c,itemToStringLabel:w,itemToStringValue:i,isItemEqualToValue:f,value:E,open:M,mounted:J,transitionStatus:se,items:T,forceMount:!1,openMethod:null,activeIndex:null,selectedIndex:null,popupProps:{},triggerProps:{},triggerElement:null,positionerElement:null,listElement:null,scrollUpArrowVisible:!1,scrollDownArrowVisible:!1,hasScrollArrows:!1})).current,j=N(h,P.activeIndex),C=N(h,P.selectedIndex),$=N(h,P.triggerElement),Z=N(h,P.positionerElement),le=l.useMemo(()=>c&&Array.isArray(E)&&E.length===0?"":ze(E,i),[c,E,i]),ge=l.useMemo(()=>c&&Array.isArray(E)?E.map(D=>ze(D,i)):ze(E,i),[c,E,i]),be=De(h.state.triggerElement);ar({id:I,commit:F.commit,value:E,controlRef:be,name:S,getValue:()=>ge});const je=l.useRef(E);Y(()=>{E!==je.current&&h.set("forceMount",!0)},[h,E]),Y(()=>{z(c?Array.isArray(E)&&E.length>0:E!=null)},[c,E,z]),Y(function(){if(M)return;const ce=fe.current;if(c){const Ee=Array.isArray(E)?E:[];if(Ee.length===0){h.set("selectedIndex",null);return}const Ie=Ee[Ee.length-1],rt=Nt(ce,Ie,f);h.set("selectedIndex",rt===-1?null:rt);return}const Ce=Nt(ce,E,f);h.set("selectedIndex",Ce===-1?null:Ce)},[c,M,E,fe,f,h]),Hr(E,()=>{B(S),k(E!==K.initialValue),W()?F.commit(E):F.commit(E,!0)});const Se=de((D,ce)=>{if(u?.(D,ce),!ce.isCanceled&&(oe(D),!D&&(ce.reason===nn||ce.reason===Ln)&&(re(!0),ae(!1),te==="onBlur"&&F.commit(E)),!D&&h.state.activeIndex!==null)){const Ce=G.current[h.state.activeIndex];queueMicrotask(()=>{Ce?.setAttribute("tabindex","-1")})}}),Me=de(()=>{ye(!1),h.set("activeIndex",null),Ae(),x?.(!1)});ft({enabled:!A,open:M,ref:_,onComplete(){M||Me()}}),l.useImperativeHandle(A,()=>({unmount:Me}),[Me]);const Le=de((D,ce)=>{o?.(D,ce),!ce.isCanceled&&ie(D)}),Pe=de(()=>{const D=h.state.listElement||_.current;if(!D)return;const ce=D.scrollTop,Ce=D.scrollTop+D.clientHeight,Ee=ce>1,Ie=Ce<D.scrollHeight-1;h.state.scrollUpArrowVisible!==Ee&&h.set("scrollUpArrowVisible",Ee),h.state.scrollDownArrowVisible!==Ie&&h.set("scrollDownArrowVisible",Ie)}),Oe=Dn({open:M,onOpenChange:Se,elements:{reference:$,floating:Z}}),Ze=Mr(Oe,{enabled:!g&&!U,event:"mousedown"}),qe=Hn(Oe,{bubbles:!1}),Ne=Pr(Oe,{enabled:!g&&!U,listRef:G,activeIndex:j,selectedIndex:C,disabledIndices:At,onNavigate(D){D===null&&!M||h.set("activeIndex",D)},focusItemOnHover:!1}),pt=Or(Oe,{enabled:!g&&!U&&(M||!c),listRef:O,activeIndex:j,selectedIndex:C,onMatch(D){M?h.set("activeIndex",D):Le(fe.current[D],xe("none"))},onTypingChange(D){X.current=D}}),{getReferenceProps:Be,getFloatingProps:_e,getItemProps:et}=Fn([Ze,qe,Ne,pt]),Ye=l.useMemo(()=>rn(Be(),Te,I?{id:I}:en),[Be,Te,I]);Nr(()=>{h.update({popupProps:_e(),triggerProps:Ye})}),Y(()=>{h.update({id:I,modal:b,multiple:c,value:E,open:M,mounted:J,transitionStatus:se,popupProps:_e(),triggerProps:Ye,items:T,itemToStringLabel:w,itemToStringValue:i,isItemEqualToValue:f,openMethod:ne})},[h,I,b,c,E,M,J,se,_e,Ye,T,w,i,f,ne]);const tt=l.useMemo(()=>({store:h,name:S,required:p,disabled:U,readOnly:g,multiple:c,itemToStringLabel:w,itemToStringValue:i,highlightItemOnHover:v,setValue:Le,setOpen:Se,listRef:G,popupRef:_,scrollHandlerRef:ue,handleScrollArrowVisibility:Pe,scrollArrowsMountedCountRef:ve,getItemProps:et,events:Oe.context.events,valueRef:H,valuesRef:fe,labelsRef:O,typingRef:X,selectionRef:pe,selectedItemTextRef:we,validation:F,onOpenChangeComplete:x,keyboardActiveRef:me,alignItemWithTriggerActiveRef:Q,initialValueRef:je}),[h,S,p,U,g,c,w,i,v,Le,Se,et,Oe.context.events,F,x,Pe]),nt=sn(R,F.inputRef),mt=c&&Array.isArray(E)&&E.length>0,gt=l.useMemo(()=>!c||!Array.isArray(E)||!S?null:E.map(D=>{const ce=ze(D,i);return y.jsx("input",{type:"hidden",name:S,value:ce},ce)}),[c,E,S,i]);return y.jsx(dn.Provider,{value:tt,children:y.jsxs(pn.Provider,{value:Oe,children:[V,y.jsx("input",{...F.getInputValidationProps({onFocus(){h.state.triggerElement?.focus({focusVisible:!0})},onChange(D){if(D.nativeEvent.defaultPrevented)return;const ce=D.target.value,Ce=xe(Dt,D.nativeEvent);function Ee(){if(c)return;const Ie=fe.current.find(rt=>ze(rt,i).toLowerCase()===ce.toLowerCase());Ie!=null&&(k(Ie!==K.initialValue),Le(Ie,Ce),W()&&F.commit(Ie))}h.set("forceMount",!0),queueMicrotask(Ee)}}),name:c?void 0:S,value:le,disabled:U,required:p&&!mt,readOnly:g,ref:nt,style:S?Un:Bn,tabIndex:-1,"aria-hidden":!0}),gt]})})}function Ur(t){const e=t.getBoundingClientRect(),n=window.getComputedStyle(t,"::before"),s=window.getComputedStyle(t,"::after");if(!(n.content!=="none"||s.content!=="none"))return e;const r=parseFloat(n.width)||0,a=parseFloat(n.height)||0,u=parseFloat(s.width)||0,d=parseFloat(s.height)||0,m=Math.max(e.width,r,u),g=Math.max(e.height,a,d),p=m-e.width,b=g-e.height;return{left:e.left-p/2,right:e.right+p/2,top:e.top-b/2,bottom:e.bottom+b/2}}const lt=2,Br=400,Gt=200,_r={...zn,...fr,value:()=>null},zr=l.forwardRef(function(e,n){const{render:s,className:o,id:r,disabled:a=!1,nativeButton:u=!0,...d}=e,{setTouched:m,setFocused:g,validationMode:p,state:b,disabled:A}=an(),{labelId:R}=ur(),{store:x,setOpen:T,selectionRef:c,validation:w,readOnly:i,required:f,alignItemWithTriggerActiveRef:v,disabled:V,keyboardActiveRef:B}=ke(),k=A||V||a,re=N(x,P.open),ae=N(x,P.value),W=N(x,P.triggerProps),K=N(x,P.positionerElement),z=N(x,P.listElement),L=N(x,P.id),ee=N(x,P.hasSelectedValue),F=!ee&&re,te=N(x,P.hasNullItemLabel,F),I=r??L;un({id:I});const U=De(K),S=l.useRef(null),{getButtonProps:E,buttonRef:ie}=on({disabled:k,native:u}),M=de(X=>{x.set("triggerElement",X)}),oe=sn(n,S,ie,M),G=He(),O=He(),_=He(),ue=He();l.useEffect(()=>{if(re)return!(ee||te)?_.start(Br,()=>{c.current.allowUnselectedMouseUp=!0,c.current.allowSelectedMouseUp=!0}):ue.start(Gt,()=>{c.current.allowUnselectedMouseUp=!0,_.start(Gt,()=>{c.current.allowSelectedMouseUp=!0})}),()=>{_.clear(),ue.clear()};c.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1},O.clear()},[re,ee,te,c,O,_,ue]);const ve=l.useMemo(()=>z?.id??tn(K)?.id,[z,K]),H=rn(W,{id:I,role:"combobox","aria-expanded":re?"true":"false","aria-haspopup":"listbox","aria-controls":re?ve:void 0,"aria-labelledby":R,"aria-readonly":i||void 0,"aria-required":f||void 0,tabIndex:k?-1:0,ref:oe,onFocus(X){g(!0),re&&v.current&&T(!1,xe(Dt,X.nativeEvent)),G.start(0,()=>{x.set("forceMount",!0)})},onBlur(X){Ge(K,X.relatedTarget)||(m(!0),g(!1),p==="onBlur"&&w.commit(ae))},onPointerMove(){B.current=!1},onKeyDown(){B.current=!0},onMouseDown(X){if(re)return;const me=Ot(X.currentTarget);function we(pe){if(!S.current)return;const Q=pe.target;if(Ge(S.current,Q)||Ge(U.current,Q)||Q===S.current)return;const J=Ur(S.current);pe.clientX>=J.left-lt&&pe.clientX<=J.right+lt&&pe.clientY>=J.top-lt&&pe.clientY<=J.bottom+lt||T(!1,xe(_n,pe))}O.start(0,()=>{me.addEventListener("mouseup",we,{once:!0})})}},w.getValidationProps,d,E);H.role="combobox";const fe=l.useMemo(()=>({...b,open:re,disabled:k,value:ae,readOnly:i,placeholder:!ee}),[b,re,k,ae,i,ee]);return Ve("button",e,{ref:[n,S],state:fe,stateAttributesMapping:_r,props:H})}),Wr={value:()=>null},Kr=l.forwardRef(function(e,n){const{className:s,render:o,children:r,placeholder:a,...u}=e,{store:d,valueRef:m}=ke(),g=N(d,P.value),p=N(d,P.items),b=N(d,P.itemToStringLabel),A=N(d,P.hasSelectedValue),R=!A&&a!=null&&r==null,x=N(d,P.hasNullItemLabel,R),T=l.useMemo(()=>({value:g,placeholder:!A}),[g,A]);let c=null;return typeof r=="function"?c=r(g):r!=null?c=r:!A&&a!=null&&!x?c=a:Array.isArray(g)?c=Dr(g,p,b):c=hn(g,p,b),Ve("span",e,{state:T,ref:[n,m],props:[{children:c},u],stateAttributesMapping:Wr})}),$r=l.forwardRef(function(e,n){const{className:s,render:o,...r}=e,{store:a}=ke(),u=N(a,P.open),d=l.useMemo(()=>({open:u}),[u]);return Ve("span",e,{state:d,ref:n,props:[{"aria-hidden":!0,children:"▼"},r],stateAttributesMapping:Wn})}),qr=l.createContext(void 0),Yr=l.forwardRef(function(e,n){const{store:s}=ke(),o=N(s,P.mounted),r=N(s,P.forceMount);return o||r?y.jsx(qr.Provider,{value:!0,children:y.jsx(Kn,{ref:n,...e})}):null}),xn=l.createContext({register:()=>{},unregister:()=>{},subscribeMapChange:()=>()=>{},elementsRef:{current:[]},nextIndexRef:{current:0}});function Gr(){return l.useContext(xn)}function Xr(t){const{children:e,elementsRef:n,labelsRef:s,onMapChange:o}=t,r=de(o),a=l.useRef(0),u=Pt(Jr).current,d=Pt(Qr).current,[m,g]=l.useState(0),p=l.useRef(m),b=de((c,w)=>{d.set(c,w??null),p.current+=1,g(p.current)}),A=de(c=>{d.delete(c),p.current+=1,g(p.current)}),R=l.useMemo(()=>{const c=new Map;return Array.from(d.keys()).filter(i=>i.isConnected).sort(Zr).forEach((i,f)=>{const v=d.get(i)??{};c.set(i,{...v,index:f})}),c},[d,m]);Y(()=>{if(typeof MutationObserver!="function"||R.size===0)return;const c=new MutationObserver(w=>{const i=new Set,f=v=>i.has(v)?i.delete(v):i.add(v);w.forEach(v=>{v.removedNodes.forEach(f),v.addedNodes.forEach(f)}),i.size===0&&(p.current+=1,g(p.current))});return R.forEach((w,i)=>{i.parentElement&&c.observe(i.parentElement,{childList:!0})}),()=>{c.disconnect()}},[R]),Y(()=>{p.current===m&&(n.current.length!==R.size&&(n.current.length=R.size),s&&s.current.length!==R.size&&(s.current.length=R.size),a.current=R.size),r(R)},[r,R,n,s,m]),Y(()=>()=>{n.current=[]},[n]),Y(()=>()=>{s&&(s.current=[])},[s]);const x=de(c=>(u.add(c),()=>{u.delete(c)}));Y(()=>{u.forEach(c=>c(R))},[u,R]);const T=l.useMemo(()=>({register:b,unregister:A,subscribeMapChange:x,elementsRef:n,labelsRef:s,nextIndexRef:a}),[b,A,x,n,s,a]);return y.jsx(xn.Provider,{value:T,children:e})}function Qr(){return new Map}function Jr(){return new Set}function Zr(t,e){const n=t.compareDocumentPosition(e);return n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS?1:0}const yn=l.createContext(void 0);function Ht(){const t=l.useContext(yn);if(!t)throw new Error(ut(59));return t}function at(t,e){t&&Object.assign(t.style,e)}const bn={position:"relative",maxHeight:"100%",overflowX:"hidden",overflowY:"auto"},es={position:"fixed"},ts=l.forwardRef(function(e,n){const{anchor:s,positionMethod:o="absolute",className:r,render:a,side:u="bottom",align:d="center",sideOffset:m=0,alignOffset:g=0,collisionBoundary:p="clipping-ancestors",collisionPadding:b,arrowPadding:A=5,sticky:R=!1,disableAnchorTracking:x,alignItemWithTrigger:T=!0,collisionAvoidance:c=$n,...w}=e,{store:i,listRef:f,labelsRef:v,alignItemWithTriggerActiveRef:V,selectedItemTextRef:B,valuesRef:k,initialValueRef:re,popupRef:ae,setValue:W}=ke(),K=mn(),z=N(i,P.open),L=N(i,P.mounted),ee=N(i,P.modal),F=N(i,P.value),te=N(i,P.openMethod),I=N(i,P.positionerElement),U=N(i,P.triggerElement),S=N(i,P.isItemEqualToValue),E=l.useRef(null),ie=l.useRef(null),[M,oe]=l.useState(T),G=L&&M&&te!=="touch";!L&&M!==T&&oe(T),Y(()=>{L||(P.scrollUpArrowVisible(i.state)&&i.set("scrollUpArrowVisible",!1),P.scrollDownArrowVisible(i.state)&&i.set("scrollDownArrowVisible",!1))},[i,L]),l.useImperativeHandle(V,()=>G),qn((G||ee)&&z&&te!=="touch",U);const O=Yn({anchor:s,floatingRootContext:K,positionMethod:o,mounted:L,side:u,sideOffset:m,align:d,alignOffset:g,arrowPadding:A,collisionBoundary:p,collisionPadding:b,sticky:R,disableAnchorTracking:x??G,collisionAvoidance:c,keepMounted:!0}),_=G?"none":O.side,ue=G?es:O.positionerStyles,ve=l.useMemo(()=>{const Q={};return z||(Q.pointerEvents="none"),{role:"presentation",hidden:!L,style:{...ue,...Q}}},[z,L,ue]),H=l.useMemo(()=>({open:z,side:_,align:O.align,anchorHidden:O.anchorHidden}),[z,_,O.align,O.anchorHidden]),fe=de(Q=>{i.set("positionerElement",Q)}),X=Ve("div",e,{ref:[n,fe],state:H,stateAttributesMapping:ln,props:[ve,w]}),me=l.useRef(0),we=de(Q=>{if(Q.size===0&&me.current===0||k.current.length===0)return;const J=me.current;if(me.current=Q.size,Q.size===J)return;const ye=xe(Dt);if(J!==0&&!i.state.multiple&&F!==null&&Nt(k.current,F,S)===-1){const ne=re.current,Ae=ne!=null&&vt(k.current,ne,S)?ne:null;W(Ae,ye),Ae===null&&(i.set("selectedIndex",null),B.current=null)}if(J!==0&&i.state.multiple&&Array.isArray(F)){const se=F.filter(ne=>vt(k.current,ne,S));(se.length!==F.length||se.some(ne=>!vt(F,ne,S)))&&(W(se,ye),se.length===0&&(i.set("selectedIndex",null),B.current=null))}if(z&&G){i.update({scrollUpArrowVisible:!1,scrollDownArrowVisible:!1});const se={height:""};at(I,se),at(ae.current,se)}}),pe=l.useMemo(()=>({...O,side:_,alignItemWithTriggerActive:G,setControlledAlignItemWithTrigger:oe,scrollUpArrowRef:E,scrollDownArrowRef:ie}),[O,_,G,oe]);return y.jsx(Xr,{elementsRef:f,labelsRef:v,onMapChange:we,children:y.jsxs(yn.Provider,{value:pe,children:[L&&ee&&y.jsx(Gn,{inert:Xn(!z),cutout:U}),X]})})});function Rn(t){const e=t.currentTarget.getBoundingClientRect();return e.top+1<=t.clientY&&t.clientY<=e.bottom-1&&e.left+1<=t.clientX&&t.clientX<=e.right-1}const ct="base-ui-disable-scrollbar",kt={className:ct,getElement(t){return y.jsx("style",{nonce:t,href:ct,precedence:"base-ui:low",children:`.${ct}{scrollbar-width:none}.${ct}::-webkit-scrollbar{display:none}`})}},ns=l.createContext(void 0);function rs(t){return l.useContext(ns)}function ss(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const os=l.createContext(void 0),is={disableStyleElements:!1};function ls(){return l.useContext(os)??is}const cs={...ln,...cn},as=l.forwardRef(function(e,n){const{render:s,className:o,...r}=e,{store:a,popupRef:u,onOpenChangeComplete:d,setOpen:m,valueRef:g,selectedItemTextRef:p,keyboardActiveRef:b,multiple:A,handleScrollArrowVisibility:R,scrollHandlerRef:x,highlightItemOnHover:T}=ke(),{side:c,align:w,alignItemWithTriggerActive:i,setControlledAlignItemWithTrigger:f,scrollDownArrowRef:v,scrollUpArrowRef:V}=Ht(),B=rs()!=null,k=mn(),{nonce:re,disableStyleElements:ae}=ls(),W=He(),K=N(a,P.id),z=N(a,P.open),L=N(a,P.mounted),ee=N(a,P.popupProps),F=N(a,P.transitionStatus),te=N(a,P.triggerElement),I=N(a,P.positionerElement),U=N(a,P.listElement),S=l.useRef(0),E=l.useRef(!1),ie=l.useRef(0),M=l.useRef(!1),oe=l.useRef({}),G=Zt(),O=de(H=>{if(!I||!u.current||!M.current)return;if(E.current||!i){R();return}const fe=I.style.top==="0px",X=I.style.bottom==="0px",me=I.getBoundingClientRect().height,we=Ot(I),pe=getComputedStyle(I),Q=parseFloat(pe.marginTop),J=parseFloat(pe.marginBottom),ye=Xt(getComputedStyle(u.current)),se=we.documentElement.clientHeight-Q-J,ne=H.scrollTop,Te=H.scrollHeight,Ae=H.clientHeight,h=Te-Ae;let j=0,C=null,$=!1;if(fe){const Z=h-ne,le=me+Z,ge=Math.min(le,se);j=ge,ge!==se?C=h:$=!0}else if(X){const Z=ne-0,le=me+Z,ge=Math.min(le,se),be=le-se;j=ge,ge!==se?C=0:($=!0,ne<h&&(C=ne-(Z-be)))}j!==0&&(I.style.height=`${j}px`),C!=null&&(H.scrollTop=C),($||j>=ye)&&(E.current=!0),R()});l.useImperativeHandle(x,()=>O,[O]),ft({open:z,ref:u,onComplete(){z&&d?.(!0)}});const _=l.useMemo(()=>({open:z,transitionStatus:F,side:c,align:w}),[z,F,c,w]);Y(()=>{!I||!u.current||Object.keys(oe.current).length||(oe.current={top:I.style.top||"0",left:I.style.left||"0",right:I.style.right,height:I.style.height,bottom:I.style.bottom,minHeight:I.style.minHeight,maxHeight:I.style.maxHeight,marginTop:I.style.marginTop,marginBottom:I.style.marginBottom})},[u,I]),Y(()=>{z||i||(M.current=!1,E.current=!1,S.current=0,ie.current=0,at(I,oe.current))},[z,i,I,u]),Y(()=>{const H=u.current;if(!(!z||!te||!I||!H||a.state.transitionStatus==="ending")){if(!i){M.current=!0,G.request(R),H.style.removeProperty("--transform-origin");return}queueMicrotask(()=>{const fe=fs(H);H.style.removeProperty("--transform-origin");try{const X=getComputedStyle(I),me=getComputedStyle(H),we=Ot(te),pe=Wt(I),Q=te.getBoundingClientRect(),J=I.getBoundingClientRect(),ye=Q.left,se=Q.height,ne=U||H,Te=ne.scrollHeight,Ae=parseFloat(me.borderBottomWidth),h=parseFloat(X.marginTop)||10,j=parseFloat(X.marginBottom)||10,C=parseFloat(X.minHeight)||100,$=Xt(me),Z=5,le=5,ge=20,be=we.documentElement.clientHeight-h-j,je=we.documentElement.clientWidth,Se=be-Q.bottom+se,Me=p.current,Le=g.current;let Pe,Oe=0,Ze=0;if(Me&&Le){const D=Le.getBoundingClientRect();Pe=Me.getBoundingClientRect();const ce=D.left-ye,Ce=Pe.left-J.left,Ee=D.top-Q.top+D.height/2,Ie=Pe.top-J.top+Pe.height/2;Oe=ce-Ce,Ze=Ie-Ee}const qe=Se+Ze+j+Ae;let Ne=Math.min(be,qe);const pt=be-h-j,Be=qe-Ne,_e=Math.max(Z,ye+Oe),et=je-le,Ye=Math.max(0,_e+J.width-et);I.style.left=`${_e-Ye}px`,I.style.height=`${Ne}px`,I.style.maxHeight="auto",I.style.marginTop=`${h}px`,I.style.marginBottom=`${j}px`,H.style.height="100%";const tt=ne.scrollHeight-ne.clientHeight,nt=Be>=tt;nt&&(Ne=Math.min(be,J.height)-(Be-tt));const mt=Q.top<ge||Q.bottom>be-ge||Ne<Math.min(Te,C),gt=(pe.visualViewport?.scale??1)!==1&&Qn;if(mt||gt){M.current=!0,at(I,oe.current),Jn.flushSync(()=>f(!1));return}if(nt){const D=Math.max(0,be-qe);I.style.top=J.height>=pt?"0":`${D}px`,I.style.height=`${Ne}px`,ne.scrollTop=ne.scrollHeight-ne.clientHeight,S.current=Math.max(C,Ne)}else I.style.bottom="0",S.current=Math.max(C,Ne),ne.scrollTop=Be;if(Pe){const D=J.top,ce=J.height,Ce=Pe.top+Pe.height/2,Ee=ce>0?(Ce-D)/ce*100:50,Ie=ss(Ee,0,100);H.style.setProperty("--transform-origin",`50% ${Ie}%`)}(S.current===be||Ne>=$)&&(E.current=!0),R(),setTimeout(()=>{M.current=!0})}finally{fe()}})}},[a,z,I,te,g,p,u,R,i,f,G,v,V,U]),l.useEffect(()=>{if(!i||!I||!z)return;const H=Wt(I);function fe(X){m(!1,xe(er,X))}return H.addEventListener("resize",fe),()=>{H.removeEventListener("resize",fe)}},[m,i,I,z]);const ue={...U?{role:"presentation","aria-orientation":void 0}:{role:"listbox","aria-multiselectable":A||void 0,id:`${K}-list`},onKeyDown(H){b.current=!0,B&&nr.has(H.key)&&H.stopPropagation()},onMouseMove(){b.current=!1},onPointerLeave(H){if(!T||Rn(H)||H.pointerType==="touch")return;const fe=H.currentTarget;W.start(0,()=>{a.set("activeIndex",null),fe.focus({preventScroll:!0})})},onScroll(H){U||x.current?.(H.currentTarget)},...i&&{style:U?{height:"100%"}:bn}},ve=Ve("div",e,{ref:[n,u],state:_,stateAttributesMapping:cs,props:[ee,ue,tr(F),{className:!U&&i?kt.className:void 0},r]});return y.jsxs(l.Fragment,{children:[!ae&&kt.getElement(re),y.jsx(Zn,{context:k,modal:!1,disabled:!L,restoreFocus:!0,children:ve})]})});function Xt(t){const e=t.maxHeight||"";return e.endsWith("px")&&parseFloat(e)||1/0}const Qt={transform:"none",scale:"1",translate:"0 0"};function us(t,e,n){n?t.setProperty(e,n):t.removeProperty(e)}function fs(t){const{style:e}=t,n={},s=Object.keys(Qt);for(const o of s)n[o]=e.getPropertyValue(o),e.setProperty(o,Qt[o]);return()=>{for(const o of s)us(e,o,n[o])}}const ds=l.forwardRef(function(e,n){const{className:s,render:o,...r}=e,{store:a,scrollHandlerRef:u}=ke(),{alignItemWithTriggerActive:d}=Ht(),m=N(a,P.hasScrollArrows),g=N(a,P.openMethod),p=N(a,P.multiple),A={id:`${N(a,P.id)}-list`,role:"listbox","aria-multiselectable":p||void 0,onScroll(x){u.current?.(x.currentTarget)},...d&&{style:bn},className:m&&g!=="touch"?kt.className:void 0},R=de(x=>{a.set("listElement",x)});return Ve("div",e,{ref:[n,R],props:[A,r]})});let wn=(function(t){return t[t.None=0]="None",t[t.GuessFromOrder=1]="GuessFromOrder",t})({});function ps(t={}){const{label:e,metadata:n,textRef:s,indexGuessBehavior:o,index:r}=t,{register:a,unregister:u,subscribeMapChange:d,elementsRef:m,labelsRef:g,nextIndexRef:p}=Gr(),b=l.useRef(-1),[A,R]=l.useState(r??(o===wn.GuessFromOrder?()=>{if(b.current===-1){const c=p.current;p.current+=1,b.current=c}return b.current}:-1)),x=l.useRef(null),T=l.useCallback(c=>{if(x.current=c,A!==-1&&c!==null&&(m.current[A]=c,g)){const w=e!==void 0;g.current[A]=w?e:s?.current?.textContent??c.textContent}},[A,m,g,e,s]);return Y(()=>{if(r!=null)return;const c=x.current;if(c)return a(c,n),()=>{u(c)}},[r,a,u,n]),Y(()=>{if(r==null)return d(c=>{const w=x.current?c.get(x.current)?.index:null;w!=null&&R(w)})},[r,d,R]),l.useMemo(()=>({ref:T,index:A}),[A,T])}const Sn=l.createContext(void 0);function Ft(){const t=l.useContext(Sn);if(!t)throw new Error(ut(57));return t}const ms=l.memo(l.forwardRef(function(e,n){const{render:s,className:o,value:r=null,label:a,disabled:u=!1,nativeButton:d=!1,...m}=e,g=l.useRef(null),p=ps({label:a,textRef:g,indexGuessBehavior:wn.GuessFromOrder}),{store:b,getItemProps:A,setOpen:R,setValue:x,selectionRef:T,typingRef:c,valuesRef:w,keyboardActiveRef:i,multiple:f,highlightItemOnHover:v}=ke(),V=He(),B=N(b,P.isActive,p.index),k=N(b,P.isSelected,p.index,r),re=N(b,P.isSelectedByFocus,p.index),ae=N(b,P.isItemEqualToValue),W=p.index,K=W!==-1,z=l.useRef(null),L=De(W);Y(()=>{if(!K)return;const O=w.current;return O[W]=r,()=>{delete O[W]}},[K,W,r,w]),Y(()=>{if(!K)return;const O=b.state.value;let _=O;f&&Array.isArray(O)&&O.length>0&&(_=O[O.length-1]),_!==void 0&&We(_,r,ae)&&b.set("selectedIndex",W)},[K,W,f,ae,b,r]);const ee=l.useMemo(()=>({disabled:u,selected:k,highlighted:B}),[u,k,B]),F=A({active:B,selected:k});F.onFocus=void 0,F.id=void 0;const te=l.useRef(null),I=l.useRef("mouse"),U=l.useRef(!1),{getButtonProps:S,buttonRef:E}=on({disabled:u,focusableWhenDisabled:!0,native:d});function ie(O){const _=b.state.value;if(f){const ue=Array.isArray(_)?_:[],ve=k?kr(ue,r,ae):[...ue,r];x(ve,xe(yt,O))}else x(r,xe(yt,O)),R(!1,xe(yt,O))}const M={role:"option","aria-selected":k,tabIndex:B?0:-1,onFocus(){b.set("activeIndex",W)},onMouseEnter(){!i.current&&b.state.selectedIndex===null&&b.set("activeIndex",W)},onMouseMove(){v&&b.set("activeIndex",W)},onMouseLeave(O){!v||i.current||Rn(O)||V.start(0,()=>{b.state.activeIndex===W&&b.set("activeIndex",null)})},onTouchStart(){T.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}},onKeyDown(O){te.current=O.key,b.set("activeIndex",W)},onClick(O){U.current=!1,!(O.type==="keydown"&&te.current===null)&&(u||te.current===" "&&c.current||I.current!=="touch"&&!B||(te.current=null,ie(O.nativeEvent)))},onPointerEnter(O){I.current=O.pointerType},onPointerDown(O){I.current=O.pointerType,U.current=!0},onMouseUp(O){if(u)return;if(U.current){U.current=!1;return}const _=!T.current.allowSelectedMouseUp&&k,ue=!T.current.allowUnselectedMouseUp&&!k;_||ue||I.current!=="touch"&&!B||ie(O.nativeEvent)}},oe=Ve("div",e,{ref:[E,n,p.ref,z],state:ee,props:[F,M,m,S]}),G=l.useMemo(()=>({selected:k,indexRef:L,textRef:g,selectedByFocus:re,hasRegistered:K}),[k,L,g,re,K]);return y.jsx(Sn.Provider,{value:G,children:oe})})),gs=l.forwardRef(function(e,n){const s=e.keepMounted??!1,{selected:o}=Ft();return s||o?y.jsx(hs,{...e,ref:n}):null}),hs=l.memo(l.forwardRef((t,e)=>{const{render:n,className:s,keepMounted:o,...r}=t,{selected:a}=Ft(),u=l.useRef(null),{transitionStatus:d,setMounted:m}=Lt(a),g=l.useMemo(()=>({selected:a,transitionStatus:d}),[a,d]),p=Ve("span",t,{ref:[e,u],state:g,props:[{"aria-hidden":!0,children:"✔️"},r],stateAttributesMapping:cn});return ft({open:a,ref:u,onComplete(){a||m(!1)}}),p})),xs=l.memo(l.forwardRef(function(e,n){const{indexRef:s,textRef:o,selectedByFocus:r,hasRegistered:a}=Ft(),{selectedItemTextRef:u}=ke(),{className:d,render:m,...g}=e,p=l.useCallback(A=>{if(!A||!a)return;const R=u.current===null||!u.current.isConnected;(r||R&&s.current===0)&&(u.current=A)},[u,s,r,a]);return Ve("div",e,{ref:[p,n,o],props:g})})),vn=l.forwardRef(function(e,n){const{render:s,className:o,direction:r,keepMounted:a=!1,...u}=e,{store:d,popupRef:m,listRef:g,handleScrollArrowVisibility:p,scrollArrowsMountedCountRef:b}=ke(),{side:A,scrollDownArrowRef:R,scrollUpArrowRef:x}=Ht(),T=r==="up"?P.scrollUpArrowVisible:P.scrollDownArrowVisible,c=N(d,T),w=N(d,P.openMethod),i=c&&w!=="touch",f=He(),v=r==="up"?x:R,{transitionStatus:V,setMounted:B}=Lt(i);Y(()=>(b.current+=1,d.state.hasScrollArrows||d.set("hasScrollArrows",!0),()=>{b.current=Math.max(0,b.current-1),b.current===0&&d.state.hasScrollArrows&&d.set("hasScrollArrows",!1)}),[d,b]),ft({open:i,ref:v,onComplete(){i||B(!1)}});const k=l.useMemo(()=>({direction:r,visible:i,side:A,transitionStatus:V}),[r,i,A,V]),ae=Ve("div",e,{ref:[n,v],state:k,props:[{"aria-hidden":!0,children:r==="up"?"▲":"▼",style:{position:"absolute"},onMouseMove(K){if(K.movementX===0&&K.movementY===0||f.isStarted())return;d.set("activeIndex",null);function z(){const L=d.state.listElement??m.current;if(!L)return;d.set("activeIndex",null),p();const ee=L.scrollTop===0,F=Math.round(L.scrollTop+L.clientHeight)>=L.scrollHeight;if(g.current.length===0&&(r==="up"?d.set("scrollUpArrowVisible",!ee):d.set("scrollDownArrowVisible",!F)),r==="up"&&ee||r==="down"&&F){f.clear();return}if((d.state.listElement||m.current)&&g.current&&g.current.length>0){const I=g.current,U=v.current?.offsetHeight||0;if(r==="up"){let S=0;const E=L.scrollTop+U;for(let M=0;M<I.length;M+=1){const oe=I[M];if(oe&&oe.offsetTop>=E){S=M;break}}const ie=Math.max(0,S-1);if(ie<S){const M=I[ie];M&&(L.scrollTop=Math.max(0,M.offsetTop-U))}else L.scrollTop=0}else{let S=I.length-1;const E=L.scrollTop+L.clientHeight-U;for(let M=0;M<I.length;M+=1){const oe=I[M];if(oe&&oe.offsetTop+oe.offsetHeight>E){S=Math.max(0,M-1);break}}const ie=Math.min(I.length-1,S+1);if(ie>S){const M=I[ie];M&&(L.scrollTop=M.offsetTop+M.offsetHeight-L.clientHeight+U)}else L.scrollTop=L.scrollHeight-L.clientHeight}}f.start(40,z)}f.start(40,z)},onMouseLeave(){f.clear()}},u]});return i||a?ae:null}),ys=l.forwardRef(function(e,n){return y.jsx(vn,{...e,ref:n,direction:"down"})}),bs=l.forwardRef(function(e,n){return y.jsx(vn,{...e,ref:n,direction:"up"})}),It=Fr;function Tt(t){const e=Ke.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let o;e[3]!==n?(o=$e("flex flex-1 text-left",n),e[3]=n,e[4]=o):o=e[4];let r;return e[5]!==s||e[6]!==o?(r=y.jsx(Kr,{className:o,"data-slot":"select-value",...s}),e[5]=s,e[6]=o,e[7]=r):r=e[7],r}function Mt(t){const e=Ke.c(15);let n,s,o,r,a;e[0]!==t?({className:s,size:a,id:o,children:n,...r}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=o,e[4]=r,e[5]=a):(n=e[1],s=e[2],o=e[3],r=e[4],a=e[5]);const u=a===void 0?"default":a;let d;e[6]!==s?(d=$e("flex w-fit items-center justify-between gap-1.5 whitespace-nowrap rounded-md border border-input bg-input/20 px-2 py-1.5 text-xs/relaxed outline-none transition-colors focus-visible:border-ring focus-visible:ring-2 focus-visible:ring-ring/30 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-2 aria-invalid:ring-destructive/20 data-[size=default]:h-7 data-[size=sm]:h-6 data-placeholder:text-muted-foreground *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-1.5 dark:bg-input/30 dark:aria-invalid:border-destructive/50 dark:aria-invalid:ring-destructive/40 dark:hover:bg-input/50 [&_svg:not([class*='size-'])]:size-3.5 [&_svg]:pointer-events-none [&_svg]:shrink-0",s),e[6]=s,e[7]=d):d=e[7];let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=y.jsx($r,{render:y.jsx(fn,{className:"pointer-events-none size-3.5 text-muted-foreground"})}),e[8]=m):m=e[8];let g;return e[9]!==n||e[10]!==o||e[11]!==r||e[12]!==u||e[13]!==d?(g=y.jsxs(zr,{className:d,"data-size":u,"data-slot":"select-trigger",id:o,...r,children:[n,m]}),e[9]=n,e[10]=o,e[11]=r,e[12]=u,e[13]=d,e[14]=g):g=e[14],g}function Ct(t){const e=Ke.c(26);let n,s,o,r,a,u,d,m;e[0]!==t?({className:s,children:n,side:r,sideOffset:a,align:u,alignOffset:d,alignItemWithTrigger:m,...o}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=o,e[4]=r,e[5]=a,e[6]=u,e[7]=d,e[8]=m):(n=e[1],s=e[2],o=e[3],r=e[4],a=e[5],u=e[6],d=e[7],m=e[8]);const g=r===void 0?"bottom":r,p=a===void 0?4:a,b=u===void 0?"center":u,A=d===void 0?0:d,R=m===void 0?!0:m;let x;e[9]!==s?(x=$e("data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative isolate z-50 max-h-(--available-height) w-(--anchor-width) min-w-32 origin-(--transform-origin) overflow-y-auto overflow-x-hidden rounded-lg bg-popover text-popover-foreground shadow-md ring-1 ring-foreground/10 duration-100 data-closed:animate-out data-open:animate-in",s),e[9]=s,e[10]=x):x=e[10];let T;e[11]===Symbol.for("react.memo_cache_sentinel")?(T=y.jsx(Rs,{}),e[11]=T):T=e[11];let c;e[12]!==n?(c=y.jsx(ds,{children:n}),e[12]=n,e[13]=c):c=e[13];let w;e[14]===Symbol.for("react.memo_cache_sentinel")?(w=y.jsx(ws,{}),e[14]=w):w=e[14];let i;e[15]!==o||e[16]!==x||e[17]!==c?(i=y.jsxs(as,{className:x,"data-slot":"select-content",...o,children:[T,c,w]}),e[15]=o,e[16]=x,e[17]=c,e[18]=i):i=e[18];let f;return e[19]!==b||e[20]!==R||e[21]!==A||e[22]!==g||e[23]!==p||e[24]!==i?(f=y.jsx(Yr,{children:y.jsx(ts,{align:b,alignItemWithTrigger:R,alignOffset:A,className:"isolate z-50",side:g,sideOffset:p,children:i})}),e[19]=b,e[20]=R,e[21]=A,e[22]=g,e[23]=p,e[24]=i,e[25]=f):f=e[25],f}function Et(t){const e=Ke.c(13);let n,s,o;e[0]!==t?({className:s,children:n,...o}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=o):(n=e[1],s=e[2],o=e[3]);let r;e[4]!==s?(r=$e("relative flex min-h-7 w-full cursor-default select-none items-center gap-2 rounded-md px-2 py-1 text-xs/relaxed outline-hidden focus:bg-accent focus:text-accent-foreground not-data-[variant=destructive]:focus:**:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg:not([class*='size-'])]:size-3.5 [&_svg]:pointer-events-none [&_svg]:shrink-0 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),e[4]=s,e[5]=r):r=e[5];let a;e[6]!==n?(a=y.jsx(xs,{className:"flex flex-1 shrink-0 gap-2 whitespace-nowrap",children:n}),e[6]=n,e[7]=a):a=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=y.jsx(gs,{render:y.jsx("span",{className:"pointer-events-none absolute right-2 flex items-center justify-center"}),children:y.jsx(xr,{className:"pointer-events-none"})}),e[8]=u):u=e[8];let d;return e[9]!==o||e[10]!==r||e[11]!==a?(d=y.jsxs(ms,{className:r,"data-slot":"select-item",...o,children:[a,u]}),e[9]=o,e[10]=r,e[11]=a,e[12]=d):d=e[12],d}function Rs(t){const e=Ke.c(9);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let o;e[3]!==n?(o=$e("top-0 z-10 flex w-full cursor-default items-center justify-center bg-popover py-1 [&_svg:not([class*='size-'])]:size-3.5",n),e[3]=n,e[4]=o):o=e[4];let r;e[5]===Symbol.for("react.memo_cache_sentinel")?(r=y.jsx(wr,{}),e[5]=r):r=e[5];let a;return e[6]!==s||e[7]!==o?(a=y.jsx(bs,{className:o,"data-slot":"select-scroll-up-button",...s,children:r}),e[6]=s,e[7]=o,e[8]=a):a=e[8],a}function ws(t){const e=Ke.c(9);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let o;e[3]!==n?(o=$e("bottom-0 z-10 flex w-full cursor-default items-center justify-center bg-popover py-1 [&_svg:not([class*='size-'])]:size-3.5",n),e[3]=n,e[4]=o):o=e[4];let r;e[5]===Symbol.for("react.memo_cache_sentinel")?(r=y.jsx(fn,{}),e[5]=r):r=e[5];let a;return e[6]!==s||e[7]!==o?(a=y.jsx(ys,{className:o,"data-slot":"select-scroll-down-button",...s,children:r}),e[6]=s,e[7]=o,e[8]=a):a=e[8],a}const Ss=["sg-placeholder"],vs="subnet-placeholder";function ks(){const t=rr(),{data:e}=Rt(sr),{data:n}=Rt(or),{data:s}=Rt(ir),o=yr(),r=e.Images??[],a=n.KeyPairs??[],u=s.InstanceTypes?.flatMap(i=>i.InstanceType?[i.InstanceType]:[])??[],d=s.InstanceTypes?.reduce((i,f)=>{const v=f.InstanceType;return v&&(i[v]=(i[v]||0)+1),i},{})??{},m=Object.keys(d).sort(),{control:g,handleSubmit:p,register:b,watch:A,formState:{errors:R,isSubmitting:x}}=dr({resolver:pr(lr.refine(i=>i.count<=(d[i.instanceType]??1),{message:"Cannot exceed available capacity",path:["count"]})),defaultValues:{count:1}}),T=A("instanceType"),c=T?d[T]??1:1,w=async i=>{await o.mutateAsync({...i,securityGroupIds:Ss,subnetId:vs}),t({to:"/ec2/describe-instances"})};return y.jsxs(y.Fragment,{children:[y.jsx(gr,{to:"/ec2/describe-instances",children:"Back to instances"}),y.jsx(hr,{title:"Run EC2 Instances"}),u.length===0&&y.jsx(qt,{msg:"No compute available. No new instances can be created until compute is available."}),o.error&&y.jsx(qt,{error:o.error,msg:"Failed to create instance"}),y.jsxs("form",{className:"max-w-4xl space-y-6",onSubmit:p(w),children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx(st,{htmlFor:"imageId",children:"Image"}),y.jsx(bt,{control:g,name:"imageId",render:({field:i})=>{const f=r.find(v=>v.ImageId===i.value);return y.jsxs(It,{onValueChange:v=>i.onChange(v),value:i.value??"",children:[y.jsx(Mt,{className:"w-full",id:"imageId",children:y.jsx(Tt,{children:f?`${f.Name||"Unnamed"} (${f.Architecture})`:""})}),y.jsx(Ct,{children:r.map(v=>y.jsxs(Et,{value:v.ImageId??"",children:[v.Name||"Unnamed"," (",v.Architecture,")"]},v.ImageId))})]})}}),R.imageId&&y.jsx("p",{className:"text-destructive text-sm",children:R.imageId.message})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx(st,{htmlFor:"instanceType",children:"Instance Type"}),y.jsx(bt,{control:g,name:"instanceType",render:({field:i})=>y.jsxs(It,{onValueChange:f=>i.onChange(f),value:i.value?i.value:"",children:[y.jsx(Mt,{className:"w-full",id:"instanceType",children:y.jsx(Tt,{})}),y.jsx(Ct,{children:m.map(f=>y.jsxs(Et,{value:f,children:[f," (",d[f]," available)"]},f))})]})}),R.instanceType&&y.jsx("p",{className:"text-destructive text-sm",children:R.instanceType.message})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx(st,{htmlFor:"keyName",children:"Key Pair"}),y.jsx(bt,{control:g,name:"keyName",render:({field:i})=>y.jsxs(It,{onValueChange:f=>i.onChange(f),value:i.value?i.value:"",children:[y.jsx(Mt,{className:"w-full",id:"keyName",children:y.jsx(Tt,{})}),y.jsx(Ct,{children:a.map(f=>y.jsx(Et,{value:f.KeyName??"",children:f.KeyName},f.KeyPairId))})]})}),R.keyName&&y.jsx("p",{className:"text-destructive text-sm",children:R.keyName.message})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx(st,{htmlFor:"count",children:"Number of Instances"}),y.jsx(mr,{id:"count",type:"number",...b("count",{valueAsNumber:!0})}),y.jsx("p",{className:"text-muted-foreground text-xs",id:"count-description",children:T&&`Available capacity for ${T}: ${c}`}),R.count&&y.jsx("p",{className:"text-destructive text-sm",children:R.count.message})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(Kt,{disabled:x||o.isPending,onClick:()=>t({to:"/ec2/describe-instances"}),type:"button",variant:"outline",children:"Cancel"}),y.jsx(Kt,{disabled:x||o.isPending||u.length===0,type:"submit",children:x||o.isPending?"Creating…":"Create Instance"})]})]})]})}export{ks as component};
