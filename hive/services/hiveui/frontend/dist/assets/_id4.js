import{h as z,c as Q,j as s,B as A,bP as $,bB as F,bQ as H,bR as V}from"./index.js";import{u as L}from"./useSuspenseQuery.js";import{B as O}from"./back-link.js";import{D as M,a as g}from"./detail-row.js";import{P as Z}from"./page-heading.js";import{S as q}from"./state-badge.js";import{A as G}from"./ami-details.js";import{E as R}from"./error-banner.js";import{g as Y,h as J,i as K,j as U}from"./ec2.js";import{T as W}from"./trash-2.js";const X=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],ee=z("pause",X);const te=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],se=z("play",te);const ne=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],ae=z("rotate-cw",ne),ie=["pending","stopping","shutting-down","terminated"];function le(e){const t=Q.c(35),{instanceId:l,state:a}=e,n=Y(),o=J(),r=K(),u=U();if(ie.includes(a||"")&&a!=="terminated"){let i;return t[0]!==a?(i=s.jsx("div",{className:"rounded-lg border bg-muted/50 p-4",children:s.jsxs("p",{className:"text-center text-muted-foreground text-sm",children:["Instance is ",a,". Actions will be available once the operation completes."]})}),t[0]=a,t[1]=i):i=t[1],i}if(a==="terminated"){let i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx("div",{className:"rounded-lg border bg-muted/50 p-4",children:s.jsx("p",{className:"text-center text-muted-foreground text-sm",children:"This instance has been terminated and cannot be managed."})}),t[2]=i):i=t[2],i}let j;t[3]===Symbol.for("react.memo_cache_sentinel")?(j=s.jsx("h2",{className:"mb-4 font-semibold",children:"Instance Actions"}),t[3]=j):j=t[3];let h;t[4]!==n.error?(h=n.error&&s.jsx(R,{error:n.error,msg:"Failed to start instance"}),t[4]=n.error,t[5]=h):h=t[5];let p;t[6]!==o.error?(p=o.error&&s.jsx(R,{error:o.error,msg:"Failed to stop instance"}),t[6]=o.error,t[7]=p):p=t[7];let I;t[8]!==r.error?(I=r.error&&s.jsx(R,{error:r.error,msg:"Failed to reboot instance"}),t[8]=r.error,t[9]=I):I=t[9];let c;t[10]!==u.error?(c=u.error&&s.jsx(R,{error:u.error,msg:"Failed to terminate instance"}),t[10]=u.error,t[11]=c):c=t[11];let d;t[12]!==l||t[13]!==n||t[14]!==a?(d=a==="stopped"&&s.jsxs(A,{disabled:n.isPending,onClick:()=>n.mutate(l),size:"sm",variant:"default",children:[s.jsx(se,{className:"size-4"}),n.isPending?"Starting":"Start"]}),t[12]=l,t[13]=n,t[14]=a,t[15]=d):d=t[15];let b;t[16]!==l||t[17]!==r||t[18]!==a||t[19]!==o?(b=a==="running"&&s.jsxs(s.Fragment,{children:[s.jsxs(A,{disabled:o.isPending,onClick:()=>o.mutate(l),size:"sm",variant:"outline",children:[s.jsx(ee,{className:"size-4"}),o.isPending?"Stopping":"Stop"]}),s.jsxs(A,{disabled:r.isPending,onClick:()=>r.mutate(l),size:"sm",variant:"outline",children:[s.jsx(ae,{className:"size-4"}),r.isPending?"Rebooting":"Reboot"]})]}),t[16]=l,t[17]=r,t[18]=a,t[19]=o,t[20]=b):b=t[20];let m;t[21]!==l||t[22]!==a||t[23]!==u?(m=(a==="stopped"||a==="running")&&s.jsxs(A,{disabled:u.isPending,onClick:()=>u.mutate(l),size:"sm",variant:"destructive",children:[s.jsx(W,{className:"size-4"}),u.isPending?"Terminating":"Terminate"]}),t[21]=l,t[22]=a,t[23]=u,t[24]=m):m=t[24];let f;t[25]!==d||t[26]!==b||t[27]!==m?(f=s.jsxs("div",{className:"flex flex-wrap gap-2",children:[d,b,m]}),t[25]=d,t[26]=b,t[27]=m,t[28]=f):f=t[28];let x;return t[29]!==h||t[30]!==p||t[31]!==I||t[32]!==c||t[33]!==f?(x=s.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[j,h,p,I,c,f]}),t[29]=h,t[30]=p,t[31]=I,t[32]=c,t[33]=f,t[34]=x):x=t[34],x}function he(){const e=Q.c(48),{id:t}=$.useParams();let l;e[0]!==t?(l=H(t),e[0]=t,e[1]=l):l=e[1];const{data:a}=L(l),n=a.Reservations?.[0]?.Instances?.[0],o=n?.ImageId;let r;e[2]!==o?(r=V(o),e[2]=o,e[3]=r):r=e[3];const{data:u}=L(r),_=u?.Images?.[0];if(!n?.InstanceId){let C;return e[4]===Symbol.for("react.memo_cache_sentinel")?(C=s.jsxs(s.Fragment,{children:[s.jsx(O,{to:"/ec2/describe-instances",children:"Back to instances"}),s.jsx("p",{className:"text-muted-foreground",children:"Instance not found."})]}),e[4]=C):C=e[4],C}let j;e[5]!==n.LaunchTime?(j=F(n.LaunchTime),e[5]=n.LaunchTime,e[6]=j):j=e[6];const h=j;let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx(O,{to:"/ec2/describe-instances",children:"Back to instances"}),e[7]=p):p=e[7];const I=n.State?.Name;let c;e[8]!==I?(c=s.jsx(q,{state:I}),e[8]=I,e[9]=c):c=e[9];let d;e[10]!==n.InstanceId||e[11]!==c?(d=s.jsx(Z,{actions:c,subtitle:"EC2 Instance Details",title:n.InstanceId}),e[10]=n.InstanceId,e[11]=c,e[12]=d):d=e[12];const b=n.State?.Name;let m;e[13]!==n.InstanceId||e[14]!==b?(m=s.jsx(le,{instanceId:n.InstanceId,state:b}),e[13]=n.InstanceId,e[14]=b,e[15]=m):m=e[15];let f;e[16]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsx(M.Header,{children:"Instance Information"}),e[16]=f):f=e[16];let x;e[17]!==n.InstanceId?(x=s.jsx(g,{label:"Instance ID",value:n.InstanceId}),e[17]=n.InstanceId,e[18]=x):x=e[18];let i;e[19]!==n.InstanceType?(i=s.jsx(g,{label:"Instance Type",value:n.InstanceType}),e[19]=n.InstanceType,e[20]=i):i=e[20];const w=n.State?.Name;let v;e[21]!==w?(v=s.jsx(g,{label:"Instance State",value:w}),e[21]=w,e[22]=v):v=e[22];let S;e[23]!==n.State?.Code?(S=n.State?.Code?.toString(),e[23]=n.State?.Code,e[24]=S):S=e[24];let T;e[25]!==S?(T=s.jsx(g,{label:"State Code",value:S}),e[25]=S,e[26]=T):T=e[26];let k;e[27]!==h?(k=s.jsx(g,{label:"Launch Time",value:h}),e[27]=h,e[28]=k):k=e[28];const E=n.Placement?.AvailabilityZone;let N;e[29]!==E?(N=s.jsx(g,{label:"Availability Zone",value:E}),e[29]=E,e[30]=N):N=e[30];let y;e[31]!==x||e[32]!==i||e[33]!==v||e[34]!==T||e[35]!==k||e[36]!==N?(y=s.jsxs(M,{children:[f,s.jsxs(M.Content,{children:[x,i,v,T,k,N]})]}),e[31]=x,e[32]=i,e[33]=v,e[34]=T,e[35]=k,e[36]=N,e[37]=y):y=e[37];let D;e[38]!==n.BlockDeviceMappings?(D=n.BlockDeviceMappings&&n.BlockDeviceMappings.length>0&&s.jsxs(M,{children:[s.jsx(M.Header,{children:"Block Device Mappings"}),s.jsxs(M.Content,{children:[s.jsx(g,{label:"Device Name",value:n.BlockDeviceMappings[0]?.DeviceName}),s.jsx(g,{label:"Volume ID",value:n.BlockDeviceMappings[0]?.Ebs?.VolumeId}),s.jsx(g,{label:"Status",value:n.BlockDeviceMappings[0]?.Ebs?.Status}),s.jsx(g,{label:"Attach Time",value:F(n.BlockDeviceMappings[0]?.Ebs?.AttachTime)}),s.jsx(g,{label:"Delete on Termination",value:n.BlockDeviceMappings[0]?.Ebs?.DeleteOnTermination?"Yes":"No"})]})]}),e[38]=n.BlockDeviceMappings,e[39]=D):D=e[39];let B;e[40]!==_?(B=_&&s.jsx(G,{image:_}),e[40]=_,e[41]=B):B=e[41];let P;return e[42]!==y||e[43]!==D||e[44]!==B||e[45]!==d||e[46]!==m?(P=s.jsxs(s.Fragment,{children:[p,s.jsxs("div",{className:"space-y-6",children:[d,m,y,D,B]})]}),e[42]=y,e[43]=D,e[44]=B,e[45]=d,e[46]=m,e[47]=P):P=e[47],P}export{he as component};
