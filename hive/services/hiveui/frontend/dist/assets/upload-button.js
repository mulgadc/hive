import{g as oe,aR as De,aS as ge,aT as d,aU as Y,aV as z,aW as Fe,aX as Se,aY as ke,aZ as we,a_ as Re,a$ as Me,b0 as _e,b1 as Ne,b2 as Le,b3 as He,b4 as ce,b5 as b,b6 as G,b7 as Pe,b8 as Ue,b9 as je,ba as S,bb as k,bc as w,bd as H,be as Oe,bf as Te,bg as ve,bh as Ie,bi as Ke,bj as qe,bk as ze,c as $,j as u,aL as $e,bl as xe,bm as W,r as Ce,bn as We,B as Ve}from"./index.js";import{a as Ge,b as Qe,c as Xe,e as Ye,d as Ze,h as Je,f as et,g as tt}from"./alert-dialog.js";import{D as st}from"./download.js";import{T as nt}from"./trash-2.js";import{u as he}from"./useMutation.js";const rt=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],at=oe("file",rt);const ot=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ct=oe("folder",ot);const it=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],lt=oe("upload",it),ut=typeof ReadableStream=="function"?ReadableStream:function(){};class dt extends ut{}const mt=({expectedChecksum:t,checksum:e,source:n,checksumSourceLocation:s,base64Encoder:r})=>{if(!De(n))throw new Error(`@smithy/util-stream: unsupported source type ${n?.constructor?.name??n} in ChecksumStream.`);const a=r??ge;if(typeof TransformStream!="function")throw new Error("@smithy/util-stream: unable to instantiate ChecksumStream because API unavailable: ReadableStream/TransformStream.");const o=new TransformStream({start(){},async transform(i,l){e.update(i),l.enqueue(i)},async flush(i){const l=await e.digest(),m=a(l);if(t!==m){const x=new Error(`Checksum mismatch: expected "${t}" but received "${m}" in response header "${s}".`);i.error(x)}else i.terminate()}});n.pipeThrough(o);const c=o.readable;return Object.setPrototypeOf(c,dt.prototype),c};class xt{allocByteArray;byteLength=0;byteArrays=[];constructor(e){this.allocByteArray=e}push(e){this.byteArrays.push(e),this.byteLength+=e.byteLength}flush(){if(this.byteArrays.length===1){const s=this.byteArrays[0];return this.reset(),s}const e=this.allocByteArray(this.byteLength);let n=0;for(let s=0;s<this.byteArrays.length;++s){const r=this.byteArrays[s];e.set(r,n),n+=r.byteLength}return this.reset(),e}reset(){this.byteArrays=[],this.byteLength=0}}function Ct(t,e,n){const s=t.getReader();let r=!1,a=0;const o=["",new xt(l=>new Uint8Array(l))];let c=-1;const i=async l=>{const{value:m,done:x}=await s.read(),C=m;if(x){if(c!==-1){const f=Q(o,c);j(f)>0&&l.enqueue(f)}l.close()}else{const f=Et(C,!1);if(c!==f&&(c>=0&&l.enqueue(Q(o,c)),c=f),c===-1){l.enqueue(C);return}const E=j(C);a+=E;const p=j(o[c]);if(E>=e&&p===0)l.enqueue(C);else{const A=ft(o,c,C);!r&&a>e*2&&(r=!0,n?.warn(`@smithy/util-stream - stream chunk size ${E} is below threshold of ${e}, automatically buffering.`)),A>=e?l.enqueue(Q(o,c)):await i(l)}}};return new ReadableStream({pull:i})}const ht=Ct;function ft(t,e,n){switch(e){case 0:return t[0]+=n,j(t[0]);case 1:case 2:return t[e].push(n),j(t[e])}}function Q(t,e){switch(e){case 0:const n=t[0];return t[0]="",n;case 1:case 2:return t[e].flush()}throw new Error(`@smithy/util-stream - invalid index ${e} given to flush()`)}function j(t){return t?.byteLength??t?.length??0}function Et(t,e=!0){return e&&typeof Buffer<"u"&&t instanceof Buffer?2:t instanceof Uint8Array?1:typeof t=="string"?0:-1}const Z=[d.CRC32,d.CRC32C,d.CRC64NVME,d.SHA1,d.SHA256],pt=[d.SHA256,d.SHA1,d.CRC32,d.CRC32C,d.CRC64NVME],At=(t,{requestChecksumRequired:e,requestAlgorithmMember:n,requestChecksumCalculation:s})=>{if(!n)return s===z.WHEN_SUPPORTED||e?Y:void 0;if(!t[n])return;const r=t[n];if(!Z.includes(r))throw new Error(`The checksum algorithm "${r}" is not supported by the client. Select one of ${Z}.`);return r},ie=t=>t===d.MD5?"content-md5":`x-amz-checksum-${t.toLowerCase()}`,yt=(t,e)=>{const n=t.toLowerCase();for(const s of Object.keys(e))if(n===s.toLowerCase())return!0;return!1},Bt=(t,e)=>{const n=t.toLowerCase();for(const s of Object.keys(e))if(s.toLowerCase().startsWith(n))return!0;return!1},fe=t=>t!==void 0&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!Fe(t);var bt=(function(){function t(){this.crc32c=new me}return t.prototype.update=function(e){Se(e)||this.crc32c.update(ke(e))},t.prototype.digest=function(){return we(this,void 0,void 0,function(){return Re(this,function(e){return[2,Me(this.crc32c.digest())]})})},t.prototype.reset=function(){this.crc32c=new me},t})(),me=(function(){function t(){this.checksum=4294967295}return t.prototype.update=function(e){var n,s;try{for(var r=_e(e),a=r.next();!a.done;a=r.next()){var o=a.value;this.checksum=this.checksum>>>8^gt[(this.checksum^o)&255]}}catch(c){n={error:c}}finally{try{a&&!a.done&&(s=r.return)&&s.call(r)}finally{if(n)throw n.error}}return this},t.prototype.digest=function(){return(this.checksum^4294967295)>>>0},t})(),Dt=[0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697],gt=Ne(Dt);const Ft=()=>{const e=new Array(8);for(let n=0;n<8;n++){const s=new Array(512);for(let r=0;r<256;r++){let a=BigInt(r);for(let o=0;o<8*(n+1);o++)a&1n?a=a>>1n^0x9a6c9329ac4bc9b5n:a=a>>1n;s[r*2]=Number(a>>32n&0xffffffffn),s[r*2+1]=Number(a&0xffffffffn)}e[n]=new Uint32Array(s)}return e};let X,U,J,ee,te,se,ne,re,ae;const St=()=>{X||(X=Ft(),[U,J,ee,te,se,ne,re,ae]=X)};class kt{c1=0;c2=0;constructor(){St(),this.reset()}update(e){const n=e.length;let s=0,r=this.c1,a=this.c2;for(;s+8<=n;){const o=((a^e[s++])&255)<<1,c=((a>>>8^e[s++])&255)<<1,i=((a>>>16^e[s++])&255)<<1,l=((a>>>24^e[s++])&255)<<1,m=((r^e[s++])&255)<<1,x=((r>>>8^e[s++])&255)<<1,C=((r>>>16^e[s++])&255)<<1,f=((r>>>24^e[s++])&255)<<1;r=ae[o]^re[c]^ne[i]^se[l]^te[m]^ee[x]^J[C]^U[f],a=ae[o+1]^re[c+1]^ne[i+1]^se[l+1]^te[m+1]^ee[x+1]^J[C+1]^U[f+1]}for(;s<n;){const o=((a^e[s])&255)<<1;a=(a>>>8|(r&255)<<24)>>>0,r=r>>>8^U[o],a^=U[o+1],s++}this.c1=r,this.c2=a}async digest(){const e=this.c1^4294967295,n=this.c2^4294967295;return new Uint8Array([e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255])}reset(){this.c1=4294967295,this.c2=4294967295}}const wt=()=>Le,Ee=(t,e)=>{switch(t){case d.MD5:return e.md5;case d.CRC32:return wt();case d.CRC32C:return bt;case d.CRC64NVME:return kt;case d.SHA1:return e.sha1;case d.SHA256:return e.sha256;default:throw new Error(`Unsupported checksum algorithm: ${t}`)}},pe=(t,e)=>{const n=new t;return n.update(He(e||"")),n.digest()},Rt={name:"flexibleChecksumsMiddleware",step:"build",tags:["BODY_CHECKSUM"],override:!0},Mt=(t,e)=>(n,s)=>async r=>{if(!ce.isInstance(r.request)||Bt("x-amz-checksum-",r.request.headers))return n(r);const{request:a,input:o}=r,{body:c,headers:i}=a,{base64Encoder:l,streamHasher:m}=t,{requestChecksumRequired:x,requestAlgorithmMember:C}=e,f=await t.requestChecksumCalculation(),E=C?.name,p=C?.httpHeader;E&&!o[E]&&(f===z.WHEN_SUPPORTED||x)&&(o[E]=Y,p&&(i[p]=Y));const A=At(o,{requestChecksumRequired:x,requestAlgorithmMember:C?.name,requestChecksumCalculation:f});let B=c,D=i;if(A){switch(A){case d.CRC32:b(s,"FLEXIBLE_CHECKSUMS_REQ_CRC32","U");break;case d.CRC32C:b(s,"FLEXIBLE_CHECKSUMS_REQ_CRC32C","V");break;case d.CRC64NVME:b(s,"FLEXIBLE_CHECKSUMS_REQ_CRC64","W");break;case d.SHA1:b(s,"FLEXIBLE_CHECKSUMS_REQ_SHA1","X");break;case d.SHA256:b(s,"FLEXIBLE_CHECKSUMS_REQ_SHA256","Y");break}const h=ie(A),y=Ee(A,t);if(fe(c)){const{getAwsChunkedEncodingStream:g,bodyLengthChecker:F}=t;B=g(typeof t.requestStreamBufferSize=="number"&&t.requestStreamBufferSize>=8*1024?ht(c,t.requestStreamBufferSize,s.logger):c,{base64Encoder:l,bodyLengthChecker:F,checksumLocationName:h,checksumAlgorithmFn:y,streamHasher:m}),D={...i,"content-encoding":i["content-encoding"]?`${i["content-encoding"]},aws-chunked`:"aws-chunked","transfer-encoding":"chunked","x-amz-decoded-content-length":i["content-length"],"x-amz-content-sha256":"STREAMING-UNSIGNED-PAYLOAD-TRAILER","x-amz-trailer":h},delete D["content-length"]}else if(!yt(h,i)){const g=await pe(y,c);D={...i,[h]:l(g)}}}try{return await n({...r,request:{...a,headers:D,body:B}})}catch(h){if(h instanceof Error&&h.name==="InvalidChunkSizeError")try{h.message.endsWith(".")||(h.message+="."),h.message+=" Set [requestStreamBufferSize=number e.g. 65_536] in client constructor to instruct AWS SDK to buffer your input stream."}catch{}throw h}},_t={name:"flexibleChecksumsInputMiddleware",toMiddleware:"serializerMiddleware",relation:"before",tags:["BODY_CHECKSUM"],override:!0},Nt=(t,e)=>(n,s)=>async r=>{const a=r.input,{requestValidationModeMember:o}=e,c=await t.requestChecksumCalculation(),i=await t.responseChecksumValidation();switch(c){case z.WHEN_REQUIRED:b(s,"FLEXIBLE_CHECKSUMS_REQ_WHEN_REQUIRED","a");break;case z.WHEN_SUPPORTED:b(s,"FLEXIBLE_CHECKSUMS_REQ_WHEN_SUPPORTED","Z");break}switch(i){case G.WHEN_REQUIRED:b(s,"FLEXIBLE_CHECKSUMS_RES_WHEN_REQUIRED","c");break;case G.WHEN_SUPPORTED:b(s,"FLEXIBLE_CHECKSUMS_RES_WHEN_SUPPORTED","b");break}return o&&!a[o]&&i===G.WHEN_SUPPORTED&&(a[o]="ENABLED"),n(r)},Ae=(t=[])=>{const e=[];for(const n of pt)!t.includes(n)||!Z.includes(n)||e.push(n);return e},Lt=t=>{const e=t.lastIndexOf("-");if(e!==-1){const n=t.slice(e+1);if(!n.startsWith("0")){const s=parseInt(n,10);if(!isNaN(s)&&s>=1&&s<=1e4)return!0}}return!1},Ht=async(t,{checksumAlgorithmFn:e,base64Encoder:n})=>n(await pe(e,t)),Pt=async(t,{config:e,responseAlgorithms:n,logger:s})=>{const r=Ae(n),{body:a,headers:o}=t;for(const c of r){const i=ie(c),l=o[i];if(l){let m;try{m=Ee(c,e)}catch(f){if(c===d.CRC64NVME){s?.warn(`Skipping ${d.CRC64NVME} checksum validation: ${f.message}`);continue}throw f}const{base64Encoder:x}=e;if(fe(a)){t.body=mt({expectedChecksum:l,checksumSourceLocation:i,checksum:new m,source:a,base64Encoder:x});return}const C=await Ht(a,{checksumAlgorithmFn:m,base64Encoder:x});if(C===l)break;throw new Error(`Checksum mismatch: expected "${C}" but received "${l}" in response header "${i}".`)}}},Ut={name:"flexibleChecksumsResponseMiddleware",toMiddleware:"deserializerMiddleware",relation:"after",tags:["BODY_CHECKSUM"],override:!0},jt=(t,e)=>(n,s)=>async r=>{if(!ce.isInstance(r.request))return n(r);const a=r.input,o=await n(r),c=o.response,{requestValidationModeMember:i,responseAlgorithms:l}=e;if(i&&a[i]==="ENABLED"){const{clientName:m,commandName:x}=s;if(m==="S3Client"&&x==="GetObjectCommand"&&Ae(l).every(f=>{const E=ie(f),p=c.headers[E];return!p||Lt(p)}))return o;await Pt(c,{config:t,responseAlgorithms:l,logger:s.logger})}return o},le=(t,e)=>({applyToStack:n=>{n.add(Mt(t,e),Rt),n.addRelativeTo(Nt(t,e),_t),n.addRelativeTo(jt(t,e),Ut)}}),Ot="content-length",Tt="x-amz-decoded-content-length";function vt(){return(t,e)=>async n=>{const{request:s}=n;if(ce.isInstance(s)&&!(Ot in s.headers)&&!(Tt in s.headers)){const r="Are you using a Stream of unknown length as the Body of a PutObject request? Consider using Upload instead from @aws-sdk/lib-storage.";typeof e?.logger?.warn=="function"&&!(e.logger instanceof Pe)?e.logger.warn(r):console.warn(r)}return t({...n})}}const It={step:"finalizeRequest",tags:["CHECK_CONTENT_LENGTH_HEADER"],name:"getCheckContentLengthHeaderPlugin",override:!0},Kt=t=>({applyToStack:e=>{e.add(vt(),It)}}),qt=t=>(e,n)=>async s=>{const r=await e(s),{response:a}=r;if(Ue.isInstance(a)&&a.headers.expires){a.headers.expiresstring=a.headers.expires;try{je(a.headers.expires)}catch(o){n.logger?.warn(`AWS SDK Warning for ${n.clientName}::${n.commandName} response parsing (${a.headers.expires}): ${o}`),delete a.headers.expires}}return r},zt={tags:["S3"],name:"s3ExpiresMiddleware",override:!0,relation:"after",toMiddleware:"deserializerMiddleware"},$t=t=>({applyToStack:e=>{e.addRelativeTo(qt(),zt)}});class Wt extends S.classBuilder().ep({...k,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,s,r){return[w(s,e.getEndpointParameterInstructions()),H(s)]}).s("AmazonS3","AbortMultipartUpload",{}).n("S3Client","AbortMultipartUploadCommand").sc(Oe).build(){}function Vt(t){return e=>async n=>{const s={...n.input},r=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(const a of r){const o=s[a.target];if(o){let c;typeof o=="string"?Qt(o,t)?c=t.base64Decoder(o):(c=t.utf8Decoder(o),s[a.target]=t.base64Encoder(c)):(c=ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o),s[a.target]=t.base64Encoder(c));const i=new t.md5;i.update(c),s[a.hash]=t.base64Encoder(await i.digest())}}return e({...n,input:s})}}const Gt={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},O=t=>({applyToStack:e=>{e.add(Vt(t),Gt)}});function Qt(t,e){if(!/^(?:[A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t))return!1;try{return e.base64Decoder(t).length===32}catch{return!1}}class Xt extends S.classBuilder().ep({...k,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,s,r){return[w(s,e.getEndpointParameterInstructions()),H(s),O(s)]}).s("AmazonS3","CompleteMultipartUpload",{}).n("S3Client","CompleteMultipartUploadCommand").sc(Te).build(){}class Yt extends S.classBuilder().ep({...k,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,s,r){return[w(s,e.getEndpointParameterInstructions()),H(s),O(s)]}).s("AmazonS3","CreateMultipartUpload",{}).n("S3Client","CreateMultipartUploadCommand").sc(ve).build(){}class Zt extends S.classBuilder().ep({...k,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,s,r){return[w(s,e.getEndpointParameterInstructions()),H(s)]}).s("AmazonS3","DeleteObject",{}).n("S3Client","DeleteObjectCommand").sc(Ie).build(){}class Jt extends S.classBuilder().ep({...k,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,s,r){return[w(s,e.getEndpointParameterInstructions()),le(s,{requestChecksumRequired:!1,requestValidationModeMember:"ChecksumMode",responseAlgorithms:["CRC64NVME","CRC32","CRC32C","SHA256","SHA1"]}),O(s),$t()]}).s("AmazonS3","GetObject",{}).n("S3Client","GetObjectCommand").sc(Ke).build(){}class es extends S.classBuilder().ep({...k,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,s,r){return[w(s,e.getEndpointParameterInstructions()),le(s,{requestAlgorithmMember:{httpHeader:"x-amz-sdk-checksum-algorithm",name:"ChecksumAlgorithm"},requestChecksumRequired:!1}),Kt(),H(s),O(s)]}).s("AmazonS3","PutObject",{}).n("S3Client","PutObjectCommand").sc(qe).build(){}class ts extends S.classBuilder().ep({...k,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,s,r){return[w(s,e.getEndpointParameterInstructions()),le(s,{requestAlgorithmMember:{httpHeader:"x-amz-sdk-checksum-algorithm",name:"ChecksumAlgorithm"},requestChecksumRequired:!1}),H(s),O(s)]}).s("AmazonS3","UploadPart",{}).n("S3Client","UploadPartCommand").sc(ze).build(){}function Cs(t){const e=$.c(9),{folderName:n,fullPrefix:s,bucketName:r}=t;let a;e[0]!==r||e[1]!==s?(a={bucket:r,_splat:s},e[0]=r,e[1]=s,e[2]=a):a=e[2];let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=u.jsx(ct,{className:"size-5 text-muted-foreground"}),e[3]=o):o=e[3];let c;e[4]!==n?(c=u.jsx("span",{className:"font-medium",children:n}),e[4]=n,e[5]=c):c=e[5];let i;return e[6]!==a||e[7]!==c?(i=u.jsxs($e,{className:"flex items-center gap-3 rounded-lg border bg-card p-4 transition-colors hover:bg-accent",params:a,to:"/s3/ls/$bucket/$",children:[o,c]}),e[6]=a,e[7]=c,e[8]=i):i=e[8],i}const ss=4*1024*1024,ns=5*1024*1024;async function rs(t,e,n){const s=W(),{UploadId:r}=await s.send(new Yt({Bucket:t,Key:e,ContentType:n.type})),a=[];try{let o=1,c=0;for(;c<n.size;){const i=Math.min(c+ns,n.size),l=n.slice(c,i),m=new Uint8Array(await l.arrayBuffer()),{ETag:x}=await s.send(new ts({Bucket:t,Key:e,UploadId:r,PartNumber:o,Body:m}));a.push({ETag:x??"",PartNumber:o}),o++,c=i}return await s.send(new Xt({Bucket:t,Key:e,UploadId:r,MultipartUpload:{Parts:a}}))}catch(o){try{await s.send(new Wt({Bucket:t,Key:e,UploadId:r}))}catch{}throw o}}function as(){const t=$.c(2),e=xe();let n;return t[0]!==e?(n={mutationFn:os,onSuccess:(s,r)=>{e.invalidateQueries({queryKey:["s3","buckets",r.bucket,"objects"]})}},t[0]=e,t[1]=n):n=t[1],he(n)}async function os(t){const{bucket:e,key:n,file:s}=t;if(s.size>ss)return await rs(e,n,s);const r=await s.arrayBuffer(),a=new Uint8Array(r),o=new es({Bucket:e,Key:n,Body:a,ContentType:s.type});return await W().send(o)}function cs(){const t=$.c(2),e=xe();let n;return t[0]!==e?(n={mutationFn:is,onSuccess:(s,r)=>{e.invalidateQueries({queryKey:["s3","buckets",r.bucket,"objects"]})}},t[0]=e,t[1]=n):n=t[1],he(n)}async function is(t){const{bucket:e,key:n}=t,s=new Zt({Bucket:e,Key:n});return await W().send(s)}function hs(t){const e=$.c(46),{object:n,bucketName:s,displayName:r,fullKey:a}=t,[o,c]=Ce.useState(!1),i=cs();let l;e[0]!==s||e[1]!==r||e[2]!==a?(l=async function(){try{const Be=new Jt({Bucket:s,Key:a}),ue=await W().send(Be);if(ue.Body){const be=await ue.Body.transformToByteArray(),de=URL.createObjectURL(new Blob([be])),P=document.createElement("a");P.href=de,P.download=r,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(de)}}catch{throw new Error("Failed to download object")}},e[0]=s,e[1]=r,e[2]=a,e[3]=l):l=e[3];const m=l;let x;e[4]!==s||e[5]!==i||e[6]!==a?(x=async function(){await i.mutateAsync({bucket:s,key:a}),c(!1)},e[4]=s,e[5]=i,e[6]=a,e[7]=x):x=e[7];const C=x,f=n.Key;let E;e[8]===Symbol.for("react.memo_cache_sentinel")?(E=u.jsx(at,{className:"size-5 text-muted-foreground"}),e[8]=E):E=e[8];let p;e[9]!==r?(p=u.jsx("h3",{className:"font-medium",children:r}),e[9]=r,e[10]=p):p=e[10];let A;e[11]!==n.LastModified?(A=n.LastModified&&u.jsxs("p",{className:"text-muted-foreground text-sm",children:["Last Modified: ",n.LastModified.toLocaleString()]}),e[11]=n.LastModified,e[12]=A):A=e[12];let B;e[13]!==p||e[14]!==A?(B=u.jsxs("div",{className:"flex items-center gap-3",children:[E,u.jsxs("div",{children:[p,A]})]}),e[13]=p,e[14]=A,e[15]=B):B=e[15];const D=n.Size||0;let h;e[16]!==D?(h=We(D),e[16]=D,e[17]=h):h=e[17];let y;e[18]!==h?(y=u.jsx("div",{className:"text-muted-foreground text-sm",children:h}),e[18]=h,e[19]=y):y=e[19];let g;e[20]===Symbol.for("react.memo_cache_sentinel")?(g=u.jsx(st,{className:"size-4"}),e[20]=g):g=e[20];let F;e[21]!==m?(F=u.jsx("button",{className:"rounded-md p-2 transition-colors hover:bg-accent",onClick:m,type:"button",children:g}),e[21]=m,e[22]=F):F=e[22];let T;e[23]===Symbol.for("react.memo_cache_sentinel")?(T=()=>c(!0),e[23]=T):T=e[23];let v;e[24]===Symbol.for("react.memo_cache_sentinel")?(v=u.jsx("button",{className:"rounded-md p-2 text-destructive transition-colors hover:bg-accent",onClick:T,type:"button",children:u.jsx(nt,{className:"size-4"})}),e[24]=v):v=e[24];let R;e[25]!==y||e[26]!==F?(R=u.jsxs("div",{className:"flex items-center gap-3",children:[y,F,v]}),e[25]=y,e[26]=F,e[27]=R):R=e[27];let I;e[28]===Symbol.for("react.memo_cache_sentinel")?(I=u.jsx(Ge,{children:"Delete Object"}),e[28]=I):I=e[28];let M;e[29]!==r?(M=u.jsxs(Qe,{children:[I,u.jsxs(Xe,{children:["Are you sure you want to delete ",u.jsx("strong",{children:r}),"? This action cannot be undone."]})]}),e[29]=r,e[30]=M):M=e[30];let K;e[31]===Symbol.for("react.memo_cache_sentinel")?(K=u.jsx(Ye,{children:"Cancel"}),e[31]=K):K=e[31];const V=i.isPending?"Deleting…":"Delete";let _;e[32]!==C||e[33]!==V?(_=u.jsxs(Ze,{children:[K,u.jsx(Je,{className:"bg-destructive hover:bg-destructive/90",onClick:C,children:V})]}),e[32]=C,e[33]=V,e[34]=_):_=e[34];let N;e[35]!==M||e[36]!==_?(N=u.jsxs(et,{children:[M,_]}),e[35]=M,e[36]=_,e[37]=N):N=e[37];let L;e[38]!==o||e[39]!==N?(L=u.jsx(tt,{onOpenChange:c,open:o,children:N}),e[38]=o,e[39]=N,e[40]=L):L=e[40];let q;return e[41]!==n.Key||e[42]!==R||e[43]!==L||e[44]!==B?(q=u.jsxs("div",{className:"flex items-center justify-between rounded-lg border bg-card p-4",children:[B,R,L]},f),e[41]=n.Key,e[42]=R,e[43]=L,e[44]=B,e[45]=q):q=e[45],q}function fs({bucket:t,prefix:e=""}){const n=Ce.useRef(null),s=as();async function r(a){const o=a.target.files;if(!(!o||o.length===0))try{await Promise.all(Array.from(o).map(c=>{const i=`${e}${c.name}`;return s.mutateAsync({bucket:t,key:i,file:c})}))}finally{n.current&&(n.current.value="")}}return u.jsxs(u.Fragment,{children:[u.jsx("input",{accept:"*/*",className:"hidden",multiple:!0,onChange:r,ref:n,type:"file"}),u.jsxs(Ve,{disabled:s.isPending,onClick:()=>n.current?.click(),size:"sm",children:[u.jsx(lt,{className:"mr-2 size-4"}),s.isPending?"Uploading…":"Upload Files"]})]})}export{Cs as F,hs as O,fs as U};
